!function(e){function t(t){for(var n,i,c=t[0],l=t[1],s=t[2],f=0,d=[];f<c.length;f++)i=c[f],r[i]&&d.push(r[i][0]),r[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(u&&u(t);d.length;)d.shift()();return a.push.apply(a,s||[]),o()}function o(){for(var e,t=0;t<a.length;t++){for(var o=a[t],n=!0,c=1;c<o.length;c++){var l=o[c];0!==r[l]&&(n=!1)}n&&(a.splice(t--,1),e=i(i.s=o[0]))}return e}var n={},r={0:0},a=[];function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=n,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var u=l;a.push([183,1]),o()}({10:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(404);Object.defineProperty(t,"Ajax",{enumerable:!0,get:function(){return y(n).default}});var r=o(160);Object.defineProperty(t,"asynLoad",{enumerable:!0,get:function(){return y(r).default}});var a=o(405);Object.defineProperty(t,"Init",{enumerable:!0,get:function(){return y(a).default}});var i=o(407);Object.defineProperty(t,"Storage",{enumerable:!0,get:function(){return y(i).default}});var c=o(162);Object.defineProperty(t,"Alert",{enumerable:!0,get:function(){return y(c).default}});var l=o(174);Object.defineProperty(t,"Toast",{enumerable:!0,get:function(){return y(l).default}});var s=o(463);Object.defineProperty(t,"Loading",{enumerable:!0,get:function(){return y(s).default}});var u=o(176);Object.defineProperty(t,"Page",{enumerable:!0,get:function(){return y(u).default}});var f=o(161);Object.defineProperty(t,"Logger",{enumerable:!0,get:function(){return y(f).default}});var d=o(464);Object.defineProperty(t,"Pipes",{enumerable:!0,get:function(){return y(d).default}});var m=o(465);Object.defineProperty(t,"AppendToDom",{enumerable:!0,get:function(){return y(m).default}});var p=o(466);Object.defineProperty(t,"AsyncComponent",{enumerable:!0,get:function(){return y(p).default}});var h=o(467);Object.defineProperty(t,"CheckBroswer",{enumerable:!0,get:function(){return y(h).default}});var g=o(173);Object.defineProperty(t,"Valid",{enumerable:!0,get:function(){return y(g).default}});var v=o(468);Object.defineProperty(t,"MD5",{enumerable:!0,get:function(){return y(v).default}});var b=o(469);function y(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"Throttle",{enumerable:!0,get:function(){return y(b).default}})},120:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(16),l=d(o(6)),s=(o(19),d(o(21)),d(o(20)),d(o(23))),u=o(9),f=o(10);function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}console.log("!!!!!!!!!",f.Throttle);u.StoreNim.state,u.StoreNim;var p=u.StoreChatroom.state,h=(u.StoreChatroom,u.StoreNetcall.state),g=u.StoreNetcall,v=(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={preventDom:null,timer:null,ChangeVideoStatus:!0,ChangeAudioStatus:!0},n.onMouseOver=function(e){n.state.timer&&(clearTimeout(n.state.timer),n.setState({timer:null}),n.state.preventDom&&(n.state.preventDom.style.display="none")),n.getTipDom(e).style.display="block"},n.onMouseOut=function(e){var t=n.getTipDom(e);n.setState({timer:setTimeout(function(){t.style.display="none"},250),preventDom:t})},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"toggleVideo",value:function(){var e=this;if(1!=h.tabIndex){if(this.state.ChangeVideoStatus){this.setState({ChangeVideoStatus:!1});var t=!h.video;g.setVideo(t),console.log("toggleVideo -> ",t),t?s.default.startCamera().then(function(){console.log("==本地摄像头开启成功"),s.default.setVideoViewSize(),s.default.startLocalStream(e.dom),e.setState({ChangeVideoStatus:!0})}).catch(function(t){e.setState({ChangeVideoStatus:!0}),console.error("==本地摄像头开启失败",t)}):s.default.stopCamera().then(function(){console.log("==本地摄像头关闭成功"),s.default.stopLocalStream(e.dom),e.setState({ChangeVideoStatus:!0})}).catch(function(t){console.error("==本地摄像头关闭失败",t),e.setState({ChangeVideoStatus:!0})})}}else console.error("屏幕共享不关闭摄像头")}},{key:"toggleAudio",value:function(){var e=this;if(this.state.ChangeAudioStatus){this.setState({ChangeAudioStatus:!1});var t=!h.audio;g.setAudio(t),console.log("toggleAudio -> ",t),t?s.default.startMicro().then(function(){e.setState({ChangeAudioStatus:!0}),console.log("==本地麦克风关闭成功")}).catch(function(t){console.error("==本地麦克风关闭/播放本地音频失败",t),"NotAllowedError"==t&&g.setHasAudio(!1),e.setState({ChangeAudioStatus:!0})}):s.default.stopMicro().then(function(){e.setState({ChangeAudioStatus:!0}),console.log("==本地麦克风关闭成功")}).catch(function(t){console.error("==本地麦克风关闭/停止播放本地音频失败",t),"NotAllowedError"==t&&g.setHasVideo(!1),e.setState({ChangeAudioStatus:!0})})}}},{key:"toggleFullscreen",value:function(){var e=document.getElementById("m-whiteboard-fullscreen");if(e){g.setVideoIsFullScreen(!0);var t=this.props.account;console.log("### 放大",t,e),s.default.startRemoteStream(t,e),s.default.setVideoViewRemoteSize(t,700,490),document.querySelectorAll("video").forEach(function(e){e.play()})}else console.error("节点未准备完毕")}},{key:"getTipDom",value:function(e){return"video"==e?document.getElementById("tip4video"):document.getElementById("tip4audio")}},{key:"render",value:function(){var e=this,t=this.props,o=t.className,n=t.account,r=void 0===n?"":n,a=t.self,c=void 0!==a&&a,s=t.offline,u=void 0!==s&&s,d=(t.index,p.custom.shareID),m=1==f.Storage.get("isTeacher"),g=r==d&&""!==d;return i.default.createElement("div",{className:(0,l.default)("m-netcall-video",o)},i.default.createElement("div",{className:"video-name"},r),i.default.createElement("div",{className:(0,l.default)("m-video",r&&""!=r?1==u?"room-offline":"room-hasuser":""),id:o,ref:function(t){return e.dom=t}}),!u&&!m&&g&&!h.videoIsFullScreen&&i.default.createElement("div",{className:"video-toolbar"},i.default.createElement("span",{className:(0,l.default)("fullscreen",h.videoIsFullScreen?"":"fullscreen-open"),onClick:(0,f.Throttle)(this.toggleFullscreen.bind(this),250,1e3)})),!u&&c&&i.default.createElement("div",{className:"video-toolbar"},h.hasVideo?i.default.createElement("span",{className:(0,l.default)("video",h.video?"video-open":"video-close",h.shareStarted?"hide-import":""),onClick:(0,f.Throttle)(this.toggleVideo.bind(this),250,1e3)}):i.default.createElement("span",null,i.default.createElement("span",{id:"tip4video",className:"tip tip4video",style:{display:"none"}},"摄像头不可用"),i.default.createElement("span",{className:(0,l.default)("video","video-disabled",h.shareStarted?"hide-import":""),onMouseOver:this.onMouseOver.bind(this,"video"),onMouseOut:this.onMouseOut.bind(this,"video")})),h.hasAudio?i.default.createElement("span",{className:(0,l.default)("audio",h.audio?"audio-open":"audio-close"),onClick:(0,f.Throttle)(this.toggleAudio.bind(this),250,1e3)}):i.default.createElement("span",null,i.default.createElement("span",{id:"tip4audio",className:"tip tip4audio",style:{display:"none"}},"麦克风不可用"),i.default.createElement("span",{className:(0,l.default)("audio","audio-disabled"),onMouseOver:this.onMouseOver.bind(this,"audio"),onMouseOut:this.onMouseOut.bind(this,"audio")}))))}}]),t}())||n;t.default=v},121:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(471);Object.defineProperty(t,"Header",{enumerable:!0,get:function(){return function(e){return e&&e.__esModule?e:{default:e}}(n).default}})},160:function(e,t,o){"use strict";function n(e){var t=void 0;return(t=document.getElementById(e))?Promise.resolve():(console.log("asynLoad start url: ",e),/\.css$/.test(e)&&((t=document.createElement("link")).rel="stylesheet",t.href=e),/\.js$/.test(e)&&((t=document.createElement("script")).src=e),t.id=e,new Promise(function(e,o){t.onload=e,document.body.appendChild(t)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)return Promise.reject("");if(e.constructor===String)return n(e);if(e.constructor===Array){var t=[];return e.map(function(e){t.push(n(e))}),Promise.all(t)}return Promise.reject("unknown parameter type of asynLoad",e)}},161:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={info:"blue",log:"#3d6dad",warn:"orange",error:"red"},r={init:function(){this.loggerInfo=console.info,this.loggerWarn=console.warn,this.loggerError=console.error,this.loggerLog=console.log,this.reset()},reset:function(){var e=this;window.console.info=function(){e.logProxy(["info"].concat(Array.prototype.slice.call(arguments)))},window.console.log=function(){e.logProxy(["log"].concat(Array.prototype.slice.call(arguments)))},window.console.warn=function(){e.logProxy(["warn"].concat(Array.prototype.slice.call(arguments)))},window.console.error=function(){e.logProxy(["error"].concat(Array.prototype.slice.call(arguments)))}},logProxy:function(){var e=arguments[0];if(1!==e.length){var t=e[0],o="color:"+n[t]+";font-size:15px";e.shift(),e[0]="%c"+e[0],e.splice(1,0,o),this.loggerLog.apply(console,e)}},log:function(e){var t=console;return function(o,n,r){console.log(o,n,r);var a=r.value;r.value=function(){for(var r=arguments.length,i=Array(r),c=0;c<r;c++)i[c]=arguments[c];t.info("("+e+") before function execute: "+n+"("+i+") = ?");var l=a.apply(o,i);return t.info("("+e+")after function execute: "+n+"("+i+") => "+l),l}}}};console.log("logger",r),t.default={init:r.init.bind(r),log:r.log}},162:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(408);!function(e){e&&e.__esModule}(o(173));t.default={open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.className,o=e.title,r=void 0===o?"提示":o,a=e.msg,i=e.btns,c=void 0===i?[]:i,l=e.close,s=e.isHtml,u={className:t,title:r,msg:a&&a.$$typeof?a:a.constructor===String?a:JSON.stringify(a),btns:c,close:l,isHtml:s};n.AlertCtrl.show(u)},close:function(){console.log("门面方法调用..."),n.AlertCtrl.hide()}}},163:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=u(r),i=u(o(6)),c=u(o(164)),l=o(19),s=o(10);function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={visible:!1},n.hide=function(){return n.setState({visible:!1}),n},n.btnClick=function(e){console.log("btn click=>",e),(0,e.onClick)(e)},f(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"show",value:function(e){var t=Object.assign(this.state,{visible:!0},e);return console.log("弹窗新属性: ",t),this.setState(t),this}},{key:"render",value:function(){var e=this,t=this.state,o=t.className,n=t.title,r=t.msg,s=t.btns,u=void 0===s?[]:s,f=t.close,d=t.isHtml;return a.default.createElement("div",{className:"u-alert-wrapper",hidden:!this.state.visible},a.default.createElement("div",{className:"u-mask"}),a.default.createElement("div",{className:(0,i.default)("u-alert",o)},a.default.createElement("div",{className:"alert-header"},a.default.createElement("div",{className:"title"},n||"提示"),a.default.createElement("div",{className:"close",onClick:function(){f?f():e.hide()}})),a.default.createElement("div",{className:"alert-body"},d?(0,c.default)(r):r),u&&u.length>0&&a.default.createElement("div",{className:"alert-footer"},u.map(function(t,o){return a.default.createElement(l.Button,{key:o,className:t.clsName,onClick:function(){return e.btnClick(t)}},t.label)}))))}}],[{key:"newInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.AppendToDom)(this,e,null)}}]),t}();t.default=d},170:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=i(r);i(o(6)),o(19);function i(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=(e.className,e.message),o=e.close,n=e.onClick;return a.default.createElement("div",{className:"u-tip"},a.default.createElement("div",{className:"u-tip-message"},t,o&&a.default.createElement("div",{className:"close",onClick:n})))}}]),t}();t.default=c},171:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(o(64)).default.emojiBaseUrl,r={emoji:{"[大笑]":{file:"emoji_0.png"},"[可爱]":{file:"emoji_01.png"},"[色]":{file:"emoji_02.png"},"[嘘]":{file:"emoji_03.png"},"[亲]":{file:"emoji_04.png"},"[呆]":{file:"emoji_05.png"},"[口水]":{file:"emoji_06.png"},"[汗]":{file:"emoji_145.png"},"[呲牙]":{file:"emoji_07.png"},"[鬼脸]":{file:"emoji_08.png"},"[害羞]":{file:"emoji_09.png"},"[偷笑]":{file:"emoji_10.png"},"[调皮]":{file:"emoji_11.png"},"[可怜]":{file:"emoji_12.png"},"[敲]":{file:"emoji_13.png"},"[惊讶]":{file:"emoji_14.png"},"[流感]":{file:"emoji_15.png"},"[委屈]":{file:"emoji_16.png"},"[流泪]":{file:"emoji_17.png"},"[嚎哭]":{file:"emoji_18.png"},"[惊恐]":{file:"emoji_19.png"},"[怒]":{file:"emoji_20.png"},"[酷]":{file:"emoji_21.png"},"[不说]":{file:"emoji_22.png"},"[鄙视]":{file:"emoji_23.png"},"[阿弥陀佛]":{file:"emoji_24.png"},"[奸笑]":{file:"emoji_25.png"},"[睡着]":{file:"emoji_26.png"},"[口罩]":{file:"emoji_27.png"},"[努力]":{file:"emoji_28.png"},"[抠鼻孔]":{file:"emoji_29.png"},"[疑问]":{file:"emoji_30.png"},"[怒骂]":{file:"emoji_31.png"},"[晕]":{file:"emoji_32.png"},"[呕吐]":{file:"emoji_33.png"},"[拜一拜]":{file:"emoji_160.png"},"[惊喜]":{file:"emoji_161.png"},"[流汗]":{file:"emoji_162.png"},"[卖萌]":{file:"emoji_163.png"},"[默契眨眼]":{file:"emoji_164.png"},"[烧香拜佛]":{file:"emoji_165.png"},"[晚安]":{file:"emoji_166.png"},"[强]":{file:"emoji_34.png"},"[弱]":{file:"emoji_35.png"},"[OK]":{file:"emoji_36.png"},"[拳头]":{file:"emoji_37.png"},"[胜利]":{file:"emoji_38.png"},"[鼓掌]":{file:"emoji_39.png"},"[握手]":{file:"emoji_200.png"},"[发怒]":{file:"emoji_40.png"},"[骷髅]":{file:"emoji_41.png"},"[便便]":{file:"emoji_42.png"},"[火]":{file:"emoji_43.png"},"[溜]":{file:"emoji_44.png"},"[爱心]":{file:"emoji_45.png"},"[心碎]":{file:"emoji_46.png"},"[钟情]":{file:"emoji_47.png"},"[唇]":{file:"emoji_48.png"},"[戒指]":{file:"emoji_49.png"},"[钻石]":{file:"emoji_50.png"},"[太阳]":{file:"emoji_51.png"},"[有时晴]":{file:"emoji_52.png"},"[多云]":{file:"emoji_53.png"},"[雷]":{file:"emoji_54.png"},"[雨]":{file:"emoji_55.png"},"[雪花]":{file:"emoji_56.png"},"[爱人]":{file:"emoji_57.png"},"[帽子]":{file:"emoji_58.png"},"[皇冠]":{file:"emoji_59.png"},"[篮球]":{file:"emoji_60.png"},"[足球]":{file:"emoji_61.png"},"[垒球]":{file:"emoji_62.png"},"[网球]":{file:"emoji_63.png"},"[台球]":{file:"emoji_64.png"},"[咖啡]":{file:"emoji_65.png"},"[啤酒]":{file:"emoji_66.png"},"[干杯]":{file:"emoji_67.png"},"[柠檬汁]":{file:"emoji_68.png"},"[餐具]":{file:"emoji_69.png"},"[汉堡]":{file:"emoji_70.png"},"[鸡腿]":{file:"emoji_71.png"},"[面条]":{file:"emoji_72.png"},"[冰淇淋]":{file:"emoji_73.png"},"[沙冰]":{file:"emoji_74.png"},"[生日蛋糕]":{file:"emoji_75.png"},"[蛋糕]":{file:"emoji_76.png"},"[糖果]":{file:"emoji_77.png"},"[葡萄]":{file:"emoji_78.png"},"[西瓜]":{file:"emoji_79.png"},"[光碟]":{file:"emoji_80.png"},"[手机]":{file:"emoji_81.png"},"[电话]":{file:"emoji_82.png"},"[电视]":{file:"emoji_83.png"},"[声音开启]":{file:"emoji_84.png"},"[声音关闭]":{file:"emoji_85.png"},"[铃铛]":{file:"emoji_86.png"},"[锁头]":{file:"emoji_87.png"},"[放大镜]":{file:"emoji_88.png"},"[灯泡]":{file:"emoji_89.png"},"[锤头]":{file:"emoji_90.png"},"[烟]":{file:"emoji_91.png"},"[炸弹]":{file:"emoji_92.png"},"[枪]":{file:"emoji_93.png"},"[刀]":{file:"emoji_94.png"},"[药]":{file:"emoji_95.png"},"[打针]":{file:"emoji_96.png"},"[钱袋]":{file:"emoji_97.png"},"[钞票]":{file:"emoji_98.png"},"[银行卡]":{file:"emoji_99.png"},"[手柄]":{file:"emoji_100.png"},"[麻将]":{file:"emoji_101.png"},"[调色板]":{file:"emoji_102.png"},"[电影]":{file:"emoji_103.png"},"[麦克风]":{file:"emoji_104.png"},"[耳机]":{file:"emoji_105.png"},"[音乐]":{file:"emoji_106.png"},"[吉他]":{file:"emoji_107.png"},"[火箭]":{file:"emoji_108.png"},"[飞机]":{file:"emoji_109.png"},"[火车]":{file:"emoji_110.png"},"[公交]":{file:"emoji_111.png"},"[轿车]":{file:"emoji_112.png"},"[出租车]":{file:"emoji_113.png"},"[警车]":{file:"emoji_114.png"},"[自行车]":{file:"emoji_115.png"}}};for(var a in r){var i=r[a];for(var c in i){var l=i[c];l.img=n+"/"+a+"/"+l.file}}for(var s={ajmd:{},xxy:{},lt:{}},u=1;u<=48;u++){var f="ajmd0"+(u>=10?u:"0"+u);s.ajmd[f]={file:f+".png"}}for(var d=1;d<=40;d++){var m="xxy0"+(d>=10?d:"0"+d);s.xxy[m]={file:m+".png"}}for(var p=1;p<=20;p++){var h="lt0"+(p>=10?p:"0"+p);s.lt[h]={file:h+".png"}}for(var g in s){var v=s[g];for(var b in v){var y=v[b];y.img=n+"/"+g+"/"+y.file}}t.default={emojiList:r,pinupList:s}},172:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={loginUrl:"#/login",registUrl:"#/regist",defaultUserIcon:"http://yx-web.nos.netease.com/webdoc/h5/im/default-icon.png"}},173:function(e,t,o){"use strict";function n(e){return e&&e.constructor}Object.defineProperty(t,"__esModule",{value:!0}),t.default={getUrlParam:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"extra",o=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)","i"),o=window.location.href.match(t);return o&&o.length>1?decodeURIComponent(o[1]):""},n=o(e);if(n)return n;var r=o(t);if(r)try{return JSON.parse(r)[e]}catch(e){}return""},isString:function(e){return n(e)===String},isNumber:function(e){return n(e)===Number},isBoolean:function(e){return n(e)===Boolean},isArray:function(e){return n(e)===Array},isFunction:function(e){return n(e)===Function},isUndefined:function(e){return void 0===n(e)},isNull:function(e){return null===n(e)},isBlank:function(e){return""==e||0==e.trim().length},removeSpace:function(e){var t=this;if(!e)return"";switch(e.constructor){case String:return e.replace(/(^\s*)|(\s*$)/g,"");case Array:return e.map(function(e){return t.removeSpace(e)});case Object:return Object.keys(e).map(function(o){return e[o]=t.removeSpace(e[o])},e),e;default:return e}},param:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];if(!t)return!0;t=t.split(" ");try{t.map(function(t){if(!e[t])throw Error("no")})}catch(e){return!1}return!0},encode:function(e,t){return t=""+t,e&&t?t.replace(e.r,function(t){var o=e[e.i?t:t.toLowerCase()];return null!=o?o:t}):t||""},escape:function(e){return(e=this.encode({r:/\<|\>|\&|\r|\n|\s|\'|\"/g,"<":"&lt;",">":"&gt;","&":"&amp;"," ":"&nbsp;",'"':"&quot;","'":"&#39;","\n":"<br/>","\r":""},e)).replace(/<br\/?>$/,"<br/>")}}},174:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.msg,o=e.time,r=e.close,a={message:t.constructor===String?t:JSON.stringify(t),time:o,close:r};n.ToastCtrl.show(a)};var n=o(461)},175:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(1),c=u(i),l=(u(o(6)),o(19),u(o(170))),s=o(10);function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d={hidden:!0},m=(r=n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state=d,n.hide=function(){var e=n.state.visible;return console.log("toast hide",e,n.state),n.setState({visible:!1}),n},n.onClick=function(e){var t=e.onClick;n.hide(),s.Valid.isFunction(t)&&t(e)},f(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),a(t,[{key:"show",value:function(e){this.state.visible;var t=Object.assign(this.state,this.props,{hidden:!1,visible:!0},e);return this.setState(t),this}},{key:"render",value:function(){var e=this.state,t=(e.className,e.message,e.close);return this.state.onClick=this.onClick.bind(this,{onClick:t}),c.default.createElement("div",{hidden:!this.state.visible},c.default.createElement(l.default,this.state))}}],[{key:"newInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=Object.assign(e,{className:"u-toast"}),(0,s.AppendToDom)(this,e,null)}}]),t}(),n.defaultProps=d,r);t.default=m},176:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(o(174));t.default={page:"",message:"",pageDone:!1,to:function(e,t){if(console.log("page to",e,t),this.message=t,e===this.page)return this.done();this.page=e,location.href="#/"+e},back:function(e){console.log("page back",e),this.message=e,history.back()},done:function(){var e=this;this.page=location.hash.replace("#/",""),console.log("page done",this.message),this.message&&setTimeout(function(){(0,n.default)({time:5,msg:e.message}),e.message=""},500)}}},183:function(e,t,o){"use strict";o(184),o(386),o(388),o(390);var n=l(o(1)),r=l(o(59)),a=o(482),i=o(480),c=l(o(403));function l(e){return e&&e.__esModule?e:{default:e}}r.default.render(n.default.createElement(i.HashRouter,null,(0,a.renderRoutes)(c.default)),document.getElementById("app"))},19:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VolumeMeter=t.EmojiPanel=t.Pagination=t.Mask=t.Icon=t.Progress=t.Tooltip=t.Tip=t.TextArea=t.Input=t.Col=t.Row=t.Button=void 0;var n=g(o(424)),r=g(o(425)),a=g(o(426)),i=g(o(427)),c=g(o(428)),l=g(o(429)),s=g(o(430)),u=g(o(431)),f=g(o(432)),d=g(o(433)),m=g(o(434)),p=g(o(435)),h=g(o(459));function g(e){return e&&e.__esModule?e:{default:e}}t.Button=n.default,t.Row=r.default,t.Col=a.default,t.Input=i.default,t.TextArea=c.default,t.Tip=l.default,t.Tooltip=s.default,t.Progress=u.default,t.Icon=f.default,t.Mask=d.default,t.Pagination=m.default,t.EmojiPanel=p.default,t.VolumeMeter=h.default},20:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},a=d(o(64)),i=(d(o(172)),o(10)),c=o(9),l=d(o(21)),s=(d(o(20)),d(o(23))),u=d(o(36)),f=(o(88),d(o(171)));function d(e){return e&&e.__esModule?e:{default:e}}var m=c.StoreChatroom.state,p=c.StoreChatroom,h=c.StoreNim.state,g=c.StoreNim,v=c.StoreNetcall.state,b=c.StoreNetcall;t.default={createChatroomMsg4Component:function(e,t,o,n,r,a){return{type:e,account:t,avatar:o,nick:n,content:r,catalog:a}},createMember4Component:function(e,t,o,n,r){return{type:e,account:t,avatar:o,nick:n,enterTime:r}},handleEmojiText:function(e){(console.log("source text: ",e),/\[[^\]]+\]/.test(e))&&e.match(/\[[^\]]+\]/g).forEach(function(t){var o=f.default.emojiList.emoji;o[t]&&(e=e.replace(t,'<img class="emoji" src="'+o[t].img+'?imageView&thumbnail=28x28">'))});return console.log("target text: ",e),e},formatChatroomMsg:function(e,t){var o=this;switch(e.type){case"text":var n=e.text;return console.log("sourceText: ",n),n=i.Valid.escape(n),console.log("escape: ",n),n=this.handleEmojiText(n),this.createChatroomMsg4Component("text",e.from,e.fromAvatar,e.fromNick,n);case"notification":var c=e.attach;switch(c.type){case"memberEnter":if(!t){this.getChatroomMembersInfo(e.from).then(function(e){console.log("memberEnter ->",e),p.addMember(o.createMember4Component(e.members[0].type,e.members[0].account,e.members[0].avatar,e.members[0].nick,e.members[0].enterTime))}).catch(function(e){console.error("获取成员信息失败...",e)});var u=i.Storage.get("isTeacher"),f=i.Storage.get("account"),d=i.Storage.get("teacherAccount");if(v.fromCreate)return b.setFromCreate(!1),console.log("设置[创建房间]的标记为false，老师首次创建房间不发起请求权限人员消息..."),this.createChatroomMsg4Component("notification",e.from,"","",c.from==h.account?"欢迎你进入房间":c.from+"进入了房间");if(e.from==d)console.log("===老师重新上线---\x3e"),1==u?b.addMember({account:e.from,self:!0},!0,!1):b.addMember({account:e.from,self:!1},!0,!1),s.default.reDrawVideos();else{var y=m.custom.shareID;m.custom.showType;y==f&&y!==d&&l.default.sendCustomSysMsg(d,{room_id:m.currChatroomId,command:15}).then(function(){console.log("通知老师端取消自己的屏幕共享状态成功！")}).catch(function(e){console.error("### 告诉老师端关闭自己的共享成功")})}if(1==u&&e.from!=f){console.log("### 老师端有学生上线...");var w=[];v.members.forEach(function(e){e.account&&""!=e.account&&w.push(e.account)}),console.log("uids: ",w),l.default.sendCustomSysMsg(e.from,{room_id:m.currChatroomId,command:1,uids:w}).then(function(){console.log("**** 主持人点对点通知有权限的成员列表成功")}).catch(function(e){console.error("**** 主持人点对点通知有权限的成员列表失败",e)})}else e.from==f&&(console.log((e.from==d?"老师":"学生")+"上线，向所有人发送请求有权限的成员消息(2s后）进行"),setTimeout(function(){if(h.hasReceiveHostMsg)return g.setHasReceiveHostMsg(!1),void console.log("#### 已收到主持人的有权限成员列表通知消息，不进行收集权限过程");console.log("*** 开始权限收集"),o.sendCustomMsg({room_id:m.currChatroomId,command:2}).then(function(){console.log("请求有权限成员的聊天室消息成功")}).catch(function(e){console.error("请求有权限成员的聊天室消息失败",e)})},2e3))}return this.createChatroomMsg4Component("notification",e.from,"","",c.from==h.account?"欢迎你进入房间":c.from+"进入了房间");case"memberExit":if(!t&&(p.delMember(e.from),1==i.Storage.get("isTeacher"))){b.setVideoIsFullScreen(!1);var S=m.custom.shareID;if(""!==S&&S==e.from){var E=r({},m.custom);Object.assign(E,{shareID:"",showType:1}),l.default.updateChatroom(E)}}return this.createChatroomMsg4Component("notification",e.from,"","",c.from+"离开了房间");case"updateChatroom":if(!t){console.log("#### updateChatroom: ",c.custom);var C=null;try{C=JSON.parse(c.custom)}catch(e){}if(null==C)return void console.error("解析custom失败");"shareID"in C||(C.shareID=""),console.log("custom: ",C);var O=m.custom.shareID;C&&p.mergeCustom(C);var k=0==C.showType&&""!==C.shareID;if(b.setHasShareScreen(k),b.setRemoteIsScreenSharing(k),!1===k){console.log(" 重新设置分享者画面..."),b.setVideoIsFullScreen(!1);i.Storage.get("teacherAccount");if(""!==O){var j=b.findMember({account:O});console.log("### 缩小",j,v.doms[j],O),s.default.startRemoteStream(O,v.doms[j]),s.default.setVideoViewRemoteSize(O)}v.shareStarted&&s.default.startCamera().then(function(){var e=v.members.findIndex(function(e){return e.account==h.account});if(-1!=e){var t=v.doms[e];t?(console.log("其他【摄像头】设备自动开启成功："),s.default.startLocalStream(t),s.default.setVideoViewSize()):console.error("@@@@ 不存在的节点，忽略渲染本地流")}else console.error("不存在的成员, 无法渲染",h.account)}).catch(function(e){console.error("其他【摄像头】设备自动开启失败：",e),"NotAllowedError"==e&&b.setHasVideo(!1)})}else 0==i.Storage.get("isTeacher")&&b.setVideoIsFullScreen(!1)}}break;case"custom":console.log("==== 聊天室自定义: ",e);var P=null;try{P=JSON.parse(e.content)}catch(e){console.error("解析聊天室自定义消息内容失败",e),P=null}if(!P)return void console.error("###聊天室自定义消息无内容");var _=P.type;if(1==_){var N=P.data.value,M=a.default.resourceUrl;return console.log(a.default),console.log("猜拳消息内容: ",N,M),this.createChatroomMsg4Component("caiquan",e.from,e.fromAvatar,e.fromNick,M+"/im/play-"+N+".png")}if(3==_){var I=P.data.catalog,T=P.data.chartlet,A=a.default.emojiBaseUrl+"/"+I+"/"+T+".png?imageView&thumbnail="+("emoji"==I?"28x28":"48x48");return this.createChatroomMsg4Component("emoji",e.from,e.fromAvatar,e.fromNick,A,I)}if(10==_){if(!t){var x=P.data.command;if(2==x)v.hasPermission&&l.default.sendCustomSysMsg(e.from,{room_id:m.currChatroomId,command:3,uids:[h.account]});else if(1==x){if(console.log("**** 主持人通知有权限成员列表的聊天室消息"),i.Storage.get("teacherAccount")!=e.from)return console.error("非主持人发送的权限广播消息，直接忽略 "),this.createChatroomMsg4Component("custom",e.from,"","","聊天室自定义消息忽略不显示");var R=P.data.uids,D=[],F="";m.members.forEach(function(e){e&&"owner"===e.type&&(F=e.account)}),R.forEach(function(e){e&&""!=e&&(F===e?D.unshift({account:e,self:e==h.account}):D.push({account:e,self:e==h.account}),0==i.Storage.get("isTeacher")&&p.setMemberStatus(e,1))}),m.members.forEach(function(e){var t=!1;R.forEach(function(o){e.account==o&&(t=!0)}),t||(console.log("已不再互动的成员状态重置:",e.account),p.setMemberStatus(e.account,0))});var L=[];v.members.forEach(function(e,t){-1==D.findIndex(function(t){return t.account==e.account})&&L.push({account:e.account,index:t})}),console.log("###### 已不再netcall互动列表的人员及对应位置为：",L),L.forEach(function(e){var t=v.doms[e.index];if(t){var o=t.getElementsByTagName("div");o.length>0&&(o=o[0],console.log("**** 清理不再互动的画面节点：",o),t.removeChild(o))}}),b.setMembers(D),s.default.reDrawVideos()}}}else console.log("忽略聊天室自定义消息type: ",_);return this.createChatroomMsg4Component("custom",e.from,"","","聊天室自定义消息忽略不显示")}return this.createChatroomMsg4Component("custom",e.from,"","","聊天室自定义消息忽略不显示")},onChatroomMsgs:function(e){var t=this;console.log("onChatroomMsgs",e),Array.isArray(e)||(e=[e]),e=e.map(function(e){return t.formatChatroomMsg(e,!1)}),console.log("$$$$$$$ 收到消息:",e.length,e),p.setMsgs(e),setTimeout(function(){var e=document.getElementById("chat-msg-list");e&&(e.scrollTop=e.scrollHeight)},0)},sendChatroomMsg:function(e){var t=m.currChatroom,o=this;return new Promise(function(n,r){t.sendText({text:e,done:function(e,t){e?r(e):(o.onChatroomMsgs([t]),n())}})})},sendCustomMsg:function(e){var t=m.currChatroom;return new Promise(function(o,n){t.sendCustomMsg({content:JSON.stringify({type:10,data:e}),done:function(e,t){e?n(e):o()}})})},sendCqMsg:function(){var e=m.currChatroom,t=this;return new Promise(function(o,n){e.sendCustomMsg({content:JSON.stringify({type:1,data:{value:Math.ceil(3*Math.random())}}),done:function(e,r){e?n(e):(t.onChatroomMsgs([r]),o())}})})},sendPinupMsg:function(e,t){var o=m.currChatroom,n=this;return new Promise(function(r,a){o.sendCustomMsg({content:JSON.stringify({type:3,data:{catalog:e,chartlet:t}}),pushContent:"[贴图表情]",done:function(e,t){e?a(e):(n.onChatroomMsgs([t]),r())}})})},create:function(e){var t={url:a.default.url+"/api/chatroom/create",type:"POST",data:{creator:c.StoreNim.state.account,name:e,ext:JSON.stringify({showType:1,fullScreenType:0,shareID:""})}};return(0,i.Ajax)(t).then(function(e){if(200===e.res){var t=e.msg;return Promise.resolve(t)}return Promise.reject("创建聊天室失败")}).catch(function(e){return console.error("创建聊天室请求错误或超时"),Promise.reject(e)})},login:function(e){var t=this,o={url:a.default.url+"/api/chatroom/getAddress",type:"POST",dataType:"form",data:{uid:c.StoreNim.state.account,roomid:e}};return(0,i.Ajax)(o).then(function(o){if(console.log("获取聊天室地址",o),200===o.res){var n=o.msg.addr;return t._login({chatroomId:e,address:n})}return Promise.reject(o.errmsg)}).catch(function(e){return console.error("获取roomid对应的聊天室地址请求错误或超时",e),Promise.reject(e)})},_login:function(e){var t=this,o=this,r=e.chatroomId,l=e.address;return r&&l?new Promise(function(e,s){window.chatroom=window.Chatroom.getInstance({appKey:a.default.appkey,account:c.StoreNim.state.account,token:c.StoreNim.state.token,chatroomId:r,chatroomAddresses:l,onconnect:function(t){console.log("聊天室连接已建立...",t);var a={};try{"string"==typeof(a=t.chatroom.custom)&&(a=JSON.parse(a))}catch(e){}"object"!==(void 0===a?"undefined":n(a))&&(a={}),"shareID"in a||(a.shareID=""),""!==a.shareID?b.setHasShareScreen(!0):b.setHasShareScreen(!1),p.setCustom(a),p.setChatroom(r,window.chatroom),p.setCurrChatroomId(r),o.getFirstMemebers(),o.doGetChatroom(),e()},onerror:function(e,t){e&&(console.error("chatroom::onerror",e),o.logout(m.currChatroomId,"网络连接状态异常")),s(e)},onwillreconnect:function(e){console.warn("chatroom::onwillreconnect",e),(0,i.Toast)({msg:"聊天室断开，正在重连中"})},ondisconnect:function(e){if(console.log("chatroom::ondisconnect",e),e)switch(e.code){case 302:i.Page.to("login","账号或者密码错误");break;case 13003:o.logout(m.currChatroomId,"抱歉，你已被踢出该房间并被拉入了黑名单");break;case"kicked":if("managerKick"===e.reason)o.logout(m.currChatroomId,"抱歉，你已被踢出该房间");else if("samePlatformKick"===e.reason)o.logout(m.currChatroomId,"不允许同一个帐号重复登录同一个聊天室");else if("chatroomClosed"===e.reason){if(o.clickBtnClose)return void(o.clickBtnClose=!1);var t="owner"!=m.type?"创建房间的人已经结束了教学":"抱歉，您被踢出(该账号在其他设备创建房间)";i.Alert.open({title:"提示",msg:'<div class="u-kickedroom"><i class="u-icon-tip"></i>'+t+"</div>",isHtml:!0,btns:[{label:"确认",clsName:"u-btn-smaller",onClick:function(){console.log("【提示退出房间】 --\x3e 确认"),o.doLogout()}}],close:function(){console.log("【提示退出房间】 --\x3e X"),o.doLogout()}})}else o.logout(m.currChatroomId,"被踢原因："+e.reason);break;default:(0,i.Toast)({msg:e.message})}},onmsgs:t.onChatroomMsgs.bind(t)})}):Promise.reject("请输入聊天室id和地址")},doGetChatroom:function(){this.getChatroom().then(function(e){console.log("获取聊天室信息成功:",e);var t=null;try{t=JSON.parse(e.chatroom.custom)}catch(e){}if(null!=t){"shareID"in t||(t.shareID="");var o=""!==t.shareID&&0===t.showType;b.setHasShareScreen(o),b.setRemoteIsScreenSharing(o),p.setCustom(t)}else console.error("解析custom失败")}).catch(function(e){console.error("获取聊天室信息失败:",e)})},doLogout:function(){i.Alert.close(),this.logout(m.currChatroomId,"聊天室关闭了")},close:function(e){this.clickBtnClose=!0;var t={url:a.default.url+"/api/chatroom/close",type:"POST",data:{uid:c.StoreNim.state.account,roomid:e}};return(0,i.Ajax)(t).then(function(e){if(200===e.res){var t=e.msg;return Promise.resolve(t)}return Promise.reject("关闭聊天室失败")}).catch(function(e){return console.error("关闭聊天室请求错误或超时"),Promise.reject(e)})},logout:function(e,t){var o=m.currChatroom;o&&o.disconnect(),p.setChatroom(e,null),p.setCurrChatroomId(""),p.clearMsgs(),p.clearMembers(),p.setType(""),p.setIsShowMemberTab(!1),p.setLastTimestamp(0),p.setCanLoadHistory(!0),p.setShowEmojiPanel(!1),p.setHasPermissionRequest(!1),s.default.leaveChannel().then(function(){console.log("RTC房间离开成功"),s.default.clear(),u.default.leaveChannel(),u.default.clearAll()}).catch(function(e){console.error("RTC房间离开失败",e),s.default.clear()}),i.Storage.remove("roomId"),i.Storage.remove("isTeacher"),i.Storage.remove("joinFlag"),i.Page.to("home",t)},getChatroomMembers:function(e){var t=m.currChatroom;if(t)return new Promise(function(o,n){t.getChatroomMembers({guest:e,limit:100,done:function(e,t){e?n(e):o(t.members)}})})},getChatroomMembersInfo:function(e){var t=m.currChatroom;if(t)return new Promise(function(o,n){t.getChatroomMembersInfo({accounts:[e],done:function(e,t){e?n(e):(console.log(t),o(t))}})})},getHistoryMsgs:function(e){var t=m.currChatroom;if(t)return new Promise(function(o,n){t.getHistoryMsgs({timetag:e,limit:50,reverse:!1,done:function(e,t){e?n(e):(console.log("历史消息: ",t.msgs),o(t.msgs))}})})},getChatroom:function(){var e=m.currChatroom;if(e)return new Promise(function(t,o){e.getChatroom({done:function(e,n){e?o(e):t(n)}})})},getFirstMemebers:function(){var e=this;return this.getChatroomMembers(!1).then(function(t){console.log("获取聊天室成员(非游客)成功",t);var o=[];return t.forEach(function(t){t.online&&o.push(e.createMember4Component(t.type,t.account,t.avatar,t.nick,t.enterTime)),"owner"==t.type&&(console.log("预占位老师到RTC房间"),i.Storage.set("teacherAccount",t.account),t.account==h.account&&(console.log("=== 老师标记位重新设置：1"),i.Storage.set("isTeacher",1),b.settabindex(0),b.setShareStarted(!1),p.mergeCustom({showType:1,shareID:"",fullScreenType:0}),b.setHasShareScreen(!1),l.default.updateChatroom(m.custom)),b.addMember({account:t.account,self:t.account==h.account,offline:!t.online}))}),console.log(o),p.setMembers(o),console.log("现在的成员列表是： ",p.state.members),e.getChatroomMembers(!0)}).then(function(t){console.log("获取聊天室成员(游客)成功",t);var o=[];t.forEach(function(t){o.push(e.createMember4Component(t.type,t.account,t.avatar,t.nick,t.enterTime))}),console.log(o),p.setMembers(o),console.log("现在的成员列表是： ",p.state.members)}).catch(function(e){console.error("获取聊天室成员失败",e)})}}},21:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},r=p(o(1)),a=p(o(64)),i=(p(o(172)),o(10)),c=o(441),l=o(9),s=p(o(21)),u=p(o(20)),f=p(o(23)),d=p(o(36)),m=p(o(89));function p(e){return e&&e.__esModule?e:{default:e}}var h=l.StoreChatroom.state,g=l.StoreChatroom,v=l.StoreNim.state,b=l.StoreNim,y=l.StoreNetcall.state,w=l.StoreNetcall;l.StoreEventPool,l.StoreEventPool.state;window.WebRTC&&window.NIM.use(window.WebRTC),window.WhiteBoard&&window.NIM.use(window.WhiteBoard),t.default={regist:function(e){return i.Valid.param(e,"username password nickname")?(e.password=(0,i.MD5)(e.password),(0,i.Ajax)({url:a.default.url+"/api/createDemoUser",type:"POST",dataType:"form",data:e}).then(function(e){return e&&200===e.res?Promise.resolve():Promise.reject(e.errmsg)}).catch(function(e){return Promise.reject(e)})):Promise.reject("注册失败: 参数不完整，请检查")},login:function(e,t){var o=this;return v.nim?(console.log("=== 已存在的nim实例， 不再重新初始化..."),Promise.resolve()):e&&t?new Promise(function(n,r){window.nim=window.NIM.getInstance({debug:!0,appKey:a.default.appkey,account:e,token:t,db:!1,syncSessionUnread:!0,syncRobots:!0,autoMarkRead:!0,onconnect:function(o){console.log("im连接成功...."),b.setNim(window.nim),b.setAccount(e),b.setToken(t)},onerror:function(e){console.error("网络连接状态异常",e),i.Page.to("login","网络连接状态异常")},onwillreconnect:function(){console.log(event)},ondisconnect:function(e){var t="";switch(e.code){case 302:r("帐号或密码错误",e);break;case"kicked":var o=e.from;t="你的帐号于"+util.formatDate(new Date)+"被"+({PC:"电脑版",Web:"网页版",Android:"手机版",iOS:"手机版",WindowsPhone:"手机版"}[o]||"其他端")+"踢出下线，请确定帐号信息安全!",i.Page.to("login",t)}},onmsg:o.onMsg.bind(o),oncustomsysmsg:o.onCustomSysMsg.bind(o),onsyncdone:function(){console.log("onsyncdone"),n()}})}):Promise.reject("请输入登录名和密码")},onCustomSysMsg:function(e){var t=this;if(console.log("收到onCustomSysMsg: ",e),"custom"==e.type&&"p2p"==e.scene){var o=null;try{o=JSON.parse(e.content)}catch(e){console.error(e,"解析自定义系统通知消息内容失败"),o=null}if(!o)return void console.error("无内容：",o);if(console.log(o),10==o.type){var a=function(){console.log("取消对方的屏幕共享");var t=h.members.find(function(t){return t.account===e.from}),o=h.custom;if(t&&t.account==o.shareID){var r=n({},h.custom);Object.assign(r,{shareID:"",showType:1}),s.default.updateChatroom(r),console.log("**** 成员关闭屏幕共享， 主持人收到点对点后， 更新房间信息。")}};switch(o.data.command){case 1:b.setHasReceiveHostMsg(!0),i.Storage.set("teacherAccount",e.from);var l=[];o.data.uids.forEach(function(t){l.push({account:t,self:v.account==t}),t!=e.from&&g.setMemberStatus(t,1)}),w.setMembers(l),l.forEach(function(e){m.default.handleRtcPermissionAndDraw(e.account)}),f.default.reDrawVideos();break;case 3:var d=e.from;w.addMember({account:d,self:!1}),g.setMemberStatus(d,1),m.default.handleRtcPermissionAndDraw(d);break;case 10:console.log("收到连麦请求",e),g.setMemberStatus(e.from,2),h.isShowMemberTab||(console.log("*** 当前不在成员列表TAB，设置有人请求加麦标记"),g.setHasPermissionRequest(!0));break;case 11:console.log("主持人同意连麦请求"),console.log("默认设置视频与麦克风都可用..."),w.setVideo(!0),w.setAudio(!0),i.Alert.open({title:"操作确认",msg:r.default.createElement(c.ConfirmDeviceContent,null),btns:[{label:"确定",clsName:"u-btn-smaller",onClick:function(){console.log("【设备确认弹窗】--\x3e 确定.."),t.doConfirmDevice()}}],close:function(){console.log("【设备确认弹窗】--\x3e X.."),t.doConfirmDevice()}});break;case 12:console.log("主持人拒绝连麦请求"),this.doEndInteraction4CurrentStudent(),i.Alert.open({title:"提示",msg:'<div class="u-end-interaction"><i class="u-icon-tip"></i>你被创建人取消互动</div>',isHtml:!0,btns:[{label:"确定",clsName:"u-btn-smaller",onClick:function(){console.log("【老师剔除学生，学生提示弹窗】--\x3e 确定"),i.Alert.close()}}],close:function(){console.log("【老师剔除学生，学生提示弹窗】--\x3e x"),i.Alert.close()}});break;case 13:console.log("收到取消连麦请求",e),g.setMemberStatus(e.from,0),g.hasPermissionRequestMember()?console.log("尚有成员请求连麦，红点依然显示..."):(console.log("无成员请求连麦，红点直接不显示..."),g.setHasPermissionRequest(!1)),w.delMember(e.from),f.default.stopRemoteStream(e.from),f.default.stopPlayRemoteAudio(e.from),f.default.reDrawVideos();var p=[];y.members.forEach(function(e){e.account&&""!=e.account&&p.push(e.account)}),console.log("**** 成员取消或停止连麦， 主持人收到点对点后， 发送群广播。待通知有权限列表为：",p),u.default.sendCustomMsg({room_id:h.currChatroomId,command:1,uids:p}).then(function(){console.log("[停止互动后]主持人通知成员有权限的成员列表成功")}).catch(function(e){console.error("[停止互动后]主持人通知成员有权限的成员列表失败",e)}),a();break;case 14:console.log("互动者分享屏幕",e);var S=h.custom;if(""===S.shareID){var E=h.members.find(function(t){return t.account===e.from});E&&1===E.status&&(g.mergeCustom({shareID:e.from,showType:0}),s.default.updateChatroom(h.custom),console.log("**** 成员开启屏幕共享， 主持人收到点对点后， 更新房间信息。"))}else console.warn("当前已有成员在共享屏幕: ",S);break;case 15:console.log("收到取消屏幕共享请求",e),a()}}}},sendCustomMsg:function(e,t){var o=v.nim;return new Promise(function(n,r){o.sendCustomMsg({scene:"p2p",to:e,content:JSON.stringify({type:10,data:t}),done:function(e,t){e?r(e):n()}})})},sendCustomSysMsg:function(e,t){var o=v.nim;return new Promise(function(n,r){o.sendCustomSysMsg({scene:"p2p",to:e,sendToOnlineUsersOnly:!0,isPushable:!1,content:JSON.stringify({type:10,data:t}),done:function(e,t){console.log("发送的自定义系统通知消息为：",t),e?r(e):n()}})})},updateChatroom:function(e){var t=h.currChatroom;if(t)return new Promise(function(o,n){t.updateChatroom({chatroom:{custom:JSON.stringify(e)},needNotify:!0,custom:JSON.stringify(e),done:function(e,t){console.log("更新聊天室信息"+(e?"失败":"成功"),e,t),e?n(e):o()}})})},onMsg:function(e){console.log("收到im消息onMsg: ",e)},doConfirmDevice:function(){i.Alert.close(),console.log("互动模式","audio: ",y.audio,", video: ",y.video),w.setHasPermission(!0),w.addMember({account:v.account,self:!0}),g.setMemberStatus(v.account,1),d.default.changeRoleToPlayer(),d.default.checkColor(),y.hasAudio&&y.audio&&f.default.startMicro().then(function(){console.log("===麦克风启动成功")}).catch(function(e){console.error("===麦克风启动失败",e),"NotAllowedError"==e&&w.setHasAudio(!1)}),y.hasVideo&&y.video&&f.default.startCamera().then(function(){console.log("===摄像头启动成功");var e=y.members.findIndex(function(e){return e.account==v.account});if(-1!=e){var t=y.doms[e];t?(console.log("当前人员加入节点：",t),f.default.startLocalStream(t),f.default.setVideoViewSize()):console.error("@@@@ 不存在的节点，忽略渲染本地流")}else console.error("不存在的成员, 无法渲染",v.account)}).catch(function(e){console.error("===摄像头启动失败",e),"NotAllowedError"==e&&w.setHasVideo(!1)}),f.default.changeRoleToPlayer()},doEndInteraction4CurrentStudent:function(){d.default.changeRoleToAudience();var e=y.members.findIndex(function(e){return e.account==v.account});-1==e?console.error("未找到对应DOM节点,无法停止流..."):f.default.stopLocalStream(y.doms[e]),w.delMember(v.account),w.setHasPermission(!1),w.setShowStatus(0),g.setMemberStatus(v.account,0),f.default.changeRoleToAudience().then(function(){return console.log("==== 切换为观众成功"),f.default.stopMicro()}).then(function(){return console.log("==== 停止麦克风成功"),w.setAudio(!1),f.default.stopCamera()}).then(function(){console.log("==== 停止摄像头成功"),w.setVideo(!1)}).catch(function(e){console.error("停止本地行为失败",e)})},logout:function(){v.nim&&v.nim.disconnect(),b.setAccount(""),b.setToken(""),window.nim=null,b.setNim(null),i.Storage.remove("account"),i.Storage.remove("token"),i.Page.to("login")}}},23:function(e,t,o){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});s(o(64));var r=o(9),a=(o(88),o(10)),i=s(o(85)),c=(s(o(21)),s(o(20)),s(o(23))),l=s(o(89));function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var f=r.StoreNim.state,d=(r.StoreNim,r.StoreChatroom.state,r.StoreChatroom),m=r.StoreNetcall.state,p=r.StoreNetcall,h=r.StoreEventPool;r.StoreEventPool.state;t.default=(u(n={initSDK:function(){console.log("无WEBRTC实例，进行初始化..."),NIM.use(WebRTC);var e="gapafbpmfemleaplicdhhcikajbogpkf";"Chrome"===i.default.name&&+i.default.version.split(".")[0]>=72&&(e=void 0),window.webrtcIns=window.WebRTC.getInstance({debug:!0,nim:f.nim,chromeId:e}),p.setWebRtc(window.webrtcIns),this.switchEventListener(!0)},switchEventListener:function(e){var t=m.webrtc,o=e?"on":"removeListener";t[o]("joinChannel",this.onJoinChannel.bind(this)),t[o]("leaveChannel",this.onLeaveChannel.bind(this)),t[o]("deviceStatus",this.onDeviceStatus.bind(this)),t[o]("deviceAdd",this.onDeviceAdd.bind(this)),t[o]("deviceRemove",this.onDeviceRemove.bind(this)),t[o]("audioVolume",this.onAudioVolume.bind(this)),t[o]("remoteSignalClosed",this.onRemoteSignalClosed.bind(this)),t[o]("signalClosed",this.onSignalClosed.bind(this)),t[o]("remoteTrack",this.onRemoteTrack.bind(this)),t[o]("control",this.onControlTrack.bind(this))},onJoinChannel:function(e){console.log("==== webrtc房间有人加入了",e)},onLeaveChannel:function(e){console.log("==== webrtc房间有人离开了",e),a.Storage.get("teacherAccount")!=e.account?(console.log("学生下线，清理房间占位"),p.delMember(e.account)):(console.log("老师下线，不清理房间占位"),p.setTeacherStatus(e.account,!0)),c.default.reDrawVideos(),e.account==f.account&&a.Storage.set("hasPermission",!1)},onDeviceStatus:function(e){console.log("==== webrtc 设备变更: ",e)},onDeviceAdd:function(e){var t=this;console.log("==== webrtc设备新增",e),e.forEach(function(e){"video"==e.type?(p.setHasVideo(!0),0==m.tabIndex&&t.doStartCamera()):"audioIn"==e.type&&t.doStartMicro()})},onDeviceRemove:function(e){var t=this;console.log("==== webrtc设备移除",e),e.forEach(function(e){"video"==e.type?m.webrtc.getDevicesOfType(WebRTC.DEVICE_TYPE_VIDEO).then(function(e){e.length>0?t.doStartCamera():(p.setHasVideo(!1),c.default.stopLocalStream())}):"audioIn"==e.type&&m.webrtc.getDevicesOfType(WebRTC.DEVICE_TYPE_AUDIO_IN).then(function(e){e.length>0?t.doStartMicro():p.setHasAudio(!1)})})},onAudioVolume:function(e){Object.keys(e).forEach(function(t){"self"==t?d.setMemberAudioVolume(f.account,e[t].status):d.setMemberAudioVolume(t,e[t].status)})},onRemoteSignalClosed:function(e){console.log("==== remoteSignalClosed ",e)},onSignalClosed:function(e){console.log("==== signalClosed ",e);var t=a.Storage.get("teacherAccount");f.account==t?p.setTeacherStatus(t,!0):(p.delMember(f.account),p.setHasPermission(!1)),d.delMember(f.account)},onRemoteTrack:function(e){console.log("==== 收到远程轨道",e);var t=e.account;console.log("remote account：",t),"video"==e.track.kind?(h.addRemoteTrackNotification(t),l.default.handleRtcPermissionAndDraw(t)):"audio"==e.track.kind&&c.default.startPlayRemoteAudio()},onControlTrack:function(e){console.log("触发控制",e)},doStartCamera:function(){if(p.setHasVideo(!0),m.video){console.log("当前需要开启摄像头...");var e=m.members.findIndex(function(e){return e.account==f.account});if(-1==e)return void console.error("未找到当前RTC房间互动者:",f.account);var t=m.doms[e];if(!t)return void console.error("@@@@ 不存在的节点，忽略渲染本地流");console.log("当前人员加入节点：",t),c.default.startCamera().then(function(){console.log("其他【摄像头】设备自动开启成功："),c.default.startLocalStream(t),c.default.setVideoViewSize()}).catch(function(e){console.error("其他【摄像头】设备自动开启失败：",e),"NotAllowedError"==e&&p.setHasVideo(!1)})}else console.log("当前不需要开启摄像头...")},doStartMicro:function(){if(p.setHasAudio(!0),m.audio){if(console.log("当前需要开启麦克风..."),-1==m.members.findIndex(function(e){return e.account==f.account}))return void console.error("未找到当前RTC房间互动者:",f.account);c.default.startMicro().then(function(){console.log("其他【麦克风】设备自动开启成功：")}).catch(function(e){console.error("其他【麦克风】设备自动开启失败：",e),"NotAllowedError"==e&&p.setHasAudio(!1)})}else console.log("当前不需要开启麦克风...")},createChannel:function(e){return console.log("createChannel -> ",e),m.webrtc.createChannel({channelName:e,webrtcEnable:!0})},joinChannel:function(e){console.log("joinChannel -> ",e);var t={videoQuality:WebRTC.CHAT_VIDEO_QUALITY_HIGH,videoFrameRate:WebRTC.CHAT_VIDEO_FRAME_RATE_25,highAudio:!1};return m.webrtc.joinChannel({channelName:e,type:WebRTC.NETCALL_TYPE_VIDEO,sessionConfig:t})},leaveChannel:function(){return console.log("leaveChannel"),m.webrtc.leaveChannel()},clear:function(){this.switchEventListener(!1),window.WebRTC.destroy(),window.webrtcIns=null,p.setWebRtc(null),p.setRemoteIsScreenSharing(!1),p.setVideoIsFullScreen(!1),p.clearDoms(),p.setFromCreate(!1),p.setHasPermission(!1),p.setShowStatus(0),p.clearMembers(),p.setVideo(!0),p.setAudio(!0),h.clearRemoteTrackNotifications(),WebRTC.checkCompatibility().then(function(e){var t=e.Camera,o=e.Microphone;console.log(e),p.setHasAudio(o),p.setHasVideo(t)}).catch(function(e){console.error("获取当前机器可用设备时异常: ",e),p.setHasAudio(!1),p.setHasVideo(!1)}),a.Storage.remove("hasPermission"),a.Storage.remove("teacherAccount")},reDrawVideos:function(){m.members.forEach(function(e,t){var o=e.account;""!=o?o==f.account?(console.log("重新渲染自己本地画面",o),c.default.startLocalStream(m.doms[t]),c.default.setVideoViewSize()):(console.log("重新渲染远程画面",o),l.default.handleRtcPermissionAndDraw(o,t)):console.log("ignore Unknown account",t)})},startMicro:function(){return m.webrtc.startDevice({type:WebRTC.DEVICE_TYPE_AUDIO_IN})},startCamera:function(){return m.webrtc.startDevice({type:WebRTC.DEVICE_TYPE_VIDEO})},startChromeShareScreen:function(){return m.webrtc.startDevice({type:WebRTC.DEVICE_TYPE_DESKTOP_CHROME_SCREEN})},stopMicro:function(){return m.webrtc.stopDevice(WebRTC.DEVICE_TYPE_AUDIO_IN)},stopCamera:function(){return m.webrtc.stopDevice(WebRTC.DEVICE_TYPE_VIDEO)},startLocalStream:function(e){return m.webrtc.startLocalStream(e)},stopLocalStream:function(e){return m.webrtc.stopLocalStream(e)}},"stopLocalStream",function(){return m.webrtc.stopLocalStream()}),u(n,"changeRoleToPlayer",function(){return m.webrtc.changeRoleToPlayer()}),u(n,"changeRoleToAudience",function(){return m.webrtc.changeRoleToAudience()}),u(n,"startRtc",function(){return m.webrtc.startRtc()}),u(n,"startRemoteStream",function(e,t){return m.webrtc.startRemoteStream({account:e,node:t})}),u(n,"stopRemoteStream",function(e){return m.webrtc.stopRemoteStream(e)}),u(n,"startPlayLocalAudio",function(){return m.webrtc.startDevice({type:WebRTC.DEVICE_TYPE_AUDIO_OUT_LOCAL})}),u(n,"stopPlayLocalAudio",function(){return m.webrtc.stopDevice(WebRTC.DEVICE_TYPE_AUDIO_OUT_LOCAL)}),u(n,"startPlayRemoteAudio",function(e){return m.webrtc.setAudioStart(e)}),u(n,"stopPlayRemoteAudio",function(e){m.webrtc.setAudioBlack(e)}),u(n,"setVideoViewSize",function(){setTimeout(function(){m.webrtc.setVideoViewSize({width:139,height:104,cut:!0})},200)}),u(n,"setVideoViewRemoteSize",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:139,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:104;return m.webrtc.setVideoViewRemoteSize({account:e,width:t,height:o,cut:!0})}),n)},36:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(10),r=o(9),a=r.StoreWhiteBoard.state,i=r.StoreChatroom.state;t.default={wb:null,info:null,calling:!1,initSDK:function(){this.wb||(window.whiteboard=this.wb=WhiteBoard.getInstance({nim:window.nim,debug:!1}),this.bindEvent(),window.nim.on("notifyTransLog",function(e){console.log("notifyTransLog",e),r.StoreWhiteBoard.setFileState(e)}),this.initDrawPlugin())},initDrawPlugin:function(){var e=this;this.drawPlugin=new DrawPlugin(a.node,{UID:this.wb.getAccount(),nim:window.nim}),this.drawPlugin.on("data",function(t){var o=t.toAccount,n=void 0===o?0:o,r=t.data;r&&e.wb.sendData({toAccount:n,data:r})})},bindEvent:function(){var e=this.wb,t=this;e.on("signalClosed",function(e){t.hangup&&t.hangup(),console.error("on signalClosed",e)}),e.on("error",function(e){t.hangup&&t.hangup(),console.error("on error",e)}),e.on("joinChannel",function(e){console.log("onJoinChannel",e),e.account===n.Storage.get("teacherAccount")&&t.lazySync()}),e.on("data",function(e){console.log("data",e),t.drawPlugin&&t.drawPlugin.act({account:e.account,data:e.data})}),e.on("leaveChannel",function(e){console.log("onLeaveChannel",e)}),e.on("control",function(t){e.notCurrentChannelId(t)||console.log("onControl",t)})},createChannel:function(e){return console.log("wb::createChannel",e),this.wb.createChannel({channelName:e}).then(function(e){console.log("wb::createChannel success",e)}).catch(function(e){return console.error("wb::createChannelErr",e),Promise.reject(e)})},_startSession:function(){return this.wb.startSession()},clearAll:function(){this.wb.destroy(),this.wb=null,window.whiteboard=null,r.StoreWhiteBoard.whiteboard=null,this.drawPlugin.destroy(),this.drawPlugin=null},joinChannel:function(e){var t=this;return this.wb?(console.log("wb::joinChannel",e),this.info={channelName:e,sessionConfig:{color:"#000"}},(0,n.Pipes)(this._joinChannel.bind(this),this._startSession.bind(this)).then(function(e){console.log("wb::session Started",e)}).catch(function(e){return console.error("wb::joinChannelErr",e),t.wb.leaveChannel(),Promise.reject(e)})):Promise.reject("wb::没有实例化")},_joinChannel:function(){var e=this;return this.wb.joinChannel(this.info).then(function(){return e.lazySyncOwner(),Promise.resolve()})},leaveChannel:function(){console.log("wb::leaveChannel"),this.wb&&this.wb.leaveChannel(),r.StoreWhiteBoard.reset()},lazySync:function(){var e=this;setTimeout(function(){if(console.log("joinChannel SYNC",i.type),!i.type)return e.lazySync();if("owner"!==i.type){var t=n.Storage.get("teacherAccount");console.log("makeSync",t),e.syncRequest(t)}},50)},lazySyncOwner:function(){var e=this;setTimeout(function(){if(console.log("joinChannel SYNC",i.type),!i.type)return e.lazySyncOwner();"owner"===i.type&&(e.getFileList(),e.syncBegin())},50)},setContainer:function(e){console.log("wb::setContainer",e),r.StoreWhiteBoard.setContainer(e),this.drawPlugin&&this.drawPlugin.setContainer(e)},setColor:function(e){this.drawPlugin&&this.drawPlugin.setColor(e),r.StoreWhiteBoard.setColor(e)},checkColor:function(){this.setColor(a.currentDrawColor)},changeRoleToAudience:function(){console.log("wb::changeRoleToAudience"),this.drawPlugin&&this.drawPlugin.changeRoleToAudience()},changeRoleToPlayer:function(){console.log("wb::changeRoleToPlayer"),this.drawPlugin&&this.drawPlugin.changeRoleToPlayer()},setDrawModeFlag:function(){this.drawPlugin&&this.drawPlugin.setDrawMode("flag"),r.StoreWhiteBoard.setDrawMode("flag")},setDrawModeFree:function(){this.drawPlugin&&this.drawPlugin.setDrawMode("free"),r.StoreWhiteBoard.setDrawMode("free")},undo:function(){this.drawPlugin&&this.drawPlugin.undo()},redo:function(){this.drawPlugin&&this.drawPlugin.redo()},clear:function(){this.drawPlugin&&this.drawPlugin.clear()},uploadFile:function(){var e=a.fileInput;if(e){var t=null;console.log("uploadFile111");var o={transcode:"jpg",type:"file",beginupload:function(e){var o=e.options,n=o.fileInputName,a=o.transtype,i=o.docId;t=i,console.log("beginupload",e.options),console.log("fileInputName type",n,a),r.StoreWhiteBoard.addFile({docId:i,name:n,mime:a,state:11,percent:0,prefix:""})},uploadprogress:function(e){console.log("uploadprogress",e);var t={docId:e.docId,percent:e.percentage};100===t.percent&&(t.state=a.serializeFileStateMap.TRANSING,t.percent=0),r.StoreWhiteBoard.setFileState(t)},uploaddone:function(e,o){console.log("uploaddone",e,o,t);var n={docId:t,name:o.fileInputName,percent:100,state:2};e?n.state=a.serializeFileStateMap.UPLOADFAIL:(n.state=a.serializeFileStateMap.TRANSING,n.percent=0),r.StoreWhiteBoard.setFileState(n)},done:function(e,t){console.log("send file done",e,t)}};e&&(o.fileInput=e),window.nim.previewFile(o)}},setImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.currentFile;console.log("setImage",t);t.name.replace(/\.\w+$/,"");var o=t.prefix+"_"+t.type+"_"+e+"."+a.fileTypeMap[t.transType];this.drawPlugin&&this.drawPlugin.image({url:o,docId:t.docId,pageCount:t.pageCount,currentPage:e}),r.StoreWhiteBoard.setCurrentFilePage(e)},clearFile:function(){this.drawPlugin&&this.drawPlugin.clearImage(),r.StoreWhiteBoard.setCurrentFile(-1)},deleteFile:function(e){window.nim.deleteFile({docId:e,error:function(e,t){console.error("deleteFile error",e,t)},success:function(){console.log("deleteFile success");var t={docId:e,percent:0,state:a.serializeFileStateMap.TRANSING};r.StoreWhiteBoard.setFileState(t),r.StoreWhiteBoard.deleteFile(e)}})},getFile:function(e){window.nim.getFile({docId:e,success:function(e){console.log("getFile success",e)},error:function(e){console.error("getFile error",e)}})},getFileList:function(){console.log("getFileList"),window.nim.getFileList({limit:30,success:function(e){console.log("getFileList success",e),r.StoreWhiteBoard.setFileList({list:e.list,count:e.totalCount})},error:function(e){console.error("getFileList error",e)}})},syncBegin:function(){this.drawPlugin&&this.drawPlugin.syncBegin()},syncRequest:function(e){this.drawPlugin&&this.drawPlugin.syncRequest(e)}}},386:function(e,t,o){},388:function(e,t,o){},390:function(e,t,o){},403:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});c(o(1)),o(10);var n=c(o(470)),r=c(o(476)),a=c(o(477)),i=c(o(479));function c(e){return e&&e.__esModule?e:{default:e}}var l={home:n.default,login:r.default,main:a.default,regist:i.default};t.default=[{path:"/login",exact:!0,component:l.login},{path:"/regist",exact:!0,component:l.regist},{path:"/",exact:!0,component:l.home},{path:"/home",exact:!0,component:l.home},{path:"/main",exact:!0,component:l.main}]},404:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e.url||!e.data)return Promise.reject("参数不完整，无法发起请求");e.dataType=e.dataType||"json",e.dataType=e.dataType.toLowerCase();var t=new XMLHttpRequest;t.timeout=2e4,t.open(e.type||"GET",e.url,!0),t.responseType=""+e.dataType,t.setRequestHeader("Content-type",r[e.dataType]);t.setRequestHeader("appkey",n.default.appkey);return new Promise(function(o,n){t.onload=function(){var n=t.response;"form"===e.dataType&&(n=JSON.parse(n)),o(n)},t.onerror=function(e){console.error("xhr error",e),n("请求错误，请重试")},t.ontimeout=function(e){console.error("xhr timeout",e),n("请求超时，请重试")},"json"===e.dataType?t.send(JSON.stringify(e.data)):"form"===e.dataType&&t.send(a(e.data))})};var n=function(e){return e&&e.__esModule?e:{default:e}}(o(64));var r={json:"application/json;charset=UTF-8",form:"application/x-www-form-urlencoded"},a=function(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(/Object/i.test(e[t])?JSON.stringify(e[t]):e[t])}).join("&")}},405:function(e,t,o){"use strict";var n=a(o(85)),r=(a(o(161)),a(o(160)));function a(e){return e&&e.__esModule?e:{default:e}}({init:function(){this.initMobile().then(function(){})},lazyLoad:function(){(0,r.default)(["lib/md5.js","lib/qs.min.js","lib/axios.min.js"])},initMobile:function(){return/(ios|android)/gi.test(n.default.os.family)?(0,r.default)("lib/vconsole.min.js").then(function(){console.log(n.default)}):Promise.resolve()}}).init()},407:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.sessionStorage||window.localStorage;t.default={get:function(e){return n.getItem(e)},set:function(e,t){e&&n.setItem(e,t)},remove:function(e){n.removeItem(e)},clean:function(){n.clear&&n.clear()}}},408:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlertCtrl=t.Alert=void 0;var n=a(o(163)),r=a(o(460));function a(e){return e&&e.__esModule?e:{default:e}}t.Alert=n.default,t.AlertCtrl=r.default},424:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(6));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=e.children,o=e.className,n=(e.title,e.onClick),r=e.loading,c=e.disabled;return a.default.createElement("button",{className:(0,i.default)("u-btn",o),disabled:c?"disabled":"",onClick:n},r&&a.default.createElement("i",{className:"u-loading"}),t)}}]),t}();t.default=l},425:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(6));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=e.children,o=e.className,n=(e.title,e.option,e.onClick),r=e.spacing,c=void 0!==r&&r;return a.default.createElement("div",{className:(0,i.default)("u-grid-row",o,c?"spacing":""),onClick:n},t)}}]),t}();t.default=l},426:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(6));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=e.children,o=e.className,n=e.span,r=e.onClick,c=e.spacing,l=void 0!==c&&c;return a.default.createElement("div",{className:(0,i.default)("u-grid-col",o,"flex-"+(n||12),l?"spacing":""),onClick:r},t)}}]),t}();t.default=l},427:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(6));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=(e.children,e.className),o=e.onChange,n=e.onBlur,r=e.onFocus,c=e.onKeyDown,l=e.placeholder,s=e.value,u=e.type,f=e.name,d=e.domRef,m=e.maxLength,p=e.accept,h=e.multiple;return a.default.createElement("input",{name:f,className:(0,i.default)("u-input",t),type:u,onChange:o,onBlur:n,onFocus:r,onKeyDown:c,placeholder:l,value:s,ref:d,maxLength:m,accept:p,multiple:h})}}]),t}();t.default=l},428:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(6));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=(e.children,e.className),o=e.onChange,n=e.onBlur,r=e.onKeyDown,c=e.placeholder,l=e.value;return a.default.createElement("textarea",{className:(0,i.default)("u-textarea",t),onChange:o,onBlur:n,onKeyDown:r,placeholder:c,value:l})}}]),t}();t.default=l},429:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=l(r),i=(l(o(6)),o(19),l(o(170))),c=o(10);function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u={message:null,visible:!1},f=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.count=0,n.state=u,s(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentWillMount",value:function(){var e=Object.assign({},this.props,{visible:!0});this.setState(e)}},{key:"componentDidMount",value:function(){console.log("tip componentDidMount",this.state),this.checkTimer()}},{key:"componentWillReceiveProps",value:function(e){if(!this.count){Object.assign({},e);this.setState(e)}}},{key:"shouldComponentUpdate",value:function(){return!this.count}},{key:"onClick",value:function(e){var t=e.onClick;this.hide(),c.Valid.isFunction(t)&&t(e)}},{key:"checkTimer",value:function(){var e=this,t=this.state.time,o=this.props.onClose;t&&(t=+t,setTimeout(function(){e.hide(),o&&o()},1e3*+t))}},{key:"hide",value:function(){var e=this;return console.log("tip hide",this.state),this.setState({visible:!1}),setTimeout(function(){return e.count=1},300),this}},{key:"render",value:function(){var e=this.state,t=(e.className,e.message,e.close),o=e.visible,n=this.state;return n.onClick=this.onClick.bind(this,{onClick:t}),o&&a.default.createElement(i.default,n)}}]),t}();t.default=f},430:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(6));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=e.children,o=e.className,n=e.title;return a.default.createElement("div",{className:(0,i.default)("u-tooltip",o)},t,n&&a.default.createElement("div",{className:"u-tooltip-title"},n))}}]),t}();t.default=l},431:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.children;var t=e.className,o=e.percent;return e.visible&&n.default.createElement("div",{className:(0,r.default)("u-progress",t)},n.default.createElement("p",{className:(0,r.default)("u-progress-state"),style:{width:o+"%"}}))};var n=a(o(1)),r=a(o(6));function a(e){return e&&e.__esModule?e:{default:e}}},432:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=c(r),i=c(o(6));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=e.children,o=e.className,n=e.onClick,r=e.disable,c=e.active;return a.default.createElement("i",{className:(0,i.default)("u-icon iconfont",o,c?"active":""),disable:r,onClick:n},t)}}]),t}();t.default=l},433:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=l(a),c=l(o(6));function l(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentWillReceiveProps",value:function(e){e.visible&&this.setState({hidden:!e.visible})}},{key:"render",value:function(){var e=this.props,t=e.visible,o=e.className,r=function(e,t){var o={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=e[n]);return o}(e,["visible","className"]);return i.default.createElement("div",n({hidden:!t,className:(0,c.default)("u-mask",o)},r))}}]),t}();t.default=s},434:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=function(e){return e&&e.__esModule?e:{default:e}}(r);function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),c=0;c<r;c++)a[c]=arguments[c];return o=n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.id=null,n.state={totalPage:0,currPage:0},n.goPrev=function(e){var t=n.state;if(!(t.currPage<=1)){var o=t.currPage-1;n.setPage(o)}},n.goNext=function(e){var t=n.state;if(!(t.currPage>=t.totalPage)){var o=t.currPage+1;n.setPage(o)}},i(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentWillMount",value:function(){this.setNewState(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.setNewState(e)}},{key:"setNewState",value:function(e){this.id!==e.id&&this.setState({totalPage:+e.totalPage,currPage:+e.currPage})}},{key:"setPage",value:function(e){console.log("setPage",e),this.setState({currPage:e}),this.props.onChange&&this.props.onChange(e)}},{key:"render",value:function(){var e=this.state,t=e.totalPage,o=e.currPage;return a.default.createElement("div",null,a.default.createElement("div",{className:"u-pagination"},a.default.createElement("a",{className:"u-icon iconfont icon-back "+(o<=1?"disable":""),onClick:this.goPrev}),a.default.createElement("span",{className:"u-pagination-text"},o," / ",t),a.default.createElement("a",{className:"u-icon iconfont icon-more "+(o>=t?"disable":""),onClick:this.goNext})))}}]),t}();t.default=c},435:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=u(r),i=u(o(6)),c=(u(o(64)),u(o(171))),l=o(9),s=u(o(20));function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}l.StoreNim.state,l.StoreNim,l.StoreChatroom.state;var d=l.StoreChatroom,m=(l.StoreNetcall.state,l.StoreNetcall,function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={emoji:n.genEmojiList("emoji",c.default.emojiList),pinup:n.genEmojiList("pinup",c.default.pinupList),currType:"emoji",currAlbum:"emoji",currEmoji:[]},f(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"getCurrEmoji",value:function(e,t){return"emoji"==e?this.state.emoji[t]:"pinup"==e?this.state.pinup[t]:[]}},{key:"selectAlbum",value:function(e){console.log("select -> ",e.type),this.setState({currType:e.type,currAlbum:e.name,currEmoji:this.getCurrEmoji(e.type,e.name)})}},{key:"selectEmoji",value:function(e){console.log("选中条目:",e),"emoji"==e.type?(console.log("添加一个表情文案到输入框： "),this.props.fn&&this.props.fn(e.key),d.setShowEmojiPanel(!1)):(console.log("发送贴图消息"),s.default.sendPinupMsg(e.name,e.key).then(function(){console.log("贴图消息发送成功..."),d.setShowEmojiPanel(!1)}).catch(function(e){console.log("贴图消息发送失败..."),d.setShowEmojiPanel(!1)}))}},{key:"genEmojiList",value:function(e,t){var o={};for(var n in t){var r=t[n],a=[];for(var i in r)a.push({type:e,name:n,key:i,img:r[i].img});a.length>0&&(o[n]={type:e,name:n,list:a,album:a[0].img})}return console.log(o),o}},{key:"componentDidMount",value:function(){console.log("emojiPanel componentDidMount ... "),this.setState({currEmoji:this.getCurrEmoji(this.state.currType,this.state.currAlbum)})}},{key:"render",value:function(){var e=this,t=this.state;return a.default.createElement("div",{className:"m-emoji"},a.default.createElement("div",{className:"emoji-tab"},Object.keys(t.emoji).map(function(o){return a.default.createElement("div",{key:"emoji-"+o,className:(0,i.default)("emoji-tab-item",t.emoji[o].name==t.currAlbum?"active":""),onClick:e.selectAlbum.bind(e,t.emoji[o])},a.default.createElement("img",{src:t.emoji[o].album}))}),Object.keys(t.pinup).map(function(o){return a.default.createElement("div",{key:"pinup-"+o,className:(0,i.default)("emoji-tab-item",t.pinup[o].name==t.currAlbum?"active":""),onClick:e.selectAlbum.bind(e,t.pinup[o])},a.default.createElement("img",{src:t.pinup[o].album}))})),a.default.createElement("div",{className:"emoji-content"},t.currEmoji&&t.currEmoji.list&&t.currEmoji.list.map(function(o,n){return a.default.createElement("span",{key:t.currAlbum+"-"+n,className:(0,i.default)("emoji-item","pinup"==t.currType?"emoji-pinup-item":""),onClick:e.selectEmoji.bind(e,o)},a.default.createElement("img",{src:o.img+"?imageView&thumbnail="+("emoji"==t.currType?"28x28":"48x48")}))})))}}]),t}());t.default=m},436:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(17),c=(function(e){e&&e.__esModule}(o(87)),o(10));function l(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}(0,i.useStrict)(!0),console.log("Storage",Storage),console.log("Logger",c.Logger);var s=(n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}(this,"state",r,this)}return a(e,[{key:"setHasReceiveHostMsg",value:function(e){this.state.hasReceiveHostMsg=e,console.log("store --\x3e nim --\x3e setHasReceiveHostMsg",e)}},{key:"setNim",value:function(e){console.log("store --\x3e nim --\x3e setNim",e),this.state.nim=e}},{key:"setUid",value:function(e){console.log("store --\x3e nim --\x3e setUid",e),this.state.uid=e}},{key:"setAccount",value:function(e){console.log("store --\x3e nim --\x3e setAccount",e),this.state.account=e}},{key:"setToken",value:function(e){console.log("store --\x3e nim --\x3e setToken",e),this.state.token=e}}]),e}(),r=l(n.prototype,"state",[i.observable],{enumerable:!0,initializer:function(){return{account:"",token:"",nim:null,hasReceiveHostMsg:!1}}}),l(n.prototype,"setHasReceiveHostMsg",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setHasReceiveHostMsg"),n.prototype),l(n.prototype,"setNim",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setNim"),n.prototype),l(n.prototype,"setUid",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setUid"),n.prototype),l(n.prototype,"setAccount",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setAccount"),n.prototype),l(n.prototype,"setToken",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setToken"),n.prototype),n);t.default=s},437:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(17),c=(function(e){e&&e.__esModule}(o(87)),o(10));function l(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}(0,i.useStrict)(!0);var s=(n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}(this,"state",r,this)}return a(e,[{key:"setLastTimestamp",value:function(e){this.state.lastTimestamp=e,console.log("store --\x3e chatroom --\x3e setLastTimestamp",e)}},{key:"mergeCustom",value:function(e){Object.assign(this.state.custom,e),console.log("store --\x3e chatroom --\x3e state",this.state.custom),console.log("store --\x3e chatroom --\x3e mergeCustom",e)}},{key:"setCustom",value:function(e){this.state.custom=e,console.log("store --\x3e chatroom --\x3e setCustom",e)}},{key:"setCanLoadHistory",value:function(e){this.state.canLoadHistory=e,console.log("store --\x3e chatroom --\x3e setCanLoadHistory",e)}},{key:"setShowEmojiPanel",value:function(e){this.state.showEmojiPanel=e,console.log("store --\x3e chatroom --\x3e setShowEmojiPanel",e)}},{key:"setIsShowMemberTab",value:function(e){this.state.isShowMemberTab=e,console.log("store --\x3e chatroom --\x3e setIsShowMemberTab",e)}},{key:"setHasPermissionRequest",value:function(e){this.state.hasPermissionRequest=e,console.log("store --\x3e chatroom --\x3e setHasPermissionRequest",e)}},{key:"hasPermissionRequestMember",value:function(){return-1!=this.state.members.findIndex(function(e,t){return 2==e.status})}},{key:"setCurrChatroomId",value:function(e){this.state.currChatroomId=e,console.log("store --\x3e chatroom --\x3e setCurrChatroomId",e)}},{key:"setChatroom",value:function(e,t){e&&(this.state.currChatroom=t,console.log("store --\x3e chatroom --\x3e setChatroom",t))}},{key:"setMsgs",value:function(e){e&&(c.Valid.isArray(e)?(this.state.msgs=this.state.msgs.concat(e),console.log("store --\x3e chatroom --\x3e setMsgs",e)):console.error("非消息数组",e))}},{key:"addHistoryMsgs",value:function(e){if(e)if(c.Valid.isArray(e)){var t=[];e.forEach(function(e){t.unshift(e)}),this.state.msgs=t.concat(this.state.msgs),console.log("store --\x3e chatroom --\x3e addHistoryMsgs",e)}else console.error("非消息数组",e)}},{key:"clearMsgs",value:function(){this.state.msgs=[],console.log("store --\x3e chatroom --\x3e clearMsgs")}},{key:"setMembers",value:function(e){e&&(c.Valid.isArray(e)?(this.state.members=this.state.members.concat(e),console.log("store --\x3e chatroom --\x3e setMembers",e),this.resortMemberLocation()):console.error("非成员数组",e))}},{key:"clearMembers",value:function(){this.state.members=[],console.log("store --\x3e chatroom --\x3e clearMembers",this.state.members)}},{key:"findMember",value:function(e){return this.state.members.findIndex(function(t,o){return e.account==t.account})}},{key:"addMember",value:function(e){if(e){var t=this.findMember(e);-1==t?(this.state.members.push(e),console.log("store --\x3e chatroom --\x3e addMember",e),this.resortMemberLocation()):console.log("已存在的成员：",e,", idx: ",t)}}},{key:"delMember",value:function(e){if(e){var t=this.findMember({account:e});-1!=t?(this.state.members.splice(t,1),console.log("store --\x3e chatroom --\x3e delMember",e),this.resortMemberLocation()):console.log("不存在的成员：",e," 删除失败")}}},{key:"setMemberStatus",value:function(e,t){if(e){var o=this.findMember({account:e});if(-1!=o){var n=this.state.members[o];n.status=t,this.state.members.splice(o,1,n),console.log("store --\x3e chatroom --\x3e setMemberStatus",e,t),this.resortMemberLocation()}else console.log("不存在的成员：",e," 设置成员互动状态失败")}}},{key:"setMemberAudioVolume",value:function(e,t){if(e){var o=this.findMember({account:e});if(-1!=o){var n=this.state.members[o];n.audioVolume=t,this.state.members.splice(o,1,n)}}}},{key:"setType",value:function(e){this.state.type=e,console.log("store --\x3e chatroom --\x3e setType",e)}},{key:"resortMemberLocation",value:function(){var e=null,t=[],o=[],n=[];this.state.members.forEach(function(n){"owner"==n.type?e=n:1==n.status||2==n.status?t.push(n):o.push(n)}),o.sort(function(e,t){return e.enterTime<t.enterTime?-1:e.enterTime>t.enterTime?1:0}),n=t.concat(o),null!=e&&n.unshift(e),this.state.members=n,console.log("store --\x3e chatroom --\x3e resortMemberLocation",n)}}]),e}(),r=l(n.prototype,"state",[i.observable],{enumerable:!0,initializer:function(){return{lastTimestamp:0,canLoadHistory:!0,showEmojiPanel:!1,isShowMemberTab:!1,currChatroomId:"",currChatroom:null,hasPermissionRequest:!1,msgs:[],members:[],type:"",custom:{}}}}),l(n.prototype,"setLastTimestamp",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setLastTimestamp"),n.prototype),l(n.prototype,"mergeCustom",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"mergeCustom"),n.prototype),l(n.prototype,"setCustom",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setCustom"),n.prototype),l(n.prototype,"setCanLoadHistory",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setCanLoadHistory"),n.prototype),l(n.prototype,"setShowEmojiPanel",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setShowEmojiPanel"),n.prototype),l(n.prototype,"setIsShowMemberTab",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setIsShowMemberTab"),n.prototype),l(n.prototype,"setHasPermissionRequest",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setHasPermissionRequest"),n.prototype),l(n.prototype,"setCurrChatroomId",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setCurrChatroomId"),n.prototype),l(n.prototype,"setChatroom",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setChatroom"),n.prototype),l(n.prototype,"setMsgs",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setMsgs"),n.prototype),l(n.prototype,"addHistoryMsgs",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addHistoryMsgs"),n.prototype),l(n.prototype,"clearMsgs",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"clearMsgs"),n.prototype),l(n.prototype,"setMembers",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setMembers"),n.prototype),l(n.prototype,"clearMembers",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"clearMembers"),n.prototype),l(n.prototype,"addMember",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addMember"),n.prototype),l(n.prototype,"delMember",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"delMember"),n.prototype),l(n.prototype,"setMemberStatus",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setMemberStatus"),n.prototype),l(n.prototype,"setMemberAudioVolume",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setMemberAudioVolume"),n.prototype),l(n.prototype,"setType",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setType"),n.prototype),n);t.default=s},438:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(17);function c(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}(0,i.useStrict)(!0);var l=(n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}(this,"state",r,this)}return a(e,[{key:"setShareStarted",value:function(e){this.state.shareStarted=e,console.log("store --\x3e chatroom --\x3e setShareStarted",e)}},{key:"setChromeDown",value:function(e){this.state.chromeDown=e,console.log("store --\x3e chatroom --\x3e setChromeDown",e)}},{key:"settabindex",value:function(e){this.state.tabIndex=e,console.log("store --\x3e netcall --\x3e settabIndex",e)}},{key:"setHasVideo",value:function(e){this.state.hasVideo=e,console.log("store --\x3e netcall --\x3e setHasVideo",e)}},{key:"setHasAudio",value:function(e){this.state.hasAudio=e,console.log("store --\x3e netcall --\x3e setHasAudio",e)}},{key:"setHasShareScreen",value:function(e){this.state.hasShareScreen=e,console.log("store --\x3e netcall --\x3e sethasShareScreen",e)}},{key:"setRemoteIsScreenSharing",value:function(e){this.state.remoteIsScreenSharing=e,console.log("store --\x3e netcall --\x3e setRemoteIsScreenSharing",e)}},{key:"setVideoIsFullScreen",value:function(e){this.state.videoIsFullScreen=e,console.log("store --\x3e netcall --\x3e setVideoIsFullScreen",e)}},{key:"resortMembers",value:function(){var e=[];this.state.members.forEach(function(t){""!=t.account&&e.push(t)}),this.addMemberIfNotFull(e),this.state.members=e,console.log("store --\x3e netcall --\x3e resortMembers",e)}},{key:"setFromCreate",value:function(e){this.state.fromCreate=e,console.log("store --\x3e netcall --\x3e setFromCreate",e)}},{key:"setShowStatus",value:function(e){this.state.showStatus=e,console.log("store --\x3e netcall --\x3e setShowStatus",e)}},{key:"setDoms",value:function(e){this.state.doms=e,console.log("store --\x3e netcall --\x3e setDoms",e)}},{key:"clearDoms",value:function(){this.state.doms=[],console.log("store --\x3e netcall --\x3e clearDoms")}},{key:"addDom",value:function(e){var t=e&&e.id?e.id:"";if(t){var o=this.state.doms.findIndex(function(e,o){if(e.id&&e.id==t)return o});-1==o?(this.state.doms.push(e),console.log("store --\x3e netcall --\x3e addDom",e)):console.error("已存在对应的DOM节点，不重复追加...",o)}else console.error("不存在的DOM节点或id属性：",t)}},{key:"setWebRtc",value:function(e){this.state.webrtc=e,console.log("store --\x3e netcall --\x3e setWebRtc",e)}},{key:"setHasPermission",value:function(e){this.state.hasPermission=e,console.log("store --\x3e netcall --\x3e setHasPermission",e)}},{key:"findMember",value:function(e){return this.state.members.findIndex(function(t,o){return t.account==e.account})}},{key:"clearMembers",value:function(){this.state.members=[{account:"",self:!1},{account:"",self:!1},{account:"",self:!1},{account:"",self:!1}],console.log("store --\x3e netcall --\x3e clearMembers")}},{key:"setMembers",value:function(e){e&&(this.addMemberIfNotFull(e),this.state.members=e,console.log("store --\x3e netcall --\x3e setMembers",e))}},{key:"addMemberIfNotFull",value:function(e){var t=e.length<4?4-e.length:0;if(t>0)for(var o=0,n=t;o<n;o++)e.push({account:"",self:!1})}},{key:"canAddNewMember",value:function(){var e=0;return this.state.members.forEach(function(t){t.account&&""!=t.account&&(e+=1)}),console.log("是否可继续加人互动：",e,4==e),4==e}},{key:"addMember",value:function(e,t,o){if(-1!=this.findMember(e))return console.log("已存在的音视频成员",e),void(t&&(console.log("额外设置老师状态..."),this.setTeacherStatus(e.account,o)));var n=this.state.members.findIndex(function(e){return""==e.account});-1!=n?(console.log("***** 要放置人员最近一个空位置为：",n),this.state.members.splice(n,1,e),console.log("store --\x3e netcall --\x3e addMember",e)):console.log("已有4个成员，无法再加")}},{key:"delMember",value:function(e){var t=this.findMember({account:e});-1!=t?(this.state.members.splice(t,1,{account:"",self:!1}),console.log("store --\x3e netcall --\x3e delMember",e),this.resortMembers()):console.log("不存在的音视频成员",e)}},{key:"setTeacherStatus",value:function(e,t){var o=this.findMember({account:e});if(-1!=o){var n=this.state.members[o];n.offline=t,this.state.members.splice(o,1,n),console.log("store --\x3e netcall --\x3e setTeacherStatus",e,t)}else console.log("不存在的音视频成员",e)}},{key:"setVideo",value:function(e){this.state.video=e,console.log("store --\x3e netcall --\x3e setVideo",e)}},{key:"setAudio",value:function(e){this.state.audio=e,console.log("store --\x3e netcall --\x3e setAudio",e)}}]),e}(),r=c(n.prototype,"state",[i.observable],{enumerable:!0,initializer:function(){return{remoteIsScreenSharing:!1,videoIsFullScreen:!1,doms:[],fromCreate:!1,hasPermission:!1,showStatus:0,webrtc:null,members:[{account:"",self:!1,offline:!0},{account:"",self:!1},{account:"",self:!1},{account:"",self:!1}],video:!0,audio:!0,hasVideo:!1,hasAudio:!1,setHasShareScreen:!1,tabIndex:0,shareStarted:!1,chromeDown:!1}}}),c(n.prototype,"setShareStarted",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setShareStarted"),n.prototype),c(n.prototype,"setChromeDown",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setChromeDown"),n.prototype),c(n.prototype,"settabindex",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"settabindex"),n.prototype),c(n.prototype,"setHasVideo",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setHasVideo"),n.prototype),c(n.prototype,"setHasAudio",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setHasAudio"),n.prototype),c(n.prototype,"setHasShareScreen",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setHasShareScreen"),n.prototype),c(n.prototype,"setRemoteIsScreenSharing",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setRemoteIsScreenSharing"),n.prototype),c(n.prototype,"setVideoIsFullScreen",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setVideoIsFullScreen"),n.prototype),c(n.prototype,"resortMembers",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"resortMembers"),n.prototype),c(n.prototype,"setFromCreate",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFromCreate"),n.prototype),c(n.prototype,"setShowStatus",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setShowStatus"),n.prototype),c(n.prototype,"setDoms",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setDoms"),n.prototype),c(n.prototype,"clearDoms",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"clearDoms"),n.prototype),c(n.prototype,"addDom",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addDom"),n.prototype),c(n.prototype,"setWebRtc",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setWebRtc"),n.prototype),c(n.prototype,"setHasPermission",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setHasPermission"),n.prototype),c(n.prototype,"clearMembers",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"clearMembers"),n.prototype),c(n.prototype,"setMembers",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setMembers"),n.prototype),c(n.prototype,"addMember",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addMember"),n.prototype),c(n.prototype,"delMember",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"delMember"),n.prototype),c(n.prototype,"setTeacherStatus",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setTeacherStatus"),n.prototype),c(n.prototype,"setVideo",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setVideo"),n.prototype),c(n.prototype,"setAudio",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setAudio"),n.prototype),n);t.default=l},439:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(17),c=function(e){return e&&e.__esModule?e:{default:e}}(o(87));function l(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}(0,i.useStrict)(!0);var s=(n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}(this,"state",r,this)}return a(e,[{key:"reset",value:function(){console.log("store --\x3e wb --\x3e reset"),this.state.fileList=[],this.state.currentFile=null,this.state.fileListCount=0,this.state.currentDrawMode="free",this.state.currentDrawColor="#000",this.state.fileKitEnable=!1}},{key:"setContainer",value:function(e){console.log("store --\x3e wb --\x3e setContainer",e),this.state.node=e}},{key:"setStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("store --\x3e wb --\x3e setStatus",e),this.state=Object.assign(this.state,e)}},{key:"setColor",value:function(e){console.log("store --\x3e wb --\x3e setColor",e),this.state.currentDrawColor=e}},{key:"setStyle",value:function(e){console.log("store --\x3e wb --\x3e setStyle",e),this.state.style=e}},{key:"setFileKitEnable",value:function(e){console.log("store --\x3e wb --\x3e setFileKitEnable",e),this.state.fileKitEnable=!!e}},{key:"setFileInput",value:function(e){console.log("store --\x3e wb --\x3e setFileInput",e),this.state.fileInput=e}},{key:"setCurrentFile",value:function(e){if(console.log("store --\x3e wb --\x3e setCurrentFile docId",e),e){var t=this.state.fileList.find(function(t){return t.docId===e});this.state.currentFile=t,t&&(t.currentPage=1)}}},{key:"setCurrentFilePage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.state.currentFile&&(this.state.currentFile.currentPage=e,console.log("store --\x3e wb --\x3e setCurrentFilePage index",e,this.state.currentFile))}},{key:"deleteFile",value:function(e){if(console.log("store --\x3e wb --\x3e deleteFile docId",e),e){var t=this.state.fileList.findIndex(function(t){return t.docId===e});-1!==t&&this.state.fileList.splice(t,1)}}},{key:"addFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(console.log("store --\x3e wb --\x3e addFile docId",e),e.docId)&&(-1===this.state.fileList.findIndex(function(t){return t.docId===e.docId})&&this.state.fileList.unshift(e))}},{key:"setFileState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.docId;if(t){var o=this.state,n=o.fileList.find(function(e){return e.docId===t});n&&(n=Object.assign(n,e),console.log("store --\x3e wb --\x3e setFileState",e),n.mime&&!n.type&&(n.type=o.unserializefileTypeMap[n.mime]),n.state-2==0?this.startFileProgress(n.docId):/(2|11)/.test(n.state)||(n.percent=0,n.timer&&clearInterval(n.timer),n.timer=null))}else console.error("设置文件状态失败，参数缺失docId")}},{key:"startFileProgress",value:function(e){var t=this;if(console.log("store --\x3e wb --\x3e startFileProgress",e),e){var o=this.state.fileList.find(function(t){return t.docId===e});o&&!o.timer&&(o.timeStart=Date.now(),o.timer=setInterval(function(){if(!t.state.fileList.find(function(t){return t.docId===e})||/[345]/.test(o.state)||o.percent>99){var n=o.percent>99?99.99:0;return t.setFileProgress(e,n),clearInterval(o.timer),void(o.timer=null)}var r=Math.floor((Date.now()-o.timeStart)/1e3);r=100*(1-Math.pow(.97716,r)),t.setFileProgress(e,r.toFixed(2))},1e3))}}},{key:"setFileProgress",value:function(e,t){var o=this.state.fileList.find(function(t){return t.docId===e});o&&(o.percent=t,console.log("setFileProgress",e,o.name,o.percent))}},{key:"setFileList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.list,n=void 0===o?[]:o,r=t.count,a=void 0===r?0:r;this.state.fileList=n,a&&(this.state.fileListCount=a),n.map(function(t){t.state-2==0&&e.setFileProgress(t.docId,99.99)}),console.log("store --\x3e wb --\x3e setFileList",this.state.fileList)}},{key:"setDrawMode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"free";console.log("store --\x3e wb --\x3e setDrawMode",e),/(flag|free)/.test(e)&&(this.state.currentDrawMode=e)}},{key:"setDrawColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#000";console.log("store --\x3e wb --\x3e setDrawColor",e),this.state.currentDrawColor=e}},{key:"setFileTip",value:function(e){console.log("store --\x3e wb --\x3e setFileTip",e),this.state.showFileTip=!!e}}]),e}(),r=l(n.prototype,"state",[i.observable],{enumerable:!0,initializer:function(){return Object.assign({},c.default.wbInfo,{serializeFileStateMap:c.default.serializeFileStateMap,unserializeFileStateMap:c.default.unserializeFileStateMap,unserializeFileStateText:c.default.unserializeFileStateText,fileTypeMap:c.default.fileTypeMap,fileInput:null,fileKitEnable:!1,serializefileTypeMap:c.default.serializefileTypeMap,unserializefileTypeMap:c.default.unserializefileTypeMap,currentFile:null,fileList:[],fileListCount:0,colorList:["#000","#35CBFF","#FFDD3F","#FF553C","#61D25C","#B65CFF"],currentDrawMode:"free",currentDrawColor:"#000",showFileTip:!0})}}),l(n.prototype,"reset",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"reset"),n.prototype),l(n.prototype,"setContainer",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setContainer"),n.prototype),l(n.prototype,"setStatus",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setStatus"),n.prototype),l(n.prototype,"setColor",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setColor"),n.prototype),l(n.prototype,"setStyle",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setStyle"),n.prototype),l(n.prototype,"setFileKitEnable",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFileKitEnable"),n.prototype),l(n.prototype,"setFileInput",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFileInput"),n.prototype),l(n.prototype,"setCurrentFile",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setCurrentFile"),n.prototype),l(n.prototype,"setCurrentFilePage",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setCurrentFilePage"),n.prototype),l(n.prototype,"deleteFile",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"deleteFile"),n.prototype),l(n.prototype,"addFile",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addFile"),n.prototype),l(n.prototype,"setFileState",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFileState"),n.prototype),l(n.prototype,"startFileProgress",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"startFileProgress"),n.prototype),l(n.prototype,"setFileProgress",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFileProgress"),n.prototype),l(n.prototype,"setFileList",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFileList"),n.prototype),l(n.prototype,"setDrawMode",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setDrawMode"),n.prototype),l(n.prototype,"setDrawColor",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setDrawColor"),n.prototype),l(n.prototype,"setFileTip",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"setFileTip"),n.prototype),n);t.default=s},440:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(17);(function(e){e&&e.__esModule})(o(87)),o(10);function c(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}(0,i.useStrict)(!0);var l=(n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}(this,"state",r,this)}return a(e,[{key:"clearRemoteTrackNotifications",value:function(){this.state.remoteTrackNotifications={},console.log("store --\x3e eventpool --\x3e clearRemoteTrackNotifications")}},{key:"addRemoteTrackNotification",value:function(e){this.state.remoteTrackNotifications[e]?console.log("已通知的远程轨道：",e):(this.state.remoteTrackNotifications[e]=1,console.log("store --\x3e eventpool --\x3e addRemoteTrackNotification",e))}}]),e}(),r=c(n.prototype,"state",[i.observable],{enumerable:!0,initializer:function(){return{remoteTrackNotifications:{}}}}),c(n.prototype,"clearRemoteTrackNotifications",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"clearRemoteTrackNotifications"),n.prototype),c(n.prototype,"addRemoteTrackNotification",[i.action],Object.getOwnPropertyDescriptor(n.prototype,"addRemoteTrackNotification"),n.prototype),n);t.default=l},441:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmDeviceContent=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(o(442));t.ConfirmDeviceContent=n.default},442:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=u(a),c=u(o(6)),l=o(16),s=o(9);function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}s.StoreNim.state,s.StoreNim,s.StoreChatroom.state,s.StoreChatroom;var d=s.StoreNetcall.state,m=s.StoreNetcall,p=(0,l.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.onToggleAudio=function(e){m.setAudio(!d.audio),console.log("切换音频:",d.audio)},n.onToggleVideo=function(e){m.setVideo(!d.video),console.log("切换视频:",d.video)},f(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){return i.default.createElement("div",{className:"u-confirm-device"},i.default.createElement("div",{className:"msg"},i.default.createElement("div",null,"创建者已通过你的发言方式，"),i.default.createElement("div",null,"请选择发言方式:")),i.default.createElement("div",{className:"fnlist"},i.default.createElement("div",{className:"fn-part"},i.default.createElement("input",{type:"checkbox",name:"fn",id:"audio",className:"select-checkbox"}),i.default.createElement("label",{className:(0,c.default)("select-item",d.audio?"selected":""),htmlFor:"audio",onClick:this.onToggleAudio},"语音")),i.default.createElement("div",{className:"fn-part"},i.default.createElement("input",{type:"checkbox",name:"fn",id:"video",className:"select-checkbox"}),i.default.createElement("label",{className:(0,c.default)("select-item",d.video?"selected":""),htmlFor:"video",onClick:this.onToggleVideo},"视频")),i.default.createElement("div",{className:"fn-part fn-part-1"},i.default.createElement("input",{type:"checkbox",name:"fn",id:"whiteboard",className:"select-checkbox"}),i.default.createElement("label",{className:"select-item disabled",htmlFor:"whiteboard"},"默认互动白板"))))}}]),t}())||n;t.default=p},443:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(16),l=d(o(6)),s=d(o(444)),u=d(o(447)),f=o(9);function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}f.StoreNim.state,f.StoreNim;var p=f.StoreChatroom.state,h=f.StoreChatroom,g=(f.StoreNetcall.state,f.StoreNetcall,(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.showChatPanel=function(e){h.setIsShowMemberTab(!1)},n.showMemberPanel=function(e){h.setIsShowMemberTab(!0),h.setHasPermissionRequest(!1)},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this.props;e.children,e.className;return i.default.createElement("div",{className:"m-chatroom"},i.default.createElement("div",{className:"u-tab"},i.default.createElement("div",{className:"u-tab-header"},i.default.createElement("div",{className:(0,l.default)("u-tab-item u-tab-item-small",p.isShowMemberTab?"":"active"),onClick:this.showChatPanel},"讨论"),i.default.createElement("div",{className:(0,l.default)("u-tab-item u-tab-item-small",p.isShowMemberTab?"active":""),onClick:this.showMemberPanel},"成员",!p.isShowMemberTab&&p.hasPermissionRequest&&i.default.createElement("i",{className:"pointer"}," "))),i.default.createElement("div",{className:"u-tab-body"},p.isShowMemberTab?i.default.createElement(u.default,null):i.default.createElement(s.default,null))))}}]),t}())||n);t.default=g},444:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=u(a),c=o(16),l=(u(o(6)),o(19),u(o(445))),s=u(o(446));function u(e){return e&&e.__esModule?e:{default:e}}var f=(0,c.observer)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){return i.default.createElement("div",{className:"m-chatroom-chatarea"},i.default.createElement(l.default,null),i.default.createElement(s.default,null))}}]),t}())||n;t.default=f},445:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(16),l=d(o(164)),s=(d(o(6)),o(19)),u=o(9),f=(d(o(21)),d(o(20)));d(o(23)),d(o(36));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}u.StoreNim.state,u.StoreNim;var p=u.StoreChatroom.state,h=u.StoreChatroom,g=(u.StoreNetcall.state,u.StoreNetcall,(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={historyLoading:!1},n.loadHistoryMsg=function(e){console.log("点击加载历史消息按钮..."),n.state.historyLoading?console.log("正在加载中，忽略重复点击 ..."):(n.setState({historyLoading:!0}),f.default.getHistoryMsgs(p.lastTimestamp).then(function(e){console.log("获取聊天室历史消息成功"),h.setCanLoadHistory(!1),e=e.map(function(e){return f.default.formatChatroomMsg(e,!0)}),h.addHistoryMsgs(e)}).catch(function(e){console.error("获取聊天室历史消息失败: ",e),n.setState({historyLoading:!1})}))},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){console.log("chat.list componentDidMount: "),h.setLastTimestamp(Date.now())}},{key:"render",value:function(){return i.default.createElement("div",{id:"chat-msg-list",className:"m-chatroom-list"},p.canLoadHistory&&i.default.createElement("div",{className:"history-toolbar"},i.default.createElement(s.Button,{className:"u-btn-none f-w-140",onClick:this.loadHistoryMsg,loading:this.state.historyLoading},"加载历史消息")),p.msgs.map(function(e,t){return e&&"notification"==e.type?i.default.createElement("div",{key:t,className:"msg msg-notification"},e.content):e&&"text"==e.type?i.default.createElement("div",{key:t,className:"msg"},e.avatar?i.default.createElement("div",{className:"avatar",style:{backgroundImage:"url("+e.avatar+")"}}):i.default.createElement("div",{className:"avatar"}),i.default.createElement("div",{className:"content"},i.default.createElement("div",{className:"nick"},e.nick),i.default.createElement("div",{className:"value"},(0,l.default)(e.content)))):e&&"caiquan"==e.type?i.default.createElement("div",{key:t,className:"msg"},e.avatar?i.default.createElement("div",{className:"avatar",style:{backgroundImage:"url("+e.avatar+")"}}):i.default.createElement("div",{className:"avatar"}),i.default.createElement("div",{className:"content"},i.default.createElement("div",{className:"nick"},e.nick),i.default.createElement("div",{className:"value"},i.default.createElement("img",{src:e.content,style:{width:50,height:50}})))):e&&"emoji"==e.type?i.default.createElement("div",{key:t,className:"msg"},e.avatar?i.default.createElement("div",{className:"avatar",style:{backgroundImage:"url("+e.avatar+")"}}):i.default.createElement("div",{className:"avatar"}),i.default.createElement("div",{className:"content"},i.default.createElement("div",{className:"nick"},e.nick),i.default.createElement("div",{className:"value"},i.default.createElement("img",{src:e.content,style:{width:"emoji"==e.catalog?28:48,height:"emoji"==e.catalog?28:48}})))):""}))}}]),t}())||n);t.default=g},446:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(16),l=(d(o(6)),o(19)),s=o(10),u=o(9),f=d(o(20));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}u.StoreNim.state,u.StoreNim;var p=u.StoreChatroom.state,h=u.StoreChatroom,g=(u.StoreNetcall.state,u.StoreNetcall,(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={msg:"",sendLoading:!1,canSendMsg:!1,showEmojiPanel:!1},n.changeMsg=function(e){var t=e.target.value;s.Valid.isBlank(t)?n.setState({msg:"",canSendMsg:!1}):n.setState({msg:e.target.value,canSendMsg:!0})},n.sendMsg=function(e){console.log("sendMsg ...");var t=s.Valid.removeSpace(n.state);s.Valid.param(t,"msg")?f.default.sendChatroomMsg(n.state.msg).then(function(){console.log("发送消息成功"),n.setState({msg:""})}).catch(function(e){console.error("发送消息失败",e),(0,s.Toast)({msg:"发送消息失败"})}):(0,s.Toast)({msg:"请输入聊天内容"})},n.sendCqMsg=function(e){console.log("发送猜拳消息"),f.default.sendCqMsg().then(function(){console.log("猜拳发送成功...")}).catch(function(e){console.error("猜拳发送失败...",e)})},n.toggleBqPanel=function(e){console.log("表情面板显示/隐藏..."),h.setShowEmojiPanel(!p.showEmojiPanel)},n.doAppendEmoji=function(e){console.log("追加表情文案：",e),n.setState(function(t,o){return{msg:t.msg+" "+e,canSendMsg:!0}})},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){return i.default.createElement("div",{className:"m-chatroom-input"},i.default.createElement(l.TextArea,{className:"msg-input",onChange:this.changeMsg,placeholder:"和大家一起愉快聊天",value:this.state.msg}),i.default.createElement("div",{className:"input-toolbar"},i.default.createElement("div",{className:"part part-1"},i.default.createElement(l.Button,{className:"u-btn u-btn-smaller",onClick:this.sendMsg,disabled:!this.state.canSendMsg,loading:this.state.sendLoading},"发送")),i.default.createElement("div",{className:"part part-2"},i.default.createElement("span",{className:"cq",onClick:this.sendCqMsg})),i.default.createElement("div",{className:"part part-3"},i.default.createElement("span",{className:"emojis",onClick:this.toggleBqPanel}))),p.showEmojiPanel&&i.default.createElement(l.EmojiPanel,{fn:this.doAppendEmoji}))}}]),t}())||n);t.default=g},447:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=h(a),c=o(16),l=h(o(6)),s=o(9),u=o(10),f=h(o(21)),d=h(o(20)),m=h(o(23)),p=h(o(89));function h(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=s.StoreChatroom.state,b=s.StoreChatroom,y=(s.StoreNim.state,s.StoreNim,s.StoreNetcall.state),w=s.StoreNetcall,S=(s.StoreEventPool,s.StoreEventPool.state,(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=g(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.doEndInteraction=function(e){console.log("【结束互动确认弹窗】 --\x3e 确定.."),u.Alert.close(),b.setMemberStatus(e,0),m.default.stopRemoteStream(e),m.default.stopPlayRemoteAudio(e),f.default.sendCustomSysMsg(e,{room_id:v.currChatroomId,command:12}).then(function(){console.log("主持人通知成员关闭连麦结果成功"),w.delMember(e),m.default.reDrawVideos();var t=[];y.members.forEach(function(e){e.account&&""!=e.account&&t.push(e.account)}),console.log("待通知有权限列表为：",t),d.default.sendCustomMsg({room_id:v.currChatroomId,command:1,uids:t}).then(function(){console.log("[停止互动后]主持人通知成员有权限的成员列表成功")}).catch(function(e){console.error("[停止互动后]主持人通知成员有权限的成员列表失败",e)})}).catch(function(e){console.error("主持人通知成员关闭连麦结果失败",e)})},n.endInteraction=function(e){console.log("结束互动【老师端】",e),u.Alert.open({title:"提示",msg:'<div class="u-end-interaction"><i class="u-icon-tip"></i>确定取消该用户的互动权限？</div>',isHtml:!0,btns:[{label:"确定",clsName:"u-btn-smaller f-mgr-10",onClick:function(){n.doEndInteraction(e)}},{label:"取消",clsName:"u-btn-cancle",onClick:function(){n.doCancle()}}]})},n.doCancle=function(){console.log("【结束互动确认弹窗】 --\x3e 取消.."),u.Alert.close()},n.allowInteraction=function(e){if(w.canAddNewMember())return(0,u.Toast)({msg:"互动人数已满"}),void console.error("不可再加人互动...");console.log("允许互动【老师端】",e),b.setMemberStatus(e,1),w.addMember({account:e,self:!1}),p.default.handleRtcPermissionAndDraw(e),m.default.startPlayRemoteAudio(),f.default.sendCustomSysMsg(e,{room_id:v.currChatroomId,command:11}).then(function(){console.log("主持人通知成员同意连麦结果成功");var e=[];y.members.forEach(function(t){t.account&&""!=t.account&&e.push(t.account)}),console.log("待通知有权限成员列表为：",e,y.doms.length,y.members.length),d.default.sendCustomMsg({room_id:v.currChatroomId,command:1,uids:e}).then(function(){console.log("[同意互动后]主持人通知成员有权限的成员列表成功")}).catch(function(e){console.error("[同意互动后]主持人通知成员有权限的成员列表失败",e)})}).catch(function(e){console.error("主持人通知成员同意连麦结果失败",e)})},n.getVolume=function(e){return e>0&&e<=.125?"volume-1":e>.125&&e<=.25?"volume-2":e>.25&&e<=.375?"volume-3":e>.375&&e<=.5?"volume-4":e>.5&&e<=.625?"volume-5":e>.625&&e<=.75?"volume-6":e>.75&&e<=.875?"volume-7":e>.875&&e<=1?"volume-8":""},g(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this,t=u.Storage.get("isTeacher");return i.default.createElement("div",{className:"m-chatroom-list m-chatroom-list-1"},v.members.map(function(o,n){return"owner"==o.type?i.default.createElement("div",{key:n,className:"u-member"},i.default.createElement("div",{className:"owner"}),i.default.createElement("div",{className:(0,l.default)("volume",e.getVolume(o.audioVolume))}),o.avatar?i.default.createElement("div",{className:"avatar",style:{backgroundImage:"url("+o.avatar+")"}}):i.default.createElement("div",{className:"avatar"}),i.default.createElement("div",{className:"nickname"},o.nick)):i.default.createElement("div",{key:n,className:"u-member"},i.default.createElement("div",{className:(0,l.default)("volume",e.getVolume(o.audioVolume))}),o.avatar?i.default.createElement("div",{className:"avatar",style:{backgroundImage:"url("+o.avatar+")"}}):i.default.createElement("div",{className:"avatar"}),i.default.createElement("div",{className:"nickname"},o.nick),i.default.createElement("div",{className:"opt"},1==t&&1==o.status&&i.default.createElement("div",{className:"button button-end",onClick:e.endInteraction.bind(e,o.account)},"结束互动"),1==t&&2==o.status&&i.default.createElement("div",{className:"button",onClick:e.allowInteraction.bind(e,o.account)},"允许互动"),0==t&&1==o.status&&i.default.createElement("div",{className:"interaction-msg"},"互动中...")))}))}}]),t}())||n);t.default=S},448:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=f(a),c=o(16),l=f(o(6)),s=f(o(120)),u=o(9);o(10),f(o(21)),f(o(20)),f(o(23));function f(e){return e&&e.__esModule?e:{default:e}}u.StoreNim.state,u.StoreNim,u.StoreChatroom.state,u.StoreChatroom,u.StoreNetcall.state,u.StoreNetcall;var d=[1,2,3,4],m=(0,c.observer)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this.props,t=(e.children,e.className);return i.default.createElement("div",{className:(0,l.default)("m-netcall",t)},d.map(function(e,t){return i.default.createElement(s.default,{key:t,className:"video-"+(t+1)})}))}}]),t}())||n;t.default=m},449:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(1),c=v(i),l=v(o(6)),s=o(16),u=v(o(450)),f=v(o(456)),d=v(o(457)),m=o(10),p=o(9),h=v(o(23)),g=v(o(21));function v(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=p.StoreNim.state,w=(p.StoreNim,p.StoreChatroom.state),S=p.StoreChatroom,E=p.StoreNetcall.state,C=p.StoreNetcall,O=(0,s.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=Array(a),c=0;c<a;c++)i[c]=arguments[c];return o=n=b(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.state={tabIndex:0},n.showWhiteboardPanel=function(e){if(E.webrtc&&E.webrtc.startDevice&&(1==m.Storage.get("isTeacher")&&(C.settabindex(0),C.setShareStarted(!1),n.startCamera(),w.custom))){var t=r({},w.custom);Object.assign(t,{fullScreenType:0,showType:1,shareID:""}),g.default.updateChatroom(t)}},n.showScreenSharePanel=function(e){E.webrtc&&E.webrtc.startDevice&&(C.settabindex(1),n.shareScreen())},n.shareScreen=function(){if(window.navigator.userAgent.indexOf("Chrome")&&window.chrome){var e=m.Storage.get("account"),t=1==m.Storage.get("isTeacher"),o=w.custom.shareID;console.log(t,o,e),(""===o||t&&o==e)&&(C.setHasShareScreen(!0),C.setVideoIsFullScreen(!0),C.setChromeDown(!1),h.default.startChromeShareScreen().then(function(){console.log("===屏幕共享启动成功"),C.setHasShareScreen(!1),w.custom&&(S.mergeCustom({fullScreenType:1,showType:0,shareID:y.account}),console.log("当前Custom",w.custom),S.setCustom(w.custom),g.default.updateChatroom(w.custom));var e=E.members.findIndex(function(e){return e.account==y.account});if(-1!=e){var t=E.doms[e];t?(console.log("module:whiteboard:当前人员加入节点：",t),h.default.startLocalStream(t),h.default.setVideoViewSize(),C.setShareStarted(!0),setTimeout(function(){console.log("”“”“”“@@@@")},1e3)):console.error("@@@@ 不存在的节点，忽略渲染本地流")}else console.error("不存在的成员, 无法渲染",y.account)}).catch(function(e){console.error("屏幕共享启动失败",e),C.setHasShareScreen(!1),e&&62008===e.code?(C.setChromeDown(!0),C.setShareStarted(!1)):n.showWhiteboardPanel()}),h.default.changeRoleToPlayer())}},b(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),a(t,[{key:"startCamera",value:function(){E.hasVideo&&E.video?h.default.startCamera().then(function(){var e=E.members.findIndex(function(e){return e.account==y.account});if(-1!=e){var t=E.doms[e];t?(console.log("其他【摄像头】设备自动开启成功："),h.default.startLocalStream(t),h.default.setVideoViewSize()):console.error("@@@@ 不存在的节点，忽略渲染本地流")}else console.error("不存在的成员, 无法渲染",y.account)}).catch(function(e){console.error("其他【摄像头】设备自动开启失败：",e),"NotAllowedError"==e&&C.setHasVideo(!1)}):setTimeout(function(){h.default.stopCamera().then(function(){console.log("==本地摄像头关闭成功");var e=E.members.findIndex(function(e){return e.account==y.account});if(-1!=e){var t=E.doms[e];t?h.default.stopLocalStream(t):console.error("@@@@ 不存在的节点，忽略渲染本地流")}else console.error("不存在的成员, 无法渲染",y.account)}).catch(function(e){console.error("==本地摄像头关闭失败",e)})},100)}},{key:"render",value:function(){var e=m.Storage.get("isTeacher");e=1==e;var t=this.props,o=(t.children,t.className,this.state,E.videoIsFullScreen,w.custom),n=""!==o.shareID&&0==o.showType,r=(E.members.find(function(e){return e.account==m.Storage.get("account")}),void 0);0==o.showType&&""===o.shareID&&(r="视频"),0==o.showType&&""!==o.shareID&&(r="屏幕共享");var a=0==E.tabIndex&&1==o.showType;return c.default.createElement("div",{className:"m-whiteboard"},c.default.createElement("div",{className:"u-tab"},c.default.createElement("div",{className:"u-tab-header u-tab-header-big"},c.default.createElement("div",{className:(0,l.default)("u-tab-item u-tab-item-big",a?"active":""),onClick:this.showWhiteboardPanel},"白板"),n&&c.default.createElement("div",{className:(0,l.default)("u-tab-item u-tab-item-big","active")},r," "),e&&!n&&c.default.createElement("div",{className:(0,l.default)("u-tab-item u-tab-item-big",1==E.tabIndex?"active":""),onClick:this.showScreenSharePanel},"屏幕共享")),c.default.createElement("div",{className:"u-tab-body"},c.default.createElement(u.default,{visible:0==E.tabIndex&&!n}),e?c.default.createElement(f.default,{shareScreen:this.shareScreen,visible:1==E.tabIndex||n}):c.default.createElement(d.default,{className:"m-whiteboard-video m-whiteboard-container-cover",visible:E.videoIsFullScreen}))))}}]),t}())||n;t.default=O},450:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=f(a),c=(f(o(6)),o(16)),l=o(451),s=f(o(36)),u=o(9);function f(e){return e&&e.__esModule?e:{default:e}}u.StoreChatroom.state,u.StoreChatroom,u.StoreNim.state,u.StoreNim;var d=u.StoreNetcall.state,m=(0,c.observer)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){console.log("whiteboard::componentDidMount"),s.default.setContainer(this.node)}},{key:"render",value:function(){var e=this,t=this.props.visible;return i.default.createElement("div",{className:"m-whiteboard-container "+(t?"":"soft-hide")},i.default.createElement("div",{className:"m-whiteboard-canvas",ref:function(t){return e.node=t}}),i.default.createElement(l.WbKit,null),i.default.createElement(l.FileKit,{visible:d.hasPermission}))}}]),t}())||n;t.default=m},451:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(452);Object.defineProperty(t,"WbKit",{enumerable:!0,get:function(){return i(n).default}});var r=o(454);Object.defineProperty(t,"DrawKit",{enumerable:!0,get:function(){return i(r).default}});var a=o(455);function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"FileKit",{enumerable:!0,get:function(){return i(a).default}})},452:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(16),l=(d(o(6)),o(19)),s=d(o(453)),u=d(o(36)),f=o(9);function d(e){return e&&e.__esModule?e:{default:e}}var m=f.StoreNetcall.state,p=f.StoreChatroom.state,h=f.StoreWhiteBoard.state,g=(0,c.observer)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"setDrawModeFlag",value:function(){u.default.setDrawModeFlag()}},{key:"setDrawModeFree",value:function(){u.default.setDrawModeFree()}},{key:"undo",value:function(){u.default.undo()}},{key:"clear",value:function(){u.default.clear()}},{key:"openFileKit",value:function(){f.StoreWhiteBoard.setFileKitEnable(!0)}},{key:"resetFileKit",value:function(){f.StoreWhiteBoard.setFileKitEnable(!1),u.default.clearFile(),u.default.setDrawModeFree()}},{key:"onPageChange",value:function(e){console.log("onPageChange",e),u.default.clear(),u.default.setImage(e)}},{key:"render",value:function(){return m.hasPermission&&i.default.createElement(l.Row,{className:"m-kit m-kit-wb"},i.default.createElement("div",{className:"m-kit-wb-option"},"owner"===p.type&&i.default.createElement(l.Tooltip,{title:"激光笔"},i.default.createElement("i",{className:"u-icon iconfont icon-dot "+("flag"===h.currentDrawMode?"active":""),onClick:this.setDrawModeFlag})),i.default.createElement(l.Tooltip,null,"free"===h.currentDrawMode&&i.default.createElement(s.default,null),i.default.createElement("i",{className:"u-icon iconfont icon-pen "+("free"===h.currentDrawMode?"active":""),onClick:this.setDrawModeFree})),i.default.createElement(l.Tooltip,{title:"撤销"},i.default.createElement("i",{className:"u-icon iconfont icon-undo",onClick:this.undo})),"owner"===p.type&&i.default.createElement(l.Tooltip,{title:"清屏"},i.default.createElement("i",{className:"u-icon iconfont icon-clear",onClick:this.clear}))),"owner"===p.type&&h.currentFile&&i.default.createElement("div",{className:"m-kit-wb-pagination"},i.default.createElement(l.Tooltip,{title:"分页"},i.default.createElement(l.Pagination,{id:h.currentFile.docId,totalPage:h.currentFile.pageCount,currPage:h.currentFile.currentPage,onChange:this.onPageChange}))),"owner"===p.type&&i.default.createElement("div",{className:"m-kit-wb-file"},i.default.createElement(l.Tooltip,{title:"打开文档库",className:"m-kit-wb-file-item"},i.default.createElement("i",{className:"u-icon iconfont u-file-icon",onClick:this.openFileKit},"文档库")),h.currentFile&&i.default.createElement(l.Tooltip,{title:"停止使用文档",className:"m-kit-wb-file-item"},i.default.createElement("i",{className:"u-icon iconfont u-file-icon",onClick:this.resetFileKit},"关闭文档"))))}}]),t}())||n;t.default=g},453:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=f(a),c=o(16),l=(f(o(6)),o(19)),s=f(o(36)),u=o(9);function f(e){return e&&e.__esModule?e:{default:e}}u.StoreNetcall.state,u.StoreChatroom.state;var d=u.StoreWhiteBoard.state,m=(0,c.observer)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"setColor",value:function(e){s.default.setColor(e)}},{key:"render",value:function(){var e=this;return i.default.createElement("div",{className:"m-kit m-kit-color"},i.default.createElement(l.Col,{span:6},d.colorList.map(function(t,o){return i.default.createElement("i",{key:o,className:"u-icon u-icon-color "+(d.currentDrawColor===t?"active":""),style:{backgroundColor:t},onClick:function(){return e.setColor(t)}})})))}}]),t}())||n;t.default=m},454:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=u(a),c=(u(o(6)),o(16)),l=o(19),s=o(9);function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=s.StoreWhiteBoard,m=s.StoreWhiteBoard.state,p=(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.styleClick=function(e){d.setStyle(e)},f(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this;return i.default.createElement(l.Row,{className:"m-kit m-kit-draw flex-v"},i.default.createElement(l.Col,{span:6},i.default.createElement("i",{className:"u-icon u-icon-color"}),i.default.createElement("i",{className:"u-icon u-icon-color"}),i.default.createElement("i",{className:"u-icon u-icon-color"}),i.default.createElement("i",{className:"u-icon u-icon-color"}),i.default.createElement("i",{className:"u-icon u-icon-color"}),i.default.createElement("i",{className:"u-icon u-icon-color"})),i.default.createElement(l.Col,{span:4},m.styleList.map(function(t,o){return i.default.createElement(l.Icon,{key:o,className:"u-icon u-icon-"+t,active:t===m.style,onClick:function(){return e.styleClick(t)}})})),i.default.createElement(l.Col,{span:1},i.default.createElement("i",{className:"u-icon u-icon-fill iconfont icon-shuru-tianchong"})))}}]),t}())||n;t.default=p},455:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=f(a),c=o(16),l=(f(o(6)),o(19)),s=f(o(36)),u=o(9);function f(e){return e&&e.__esModule?e:{default:e}}var d=u.StoreWhiteBoard.state,m=(0,c.observer)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentWillReceiveProps",value:function(e){console.log("componentWillReceiveProps",e)}},{key:"open",value:function(){}},{key:"close",value:function(){u.StoreWhiteBoard.setFileKitEnable(!1)}},{key:"fileChange",value:function(){s.default.uploadFile()}},{key:"useFile",value:function(e){u.StoreWhiteBoard.setCurrentFile(e.docId),u.StoreWhiteBoard.setFileKitEnable(!1),s.default.setImage(1,e),s.default.setDrawModeFlag()}},{key:"deleteFile",value:function(e){Alert.open({title:"提示",msg:'<div class="u-stop-interaction"><i class="u-icon-tip"></i>确认要删除该文件吗？</div>',isHtml:!0,btns:[{label:"删除",clsName:"u-btn-smaller f-mgr-10",onClick:function(){s.default.deleteFile(e.docId),Alert.close()}},{label:"取消",clsName:"u-btn-cancle",onClick:function(){Alert.close()}}]})}},{key:"renderState",value:function(e){var t=this,o=null,n=d.serializeFileStateMap,r=d.unserializeFileStateText;return e.state-n.TRANSCOMPLETE==0&&(o=i.default.createElement(l.Col,{span:2,className:"m-kit-file-item-option"},i.default.createElement(l.Button,{className:"u-btn-smaller",onClick:function(){return t.useFile(e)}},"使用"),i.default.createElement(l.Button,{className:"u-btn-smaller",onClick:function(){return t.deleteFile(e)}},"删除"))),e.state-n.TRANSTIMEOUT!=0&&e.state-n.TRANSFAIL!=0&&e.state-n.UPLOADFAIL!=0||(o=i.default.createElement(l.Col,{span:2,className:"m-kit-file-item-option"},i.default.createElement("span",null,r[e.state]),i.default.createElement("span",{className:"m-kit-file-cancel",onClick:function(){return t.deleteFile(e)}},"删除"))),e.state-n.TRANSING!=0&&e.state-n.UPLOADING!=0&&e.state-n.PRETRANS!=0||(o=i.default.createElement(l.Col,{span:2,className:"m-kit-file-item-option"},i.default.createElement("span",null,r[e.state]),i.default.createElement("span",null,"(",e.percent||0,"%)"),i.default.createElement("span",{className:"m-kit-file-cancel",onClick:function(){return t.deleteFile(e)}},"取消"))),o}},{key:"render",value:function(){var e=this;return console.log("render kit.file"),d.fileKitEnable&&i.default.createElement(l.Row,{className:"m-kit m-kit-file"},i.default.createElement(l.Col,{span:2,className:"m-kit-file-header"},i.default.createElement("span",null,"文档库"),i.default.createElement("i",{className:"u-icon iconfont icon-close",onClick:this.close}),d.showFileTip&&i.default.createElement(l.Tip,{message:"关闭文档库窗口，不影响上传",time:5})),i.default.createElement(l.Col,{span:2,className:"m-kit-file-body "+(0===d.fileList.length?"empty":"")},d.fileList.map(function(t,o){return i.default.createElement("div",{key:o,className:"m-kit-file-item"},i.default.createElement(l.Row,{className:"m-kit-file-content"},i.default.createElement(l.Col,{span:1,className:"m-kit-file-item-preview "+d.serializefileTypeMap[t.type]}),i.default.createElement(l.Col,{span:3,className:"m-kit-file-item-desc"},t.name),e.renderState(t)),i.default.createElement(l.Progress,{percent:t.percent,visible:!0}))})),i.default.createElement(l.Col,{span:2,className:"m-kit-file-footer"},d.showFileTip&&i.default.createElement(l.Tip,{message:"上传文档不超过100页",time:5,onClose:function(){console.log("上传文档不超过100页 关闭"),u.StoreWhiteBoard.setFileTip(!1)}}),i.default.createElement(l.Input,{domRef:function(e){e&&u.StoreWhiteBoard.setFileInput(e)},multiple:!0,onChange:this.fileChange,type:"file",accept:".pdf,.ppt,.pptx",className:"m-kit-file-select"}),"上传文档(PDF/PPT/PPTX)"))}}]),t}())||n;t.default=m},456:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=d(o(6)),l=o(16),s=o(9),u=d(o(23)),f=o(10);function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}s.StoreNim.state,s.StoreNim;var p=s.StoreChatroom.state,h=(s.StoreChatroom,s.StoreNetcall.state),g=s.StoreNetcall,v=(0,l.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={isFullScreen:!1},n.timmer=setInterval(function(){var e=p.custom.shareID,t=h.members.findIndex(function(t){return t.account==e});if(!n.srcObject&&""!==e&&n.shareID!=e)if(-1==t)console.warn("不存在的成员, 无法渲染",e);else{var o=h.doms[t];if(o){console.log("teacher:timmer当前人员加入节点：",o);var r=o.querySelector("video"),a=document.getElementById("videoShare");a&&r&&(n.shareID=e,a.srcObject=n.srcObject=r.srcObject,a.play(),e!==h.account&&(u.default.stopRemoteStream(e),u.default.startRemoteStream(e,a)))}else console.warn("@@@@ 不存在的节点，忽略渲染本地流")}n.srcObject&&""==e&&(-1!==g.findMember({account:n.shareID})&&(n.shareID,h.account),n.srcObject=null,n.shareID=null);if(n.srcObject&&-1!==t){var i=h.doms[t];if(i){var c=i.querySelector("video"),l=document.getElementById("videoShare");l&&c&&c.srcObject!==n.srcObject&&(console.warn("src object is different"),u.default.startRemoteStream(n.shareID,l),n.srcObject=c.srcObject,l.srcObject=n.srcObject=c.srcObject,l.play())}}},300),m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.timmer)}},{key:"render",value:function(){var e=this.props.visible,t=window.navigator.userAgent.indexOf("Chrome")&&window.chrome,o="",n=p.custom.shareID===f.Storage.get("account");return o=t?h.chromeDown?i.default.createElement("div",{className:"video-share-container"},i.default.createElement("p",{className:"share-text"},"检测到您还没有安装屏幕共享插件，请先下载插件，安装完成之后",i.default.createElement("a",{href:"javascript:;",onClick:this.reload},"刷新"),"页面，体验屏幕共享功能。"),i.default.createElement("a",{className:"share-plug",href:"https://app.yunxin.163.com/webdemo/3rd/chrome/yunxin-Web-Screensharing.crx"},"下载Chrome插件"),i.default.createElement("p",{className:"share-text2"},"提示：下载完插件，请先参考",i.default.createElement("a",{href:"http://dev.netease.im/docs/product/%E9%80%9A%E7%94%A8/Demo%E6%BA%90%E7%A0%81%E5%AF%BC%E8%AF%BB/%E5%9C%A8%E7%BA%BF%E6%95%99%E8%82%B2Demo/Web%E6%BA%90%E7%A0%81%E5%AF%BC%E8%AF%BB?#Chrome%E5%B1%8F%E5%B9%95%E5%85%B1%E4%BA%AB%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85",target:"_blank"},"Chrome屏幕共享插件安装教程"),"，再安装插件")):i.default.createElement("div",{className:"video-share-container"},i.default.createElement("video",{id:"videoShare",className:(0,c.default)("video-share",this.state.isFullScreen?"fullscreen-teacher":""),width:"100%"}),i.default.createElement("div",{className:(0,c.default)(this.state.isFullScreen?"video-fullscreen-box":"video-fullscreen-box-no")},i.default.createElement("span",{className:(0,c.default)(this.state.isFullScreen?"exit-fullscreen":"video-fullscreen"),onClick:this.fullScreen.bind(this,"videoShare")})),n&&i.default.createElement("div",{className:"change-video u-btn u-btn u-btn-smaller",onClick:this.props.shareScreen},"切换")):i.default.createElement("div",{className:"share-text"},"该浏览器下暂不支持屏幕共享，请在Chrome浏览器下打开Web端教育demo，使用屏幕共享功能。若未下载Chrome浏览器，请先",i.default.createElement("a",{href:"javascript:;",onClick:this.downChrome},"下载Chrome浏览器"),"。"),i.default.createElement("div",{className:(0,c.default)("m-whiteboard-container",e?"":"hide")},o)}},{key:"reload",value:function(){window.location.reload()}},{key:"downChrome",value:function(){window.open("https://www.baidu.com/s?wd=chrome")}},{key:"fullScreen",value:function(e){this.setState({isFullScreen:!this.state.isFullScreen})}}]),t}())||n;t.default=v},457:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=d(o(6)),l=o(16),s=o(9),u=o(10),f=(d(o(21)),d(o(20)),d(o(23)));d(o(120));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}s.StoreNim.state,s.StoreNim;var p=s.StoreChatroom.state,h=(s.StoreChatroom,s.StoreNetcall.state),g=s.StoreNetcall,v=(0,l.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={isFullScreen:!1},n.timmer=setInterval(function(){var e=p.custom;if(""!==e.shareID)if(h.videoIsFullScreen)n.refs.myContainer&&0===n.refs.myContainer.childNodes.length&&n.exitFullScreen();else{var t=g.findMember({account:e.shareID});if(-1!=t){var o=h.doms[t];if(o){var r=o.parentElement.querySelector(".fullscreen-open");r&&r.click()}}}},300),n.exitFullScreen=function(e){g.setVideoIsFullScreen(!1);var t=p.custom.shareID,o=(u.Storage.get("teacherAccount"),g.findMember({account:t}));console.log("### 缩小",o,h.doms[o],t),f.default.startRemoteStream(t,h.doms[o]),f.default.setVideoViewRemoteSize(t),document.querySelectorAll("video").forEach(function(e){e.play()})},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.timmer)}},{key:"render",value:function(){var e=this.props,t=e.className,o=e.visible,n="";return h.videoIsFullScreen&&(n=i.default.createElement("div",{className:(0,c.default)(this.state.isFullScreen?"video-fullscreen-box":"video-fullscreen-box-no")},i.default.createElement("div",{className:"video-fullscreen",onClick:this.toggleFullscreen.bind(this)}))),i.default.createElement("div",{className:(0,c.default)("m-fullscreen-box",o?"":"hide")},i.default.createElement("div",{id:"m-whiteboard-fullscreen",ref:"myContainer",className:(0,c.default)("m-whiteboard-container",t,o?"":"hide",this.state.isFullScreen?"m-whiteboard-video-fullscreen":"m-whiteboard-video")}),n)}},{key:"toggleFullscreen",value:function(e){(e=document.querySelector("#m-whiteboard-fullscreen video"))&&(e.play(),this.setState({isFullScreen:!this.state.isFullScreen}))}}]),t}())||n;t.default=v},458:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=o(1),a=function(e){return e&&e.__esModule?e:{default:e}}(r),i=o(19);var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=this.props,t=e.body,o=e.isHtml;return a.default.createElement("div",{className:"u-alert-wrapper"},a.default.createElement(i.Mask,{visible:!0}),a.default.createElement("section",{className:"u-alert"},t&&a.default.createElement("div",{className:"u-alert-body"},a.default.createElement("i",{className:"u-loading"}),o?renderHTML(t):t)))}}]),t}();t.default=c},459:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(o(1));var a=34,i=200,c=4,l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.draw=function(){var e=o.props,t=e.width,n=void 0===t?i:t,r=e.value,l=void 0===r?0:r,s=e.height,u=void 0===s?a:s;if(o.lastValue!=l&&(o.lastValue=l,o.refs.canvas)){var f=o.ctx;f||(f=o.ctx=o.refs.canvas.getContext("2d"));var d,m=Math.floor(n/c),p=void 0;d=(n-c*(p=!1&m?~~(m/2):~~((m+1)/2)))/(p-1);var h=Math.floor(l);f.clearRect(0,0,n,u),f.fillStyle="rgb(0,150,0)";for(var g=!1,v=0;v<p;v++){var b=v*(c+d);v>h-1&&!g&&(f.fillStyle="rgb(200,200,200)",g=!0),f.fillRect(b,0,c,u)}}},o.timmer=setInterval(o.draw,10),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),n(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.timmer)}},{key:"resize",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.width,o=void 0===t?i:t,n=e.height,c=void 0===n?a:n;return r.default.createElement("canvas",{ref:"canvas",width:o,height:c})}}]),t}();t.default=l},460:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(o(163));function c(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,o){return function n(r,a){try{var i=t[r](a),c=i.value}catch(e){return void o(e)}if(!i.done)return Promise.resolve(c).then(function(e){n("next",e)},function(e){n("throw",e)});e(c)}("next")})}}var l=function(){var e=c(regeneratorRuntime.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,o){return setTimeout(e,1e3*t)}));case 1:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),s=(r=n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"createInstance",value:function(){var e=c(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._instance){e.next=2;break}return e.abrupt("return",this._instance);case 2:return console.log("now",Date.now()),e.next=5,l();case 5:return console.log("now",Date.now()),this._instance=i.default.newInstance(t),e.abrupt("return",this._instance);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"show",value:function(){var e=c(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._instance){e.next=4;break}return e.next=3,this.createInstance(t);case 3:this._instance=e.sent;case 4:return e.abrupt("return",this._instance.show(t));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"hide",value:function(){return this._instance&&this._instance.hide()}},{key:"destory",value:function(){this._instance&&this._instance.destory(),this._instance=null}}]),e}(),n._instance=null,r);t.default=s},461:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToastCtrl=t.Toast=void 0;var n=a(o(175)),r=a(o(462));function a(e){return e&&e.__esModule?e:{default:e}}t.Toast=n.default,t.ToastCtrl=r.default},462:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(o(175));var c=(r=n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"createInstance",value:function(e){return this._instance=this._instance||i.default.newInstance(e),this._instance}},{key:"show",value:function(e){var t=this,o=e.time,n=void 0===o?3:o;console.log("Toast show inOptions",e),this._instance||this.createInstance(e),this._instance.show(e),n&&setTimeout(function(){t.hide()},1e3*n)}},{key:"hide",value:function(){return this._instance.hide()}},{key:"destory",value:function(){this._instance.destory(),this._instance=null}}]),e}(),n._instance=null,r);t.default=c},463:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(o(162));window.Alert=n.default,t.default={show:function(){n.default.open({msg:'<i className="u-loading" ></i>请稍后...',isHtml:!0,confirm:!1})},hide:function(){n.default.close()}}},464:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=[].concat(Array.prototype.slice.call(arguments));return n._pipe(1===e.length?e[0]:e)};var n={pipe:function(){var e=[].concat(Array.prototype.slice.call(arguments));return this._pipe(1===e.length?e[0]:e)},_pipe:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments[1],n=t.shift();return(o&&o.constructor===Promise?o:Promise.resolve(o)).then(function(){return 0===t.length?e._pipeLast(n,o):e._pipeLast(n,o).then(function(o){return console.log("当前结果",o),e._pipe(t,o)})})},_pipeLast:function(e,t){if(!e||e.constructor!==Function&&e.constructor!==Promise)return Promise.resolve(e);if(e.constructor===Promise)return e;if(e.constructor===Function){var o=e(t);return o&&o.constructor===Promise?o:Promise.resolve(o)}return Promise.resolve(e)}}},465:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){var i=t||{},c=o||document.body,l=document.createElement("div");return c.appendChild(l),r.default.render(n.default.createElement(e,i),l)};var n=a(o(1)),r=(a(o(6)),a(o(59)));function a(e){return e&&e.__esModule?e:{default:e}}},466:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();t.default=function(e){var t,o;return o=t=function(t){function o(){var e,t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=s(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(a))),t=n,n.state={Component:o.Component},s(n,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,t),n(o,[{key:"componentWillMount",value:function(){var t=this;this.state.Component||e().then(function(e){o.Component=e,t.setState({Component:e})})}},{key:"componentWillUpdate",value:function(e){}},{key:"render",value:function(){var e=this.state.Component;return e?(c.default.done(),a.default.createElement(e,this.props)):a.default.createElement(i.Loading,{body:"加载中，请稍等..."})}}]),o}(r.Component),t.Component=null,o};var r=o(1),a=l(r),i=o(88),c=l(o(176));function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}},467:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.success,o=e.fail;(function(){if(!window.WebRTC||!window.WhiteBoard||!WhiteBoard.checkCompatibility())return Promise.reject();return WebRTC.checkCompatibility().then(function(e){console.log("checkCompatibility",e);var t=+e.version.match(/\d+/)[0],o="Chrome"===e.prefix&&t>=58||"Firefox"===e.prefix&&t>=58;return o?Promise.resolve():(console.log("检查reject"),Promise.reject())})})().then(function(){t&&t()}).catch(function(){Alert.open({className:"u-alert-1",title:"提示",msg:'<div class="u-check-compatibility"><i class="u-icon-tip"></i><div class="tip-content"><div class="c1">当前浏览器不支持WebRTC，无法正常使用白板互动功能。</div><div class="c2">白板功能中的音频功能需要WebRTC的支持，请使用最新版Chrome浏览器。</div><div class="c3">下载最新Chrome浏览器，重新打开网页即可。</div></div></div>',isHtml:!0,btns:[{label:"下载最新Chrome",clsName:"u-btn-longer f-h-26 f-mgr-10",onClick:function(){window.open("https://www.baidu.com/s?wd=chrome")}},{label:"仍要体验",clsName:"u-btn-cancle",onClick:function(){Alert.close(),o&&o()}}],close:function(){console.log("【兼容浏览器】 --\x3e X"),Alert.close()}})})},window.test=function(){Alert.open({className:"u-alert-1",title:"提示",msg:'<div class="u-check-compatibility"><i class="u-icon-tip"></i><div class="tip-content"><div class="c1">当前浏览器不支持WebRTC，无法正常使用白板互动功能。</div><div class="c2">白板功能中的音频功能需要WebRTC的支持，请使用最新版Chrome浏览器。</div><div class="c3">下载最新Chrome浏览器，重新打开网页即可。</div></div>',isHtml:!0,btns:[{label:"下载最新Chrome",clsName:"u-btn-longer f-h-26 f-mgr-10",onClick:function(){Alert.close(),window.open("https://www.baidu.com/s?wd=chrome")}},{label:"仍要体验",clsName:"u-btn-cancle",onClick:function(){Alert.close()}}],close:function(){console.log("【兼容浏览器】 --\x3e X"),Alert.close()}})}},468:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){function t(e,t){return e<<t|e>>>32-t}function o(e,t){var o,n,r,a,i;return r=2147483648&e,a=2147483648&t,i=(1073741823&e)+(1073741823&t),(o=1073741824&e)&(n=1073741824&t)?2147483648^i^r^a:o|n?1073741824&i?3221225472^i^r^a:1073741824^i^r^a:i^r^a}function n(e,n,r,a,i,c,l){return o(t(e=o(e,o(o(function(e,t,o){return e&t|~e&o}(n,r,a),i),l)),c),n)}function r(e,n,r,a,i,c,l){return o(t(e=o(e,o(o(function(e,t,o){return e&o|t&~o}(n,r,a),i),l)),c),n)}function a(e,n,r,a,i,c,l){return o(t(e=o(e,o(o(function(e,t,o){return e^t^o}(n,r,a),i),l)),c),n)}function i(e,n,r,a,i,c,l){return o(t(e=o(e,o(o(function(e,t,o){return t^(e|~o)}(n,r,a),i),l)),c),n)}function c(e){var t,o="",n="";for(t=0;t<=3;t++)o+=(n="0"+(e>>>8*t&255).toString(16)).substr(n.length-2,2);return o}var l,s,u,f,d,m,p,h,g,v=Array();for(v=function(e){for(var t,o=e.length,n=o+8,r=16*((n-n%64)/64+1),a=Array(r-1),i=0,c=0;c<o;)i=c%4*8,a[t=(c-c%4)/4]=a[t]|e.charCodeAt(c)<<i,c++;return i=c%4*8,a[t=(c-c%4)/4]=a[t]|128<<i,a[r-2]=o<<3,a[r-1]=o>>>29,a}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",o=0;o<e.length;o++){var n=e.charCodeAt(o);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}(e)),m=1732584193,p=4023233417,h=2562383102,g=271733878,l=0;l<v.length;l+=16)s=m,u=p,f=h,d=g,p=i(p=i(p=i(p=i(p=a(p=a(p=a(p=a(p=r(p=r(p=r(p=r(p=n(p=n(p=n(p=n(p,h=n(h,g=n(g,m=n(m,p,h,g,v[l+0],7,3614090360),p,h,v[l+1],12,3905402710),m,p,v[l+2],17,606105819),g,m,v[l+3],22,3250441966),h=n(h,g=n(g,m=n(m,p,h,g,v[l+4],7,4118548399),p,h,v[l+5],12,1200080426),m,p,v[l+6],17,2821735955),g,m,v[l+7],22,4249261313),h=n(h,g=n(g,m=n(m,p,h,g,v[l+8],7,1770035416),p,h,v[l+9],12,2336552879),m,p,v[l+10],17,4294925233),g,m,v[l+11],22,2304563134),h=n(h,g=n(g,m=n(m,p,h,g,v[l+12],7,1804603682),p,h,v[l+13],12,4254626195),m,p,v[l+14],17,2792965006),g,m,v[l+15],22,1236535329),h=r(h,g=r(g,m=r(m,p,h,g,v[l+1],5,4129170786),p,h,v[l+6],9,3225465664),m,p,v[l+11],14,643717713),g,m,v[l+0],20,3921069994),h=r(h,g=r(g,m=r(m,p,h,g,v[l+5],5,3593408605),p,h,v[l+10],9,38016083),m,p,v[l+15],14,3634488961),g,m,v[l+4],20,3889429448),h=r(h,g=r(g,m=r(m,p,h,g,v[l+9],5,568446438),p,h,v[l+14],9,3275163606),m,p,v[l+3],14,4107603335),g,m,v[l+8],20,1163531501),h=r(h,g=r(g,m=r(m,p,h,g,v[l+13],5,2850285829),p,h,v[l+2],9,4243563512),m,p,v[l+7],14,1735328473),g,m,v[l+12],20,2368359562),h=a(h,g=a(g,m=a(m,p,h,g,v[l+5],4,4294588738),p,h,v[l+8],11,2272392833),m,p,v[l+11],16,1839030562),g,m,v[l+14],23,4259657740),h=a(h,g=a(g,m=a(m,p,h,g,v[l+1],4,2763975236),p,h,v[l+4],11,1272893353),m,p,v[l+7],16,4139469664),g,m,v[l+10],23,3200236656),h=a(h,g=a(g,m=a(m,p,h,g,v[l+13],4,681279174),p,h,v[l+0],11,3936430074),m,p,v[l+3],16,3572445317),g,m,v[l+6],23,76029189),h=a(h,g=a(g,m=a(m,p,h,g,v[l+9],4,3654602809),p,h,v[l+12],11,3873151461),m,p,v[l+15],16,530742520),g,m,v[l+2],23,3299628645),h=i(h,g=i(g,m=i(m,p,h,g,v[l+0],6,4096336452),p,h,v[l+7],10,1126891415),m,p,v[l+14],15,2878612391),g,m,v[l+5],21,4237533241),h=i(h,g=i(g,m=i(m,p,h,g,v[l+12],6,1700485571),p,h,v[l+3],10,2399980690),m,p,v[l+10],15,4293915773),g,m,v[l+1],21,2240044497),h=i(h,g=i(g,m=i(m,p,h,g,v[l+8],6,1873313359),p,h,v[l+15],10,4264355552),m,p,v[l+6],15,2734768916),g,m,v[l+13],21,1309151649),h=i(h,g=i(g,m=i(m,p,h,g,v[l+4],6,4149444226),p,h,v[l+11],10,3174756917),m,p,v[l+2],15,718787259),g,m,v[l+9],21,3951481745),m=o(m,s),p=o(p,u),h=o(h,f),g=o(g,d);return(c(m)+c(p)+c(h)+c(g)).toLowerCase()}},469:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){var n=null,r=null;return function(){var a=+new Date,i=this,c=arguments;r||(r=a),o&&o<a-r?(e.apply(i,c),r=a,clearTimeout(n)):(clearTimeout(n),n=setTimeout(function(){e.apply(i,c),r=null},t))}}},470:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=g(a),c=o(16),l=o(121),s=o(19),u=o(10),f=o(9),d=g(o(472)),m=g(o(85)),p=g(o(21)),h=g(o(20));function g(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=f.StoreNim.state,y=(f.StoreNim,f.StoreChatroom.state),w=(f.StoreChatroom,f.StoreNetcall),S=(f.StoreNetcall.state,(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),c=0;c<r;c++)a[c]=arguments[c];return o=n=v(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={roomName:"",deviceDoctorVisited:!1,deviceDoctor:!1,roomId:"",isNetDetectStatus:"网络探测",startDect:!1,netDetectStatus:"",baseImfo:"",netDetectResult:null,isNetDetect:{display:"none"},netDetectStyle:{display:"none"},webrtcInstance:null,showRoomNameTip:!1,showRoomIdTip:!1,roomNameErrorMsg:"",roomIdErrorMsg:"",canCreate:!1,canJoin:!1,createLoading:!1,joinLoading:!1},n.startNetDetect=function(e){if("Firefox"!==m.default.name){(n.state.netDetectResult||""!==n.state.netDetectStatus)&&n.setState({netDetectResult:null}),n.setState({isNetDetect:{display:"block"},startDect:!0,netDetectStatus:"网络状况: 检测中..."}),console.log("开始网络检测");var t=window.WebRTC.getInstance({debug:!0,nim:b.nim,chromeId:"gapafbpmfemleaplicdhhcikajbogpkf"});t&&t.detectNetworkStatus?t.detectNetworkStatus({detectTime:10}).then(function(e){var o="网络状况: 网络状况检测失败!";if(e){if(console.log("网络探测完成: ",JSON.stringify(e,null," ")),!n.state||"网络状况: 检测中..."!=n.state.netDetectStatus)return;n.setState({netDetectResult:e}),t.destroy(),t=null,o=e.upload_network_status[0].network_status}n.setState({netDetectStatus:o,startDect:!1})}).catch(function(e){console.log("网络探测出现错误: ",e),n.state&&"网络状况: 检测中..."==n.state.netDetectStatus&&n.setState({netDetectStatus:"网络状况: 网络状况检测失败!",startDect:!1})}):n.setState({netDetectStatus:"网络状况: 网络状况非常好，音视频通话均流畅",startDect:!1})}else u.Alert.open({title:"提示",msg:'<div class="u-logoutim"><i class="u-icon-tip"></i> Firefox浏览器当前暂不支持网络检测</div>',isHtml:!0,btns:[{label:"确认",clsName:"u-btn-cancle",onClick:function(){u.Alert.close()}}]})},n.showNetStatus=function(e){var t="";t=n.state.netDetectResult&&n.state.netDetectResult.upload_network_status?"本地IP地址："+n.state.netDetectResult.user_ip+"\n丢包率："+n.state.netDetectResult.loss_rate+"\n带宽："+n.state.netDetectResult.upload_network_status[0].up_bwe+"kbps\n延迟："+n.state.netDetectResult.upload_network_status[0].up_rtt+"ms\n帧率："+n.state.netDetectResult.upload_network_status[0].up_framerate+"\n分辨率："+n.state.netDetectResult.upload_network_status[0].up_resolution:n.state.netDetectStatus,n.setState({baseImfo:t,netDetectStyle:{display:"block"}})},n.hideNetStatus=function(e){n.setState({netDetectStyle:{display:"none"}})},n.changeRoomName=function(e){if("网络状况: 检测中..."!=n.state.netDetectStatus){var t=e.target.value;u.Valid.isBlank(t)?n.setState({roomName:"",canCreate:!1}):n.setState({roomName:t.trim(),canCreate:!0})}else alert("正在网络检测，请稍后创建房间")},n.changeRoomId=function(e){if("网络状况: 检测中..."!=n.state.netDetectStatus){var t=e.target.value;u.Valid.isBlank(t)?n.setState({roomId:"",canJoin:!1}):n.setState({roomId:t.trim(),canJoin:!0})}else alert("正在网络检测，请稍后加入房间")},n.createRoom=function(e){console.log("submit createRoom"),n.state.canCreate&&!n.state.createLoading?u.Valid.isBlank(n.state.roomName)?n.setState({showRoomNameTip:!0,roomNameErrorMsg:"房间名称不能为空"}):(n.setState({showRoomNameTip:!1,roomNameErrorMsg:"",createLoading:!0}),h.default.create(n.state.roomName).then(function(e){console.log("创建聊天室房间成功",e),u.Storage.set("teacherAccount",b.account),h.default.login(e).then(function(){console.log("加入房间成功"),u.Storage.set("roomId",e),u.Storage.set("isTeacher",1),u.Storage.set("hasPermission",!0),n.preHandleRedirect()}).catch(function(e){console.error("加入房间失败",e),e||(e="加入房间失败"),n.setState({showRoomNameTip:!0,roomNameErrorMsg:e,createLoading:!1})})}).catch(function(e){console.error("创建房间失败",e),"聊天室已关闭"==e&&(e="房间不存在"),n.setState({showRoomNameTip:!0,roomNameErrorMsg:e,createLoading:!1})})):console.log("不可创建或正在创建中...")},n.joinRoom=function(e){console.log("submit joinRoom"),n.state.canJoin&&!n.state.joinLoading?u.Valid.isBlank(n.state.roomId)?n.setState({showRoomIdTip:!0,roomIdErrorMsg:"房间ID号码不能为空"}):/^[0-9]+$/.test(n.state.roomId)?(n.setState({showRoomIdTip:!1,roomIdErrorMsg:"",joinLoading:!0}),h.default.login(n.state.roomId).then(function(){console.log("加入房间成功"),u.Storage.set("roomId",n.state.roomId),u.Storage.set("isTeacher",0),n.preHandleRedirect()}).catch(function(e){console.error("加入房间失败",e),"聊天室已关闭"==e&&(e="房间不存在"),e||(e="加入房间失败"),n.setState({showRoomIdTip:!0,roomIdErrorMsg:e,joinLoading:!1})})):n.setState({showRoomIdTip:!0,roomIdErrorMsg:"房间ID不存在"}):console.log("不可加入或正在加入中...")},n.showDeviceDoctor=function(){n.setState({deviceDoctor:!0})},n.hideDeviceDoctor=function(){n.setState({deviceDoctorVisited:!0,deviceDoctor:!1})},n.renderDeviceDoctor=function(){n.state;return i.default.createElement("div",{className:"m-home"},i.default.createElement(d.default,{hide:n.hideDeviceDoctor}))},v(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){(0,u.CheckBroswer)({success:this.autoLogin.bind(this)})}},{key:"autoLogin",value:function(){var e=this;if(b.account)this.autoLoginChatroom();else{console.log("home:开始自动登录nim过程...");var t=u.Storage.get("account"),o=u.Storage.get("token"),n=u.Storage.get("roomName");if(!t||!o)return console.error("home:自动登录nim:缺少account或token"),void u.Page.to("login");console.log(t,o),p.default.login(t,o).then(function(){console.log("home:自动登录nim成功"),console.log("创建聊天室的roomId"),h.default.create(n).then(function(t){console.log("创建聊天室房间成功",t),u.Storage.set("teacherAccount",b.account),h.default.login(t).then(function(){console.log("加入房间成功"),u.Storage.set("roomId",t),u.Storage.set("isTeacher",1),u.Storage.set("hasPermission",!0),e.preHandleRedirect()}).catch(function(t){console.error("加入房间失败",t),console.error("创建roomId失败",t),t||(t="加入房间失败"),e.setState({showRoomNameTip:!0,roomNameErrorMsg:t,createLoading:!1})})}).catch(function(t){console.error("创建房间失败",t),"聊天室已关闭"==t&&(t="房间不存在"),e.setState({showRoomNameTip:!0,roomNameErrorMsg:t,createLoading:!1})})}).catch(function(e){console.error("home:自动登录nim失败"),u.Page.to("login",e)})}}},{key:"autoLoginChatroom",value:function(){return y.currChatroom?(console.log("home:已登录，自动切换到main"),void u.Page.to("main")):(console.log("home:开始自动登录chatroom过程..."),u.Storage.get("roomId")?void this.setState({showRoomIdTip:!1,roomIdErrorMsg:"",joinLoading:!0}):(console.warn("home:自动登录chatroom失败：缺少roomid，首次登陆请忽略！"),void(this.roomIdInput&&this.roomIdInput.focus())))}},{key:"preHandleRedirect",value:function(){console.log("检测当前机器的可用设备...."),WebRTC.checkCompatibility().then(function(e){var t=e.Camera,o=e.Microphone;console.log("--- 设备状态",e),w.setHasAudio(o),w.setHasVideo(t)}).catch(function(e){console.error("获取当前机器可用设备时异常: ",e),w.setHasAudio(!1),w.setHasVideo(!1)}),u.Page.to("main")}},{key:"renderHome",value:function(){var e=this,t=this.state;return i.default.createElement("div",{className:"m-home"},i.default.createElement("div",{className:"net-detect",style:t.isNetDetect},i.default.createElement("div",{className:"layer1"},i.default.createElement("div",{className:"wifi"})),i.default.createElement("div",{className:"describe"}," ",t.netDetectStatus," "),i.default.createElement("div",{className:"u-tips-mark",onMouseOver:this.showNetStatus,onMouseOut:this.hideNetStatus},i.default.createElement("div",{className:"tips-mark"}))),i.default.createElement("div",{className:"detectResult-tips",style:t.netDetectStyle},i.default.createElement(s.TextArea,{id:"test",className:"base-imfo",value:t.baseImfo})),i.default.createElement("div",{className:"split-line"}),i.default.createElement("div",{className:"part part-1"},i.default.createElement("button",{className:"is-net-detect",onClick:this.startNetDetect,disabled:t.startDect},t.isNetDetectStatus),i.default.createElement("div",{className:"icon icon-createroom"}),i.default.createElement("div",{className:"item item-1 f-tac"},i.default.createElement(s.Input,{placeholder:"请输入房间名称",value:t.roomName,onChange:this.changeRoomName,domRef:function(t){e.roomNameInput=t}})),i.default.createElement("div",{className:"errortip ",hidden:!t.showRoomNameTip},t.roomNameErrorMsg),i.default.createElement("div",{className:"item item-2  f-tac"},i.default.createElement(s.Button,{className:"u-btn-longer",onClick:this.createRoom,loading:t.createLoading,disabled:!t.canCreate},"创建房间")),i.default.createElement("div",{className:"tip detect-device"},t.deviceDoctorVisited?i.default.createElement("p",{className:"f-tac"},i.default.createElement(s.Button,{className:"cube-btn",onClick:this.showDeviceDoctor},"再次检测")):i.default.createElement("p",null,i.default.createElement(s.Button,{className:"cube-btn",onClick:this.showDeviceDoctor},"设备检测"),"  首次使用新设备建议先进行设备检测~"))),i.default.createElement("div",{className:"part part-2"},i.default.createElement("div",{className:"icon icon-joinroom"}),i.default.createElement("div",{className:"item item-1 f-tac"},i.default.createElement(s.Input,{name:"roomId",placeholder:"请输入房间ID号码",onChange:this.changeRoomId,value:t.roomId,domRef:function(t){e.roomIdInput=t}})),i.default.createElement("div",{className:"errortip ",hidden:!t.showRoomIdTip},t.roomIdErrorMsg),i.default.createElement("div",{className:"item item-2  f-tac"},i.default.createElement(s.Button,{className:"u-btn-longer",onClick:this.joinRoom,loading:t.joinLoading,disabled:!t.canJoin},"加入房间")),i.default.createElement("div",{className:"tip"},"注：房间ID为创建房间后左上角的数字")))}},{key:"render",value:function(){var e=this.state;return i.default.createElement("div",null,i.default.createElement(l.Header,{isHome:!0}),e.deviceDoctor?this.renderDeviceDoctor():this.renderHome())}}]),t}())||n);t.default=S},471:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=(d(o(6)),o(16)),l=o(9),s=d(o(21)),u=d(o(20)),f=(d(o(23)),d(o(36)),o(10));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}l.StoreNim.state,l.StoreNim;var p=l.StoreChatroom.state,h=(l.StoreChatroom,l.StoreNetcall.state,l.StoreNetcall,(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.logout=function(){console.log("退出im...."),f.Alert.open({title:"操作确认",msg:'<div class="u-logoutim"><i class="u-icon-tip"></i> 确认要退出吗？</div>',isHtml:!0,btns:[{label:"退出",clsName:"u-btn-smaller f-mgr-10 ",onClick:function(){console.log("【退出IM弹窗】 --\x3e 确认"),n.doLogoutIM()}},{label:"取消",clsName:"u-btn-cancle",onClick:function(){console.log("【退出IM弹窗】 --\x3e 取消"),f.Alert.close()}}]})},n.doLogoutIM=function(){f.Alert.close(),s.default.logout()},n.doLogoutChatroom=function(){u.default.logout(p.currChatroomId)},n.doClose4Teacher=function(){console.log("老师：结束会议..."),f.Alert.close(),u.default.close(p.currChatroomId).then(function(){console.log("关闭聊天室成功，继续退出流程"),n.doLogoutChatroom()}).catch(function(e){console.log("关闭聊天室失败: ",e)})},n.doClose4Student=function(){console.log("学生：退出房间..."),f.Alert.close(),n.doLogoutChatroom()},n.doCancle=function(){console.log("【关闭确认弹窗】 -> 取消..."),f.Alert.close()},n.closeChatroom=function(){var e="owner"==p.type,t='<div class="u-exitroom">'+(e?'<i class="u-icon-tip"></i> 确认要结束会议? ':'<i class="u-icon-tip"></i> 确认要退出房间?')+"</div>",o=[{clsName:"u-btn-smaller f-mgr-10 f-w-70"},{label:"取消",clsName:"u-btn-cancle",onClick:function(){n.doCancle()}}];e?(o[0].label="结束会议",o[0].onClick=function(){n.doClose4Teacher()}):(o[0].label="退出房间",o[0].onClick=function(){n.doClose4Student()}),f.Alert.open({title:"提示",msg:t,isHtml:!0,btns:o})},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this.props.isHome;return i.default.createElement("div",{className:"m-header"},i.default.createElement("div",{className:"logo"},"肿瘤规范化诊疗平台",p.type?(p.type,""):""),i.default.createElement("div",{className:"opt"},i.default.createElement("div",{className:"opt-inner"},e?i.default.createElement("a",{href:"javascript:void(0);",className:"logout",onClick:this.logout},"退出"):i.default.createElement("a",{href:"javascript:void(0);",className:"close",onClick:this.closeChatroom},i.default.createElement("span",null,"关闭")))))}}]),t}())||n);t.default=h},472:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=f(o(1)),a=o(9),i=o(19),c=f(o(481)),l=f(o(473)),s=f(o(474)),u=f(o(475));function f(e){return e&&e.__esModule?e:{default:e}}function d(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,o){return function n(r,a){try{var i=t[r](a),c=i.value}catch(e){return void o(e)}if(!i.done)return Promise.resolve(c).then(function(e){n("next",e)},function(e){n("throw",e)});e(c)}("next")})}}var m=a.StoreNim.state,p=function(e){function t(e){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.getDevices=function(){n.netcall.getDevices().then(function(){var e=d(regeneratorRuntime.mark(function e(t){var r,a,i,c,l,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("设备列表：",t),r=t.audioIn||[],a=t.audioOut||[],i=t.video||[],e.next=6,n.cleanSpeakerTest();case 6:return e.next=8,n.cleanMicphoneTest();case 8:return e.next=10,n.cleanCameraTest();case 10:if(c=n.state,l=c.currentAudioIn,s=c.currentAudioOut,u=c.currentVideo,c.canResponse,a.some(function(e){return e.deviceId===s})){e.next=16;break}return e.next=14,n.cleanSpeakerTest();case 14:!1,s=(a[0]||{deviceId:""}).deviceId;case 16:if(r.some(function(e){return e.deviceId===l})){e.next=21;break}return e.next=19,n.cleanMicphoneTest();case 19:!1,l=(r[0]||{deviceId:""}).deviceId;case 21:if(i.some(function(e){return e.deviceId===u})){e.next=26;break}return e.next=24,n.cleanCameraTest();case 24:!1,u=(i[0]||{deviceId:""}).deviceId;case 26:n.setState({audioIn:r,currentAudioIn:(r[0]||{deviceId:""}).deviceId,audioOut:a,currentAudioOut:(a[0]||{deviceId:""}).deviceId,video:i,currentVideo:(i[0]||{deviceId:""}).deviceId,canResponse:!1},function(){3===n.state.currentStep&&setTimeout(function(){n.checkCamera()},300)});case 27:case"end":return e.stop()}},e,o)}));return function(t){return e.apply(this,arguments)}}())},n.onSpeakerChange=function(e){var t=e.target.value;n.setState({currentAudioOut:t}),n.audio&&n.audioPlay.setSinkId(t).then(function(){setTimeout(function(){n.audio.currentTime=n.audioPlay.currentTime},20),console.log("Audio output device attached: "+t)}).catch(function(e){console.error(e)}),console.log(e.target.value)},n.onMicphoneChange=function(e){var t=e.target.value;n.setState({currentAudioIn:t},d(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.cleanMicphoneTest();case 2:return e.next=4,new Promise(function(e){return setTimeout(e,500)});case 4:return e.next=6,n.checkMicphone();case 6:case"end":return e.stop()}},e,o)})))},n.onCameraChange=function(e){var t=e.target.value;n.setState({currentVideo:t},d(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.checkCamera();case 2:case"end":return e.stop()}},e,o)})))},n.cleanSpeakerTest=function(){n.audio&&(n.setState({audioMeterValue:0,audioVolume:50}),n.analyser.onaudioprocess=function(){},n.analyser.disconnect(n.dest),n.source.disconnect(n.analyser),n.contextA.close(),n.audioPlay.pause(),n.audio.removeAttribute("src"),n.audio.load(),n.audioPlay.removeAttribute("src"),n.audioPlay.load(),n.audio=null,n.audioPlay=null,n.analyser=null,n.contextA=null,n.source=null,n.dest=null)},n.checkSpeaker=function(){var e=n.audio;if(e)n.audioPlay.currentTime=n.audio.currentTime=0;else{setTimeout(function(){return n.setState({canResponse:!0})},5e3),e=n.audio=new Audio(l.default),n.audioPlay=new Audio(l.default),n.audioPlay.volume=n.state.audioVolume/100,n.audioPlay.loop=!0,e.loop=!0,e.play(),e.muted,n.audioPlay.play();var t=AudioContext||webkitAudioContext,o=n.contextA=new t,r=n.source=o.createMediaElementSource(e),a=n.dest=o.createMediaStreamDestination(),i=n.analyser=o.createScriptProcessor(1024,1,1);r.connect(i),i.connect(a),i.onaudioprocess=function(e){for(var t=e.inputBuffer.getChannelData(0),o=0,r=0;r<t.length;r++)o=t[r]>o?t[r]:o;n.setState({audioMeterValue:Math.floor(100*o)})}}},n.cleanMicphoneTest=d(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(clearInterval(n.micphoneTimmer),n.micphoneTimmer=null,!n.state.audioOutOk){e.next=5;break}return e.next=5,n.netcall.stopDevice(WebRTC.DEVICE_TYPE_AUDIO_OUT_LOCAL);case 5:return e.next=7,n.netcall.stopDevice(WebRTC.DEVICE_TYPE_AUDIO_IN);case 7:n.micphoneApi=null;case 8:case"end":return e.stop()}},e,o)})),n.checkMicphone=d(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(setTimeout(function(){return n.setState({canResponse:!0})},5e3),n.micphoneTimmer){e.next=12;break}return e.next=4,n.netcall.startDevice({type:WebRTC.DEVICE_TYPE_AUDIO_IN,device:{deviceId:n.state.currentAudioIn}});case 4:if(!n.state.audioOutOk){e.next=7;break}return e.next=7,n.netcall.startDevice({type:WebRTC.DEVICE_TYPE_AUDIO_OUT_LOCAL,device:{deviceId:n.state.currentAudioOut}});case 7:n.netcall.setCaptureVolume(~~(n.state.audioVolume/100*255)),console.log(~~(n.state.audioVolume/100*255)),t=n.netcall.adapterRef.audioHelperLocal.webAudio,n.micphoneTimmer=setInterval(function(){n.setState({audioMeterValue:Math.floor(t&&100*t.instant||0)})},100),console.log("开始测试麦克风");case 12:case"end":return e.stop()}},e,o)})),n.cleanCameraTest=d(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=document.getElementById("js-doctor-video"),e.next=4,n.netcall.stopDevice({type:WebRTC.DEVICE_TYPE_VIDEO});case 4:return e.next=6,n.netcall.stopLocalStream(t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,o,[[0,8]])})),n.checkCamera=d(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return setTimeout(function(){return n.setState({canResponse:!0})},3e3),t=document.getElementById("js-doctor-video"),e.prev=2,e.next=5,n.netcall.stopDevice({type:WebRTC.DEVICE_TYPE_VIDEO});case 5:return e.next=7,n.netcall.stopLocalStream(t);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0);case 12:return e.next=14,n.netcall.startDevice({type:WebRTC.DEVICE_TYPE_VIDEO,device:{deviceId:n.state.currentVideo}});case 14:return e.next=16,n.netcall.startLocalStream(t);case 16:r={width:240,height:130,cut:!1},netcall.setVideoViewSize(r);case 18:case"end":return e.stop()}},e,o,[[2,9]])})),n.onSpeakerRangeChanged=function(e){var t=e.x;n.setState({audioVolume:t}),n.audioPlay&&(n.audioPlay.volume=t/100)},n.onMicphoneRangeChanged=function(e){var t=e.x;n.setState({audioVolume:t}),n.netcall.setCaptureVolume(~~(n.state.audioVolume/100*255))},n.state={audioOut:[],currentAudioOut:"",audioOutOk:!1,audioVolume:50,audioMeterValue:0,audioIn:[],currentAudioIn:"",audioInOk:!1,video:[],currentVideo:"",videoOk:!1,currentStep:1,canResponse:!1},NIM.use(WebRTC),window.netcall=n.netcall=window.WebRTC.getInstance({container:null,remoteContainer:null,debug:!1,nim:m.nim,chromeId:"gapafbpmfemleaplicdhhcikajbogpkf"}),/^https:/.test(location.protocol)||/localhost/.test(location.hostname)?console.log("OK"):console.warn("非https://协议或 localhost,可能导致demo无法运行"),window.netcall=n.netcall,n.netcall.on("deviceStatus",n.getDevices),n.getDevices(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),n(t,[{key:"componentWillUnmount",value:function(){this.netcall.destroy(),this.cleanSpeakerTest(),this.netcall.off("deviceStatus"),navigator.mediaDevices.ondevicechange=null}},{key:"nextStep",value:function(e){var t=this,o=this.state,n=o.currentStep,r=o.audioInOk,a=o.audioOutOk,i=o.videoOk;switch(n){case 1:a=e,this.cleanSpeakerTest();break;case 2:r=e,this.cleanMicphoneTest();break;case 3:i=e,this.cleanCameraTest()}this.setState({currentStep:n+1,audioVolume:50,audioMeterValue:0,videoOk:i,audioInOk:r,audioOutOk:a,canResponse:!1},function(){3===t.state.currentStep&&t.checkCamera()})}},{key:"renderStep1",value:function(){var e=this.state,t=e.audioOut,o=e.currentAudioOut,n=e.audioVolume,a=e.audioMeterValue;return r.default.createElement("div",{className:"doctor-speaker"},r.default.createElement("div",{className:"u-row"},r.default.createElement("span",{className:"u-col-4"},"选择扬声器"),r.default.createElement("div",{className:"u-col-20"},r.default.createElement("select",{value:o,onChange:this.onSpeakerChange},t.map(function(e,t){return r.default.createElement("option",{key:e.deviceId,value:e.deviceId},e.label||"扬声器 "+t)})))),r.default.createElement("div",{className:"u-row"},r.default.createElement("span",{className:"u-col-4"},"扬声器音量"),r.default.createElement("div",{className:"u-col-20"},r.default.createElement(c.default,{styles:{active:{backgroundColor:"#076bf2"}},x:n,onChange:this.onSpeakerRangeChanged}))),r.default.createElement("div",{className:"u-row"},r.default.createElement("span",{className:"u-col-4"},r.default.createElement(i.Button,{className:"cube-btn",disabled:!!this.audio,onClick:this.checkSpeaker},"扬声器测试")),r.default.createElement("div",{className:"u-col-20"},r.default.createElement(i.VolumeMeter,{width:400,value:a}))))}},{key:"renderStep2",value:function(){var e=this.state,t=e.audioIn,o=e.currentAudioIn,n=e.audioVolume,a=e.audioMeterValue;return r.default.createElement("div",{className:"doctor-speaker"},r.default.createElement("div",{className:"u-row"},r.default.createElement("span",{className:"u-col-4"},"选择麦克风"),r.default.createElement("div",{className:"u-col-20"},r.default.createElement("select",{value:o,onChange:this.onMicphoneChange},t.map(function(e,t){return r.default.createElement("option",{key:e.deviceId,value:e.deviceId},e.label||"麦克风 "+t)})))),r.default.createElement("div",{className:"u-row"},r.default.createElement("span",{className:"u-col-4"},"麦克风音量"),r.default.createElement("div",{className:"u-col-20"},r.default.createElement(c.default,{styles:{active:{backgroundColor:"#076bf2"}},x:n,onChange:this.onMicphoneRangeChanged}))),r.default.createElement("div",{className:"u-row"},r.default.createElement("span",{className:"u-col-4"},r.default.createElement(i.Button,{className:"cube-btn",disabled:!!this.micphoneTimmer,onClick:this.checkMicphone},"麦克风测试")),r.default.createElement("div",{className:"u-col-20"},r.default.createElement(i.VolumeMeter,{width:400,value:a}))))}},{key:"renderStep3",value:function(){var e=this.state,t=e.video,o=e.currentVideo;e.canResponse,e.audioVolume,e.audioMeterValue;return r.default.createElement("div",{className:"doctor-speaker"},r.default.createElement("div",{className:"u-row"},r.default.createElement("span",{className:"u-col-4"},"选择摄像头"),r.default.createElement("div",{className:"u-col-20"},r.default.createElement("select",{value:o,onChange:this.onCameraChange},t.map(function(e,t){return r.default.createElement("option",{key:e.deviceId,value:e.deviceId},e.label||"摄像头 "+t)})))),r.default.createElement("div",{className:"u-row"},r.default.createElement("div",{className:"f-tac"},r.default.createElement("div",{id:"js-doctor-video"}))))}},{key:"renderStep4",value:function(){var e=this,t=this.state,o=t.videoOk,n=t.audioInOk,a=t.audioOutOk,c=t.audioIn,l=t.audioOut,f=t.video,d=t.currentAudioIn,m=t.currentAudioOut,p=t.currentVideo,h=o&&n&&a,g=(l.find(function(e){return e.deviceId==m})||{label:"未知扬声器"}).label,v=(c.find(function(e){return e.deviceId==d})||{label:"未知麦克风"}).label,b=(f.find(function(e){return e.deviceId==p})||{label:"未知摄像头"}).label;return r.default.createElement("div",{className:"doctor-result"},r.default.createElement("div",{className:"u-row f-tac"},r.default.createElement("div",{className:"modal-face"},h?r.default.createElement("svg",{width:"60px",height:"60px",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},r.default.createElement("path",{fill:"#515151",d:"M922.694 336.994c-22.447-53.07-54.574-100.725-95.491-141.641-40.916-40.916-88.57-73.044-141.641-95.491-54.961-23.246-113.325-35.033-173.472-35.033S393.58 76.616 338.619 99.862c-53.07 22.447-100.725 54.575-141.641 95.491-40.917 40.916-73.044 88.571-95.491 141.641-23.247 54.961-35.034 113.325-35.034 173.472 0 60.147 11.787 118.511 35.034 173.472 22.447 53.07 54.574 100.725 95.49 141.641 40.917 40.917 88.571 73.044 141.642 95.491 54.961 23.246 113.325 35.033 173.472 35.033s118.511-11.787 173.472-35.033c53.07-22.447 100.725-54.574 141.641-95.491 40.917-40.916 73.044-88.571 95.491-141.641 23.246-54.961 35.033-113.325 35.033-173.472 0-60.147-11.788-118.511-35.034-173.472zM512.091 892.103c-210.436 0-381.637-171.202-381.637-381.637s171.202-381.637 381.637-381.637S893.728 300.03 893.728 510.465 722.526 892.103 512.091 892.103zM328.252 418.546m-76.599 0a76.599 76.599 0 1 0 153.198 0 76.599 76.599 0 1 0-153.198 0ZM695.93 418.546m-76.599 0a76.599 76.599 0 1 0 153.198 0 76.599 76.599 0 1 0-153.198 0ZM732.466 588.229c-16.279-6.879-35.053 0.741-41.932 17.021-30.374 71.885-100.417 118.334-178.443 118.334-78.026 0-148.069-46.449-178.444-118.334-6.879-16.28-25.653-23.899-41.932-17.021-16.28 6.879-23.9 25.652-17.021 41.932 40.408 95.631 133.592 157.424 237.397 157.424 103.806 0 196.989-61.793 237.396-157.424 6.879-16.28-0.742-35.054-17.021-41.932z"})):r.default.createElement("svg",{width:"60px",height:"60px",viewBox:"120 10 180 210",xmlns:"http://www.w3.org/2000/svg"},r.default.createElement("g",{id:"svg_5"},r.default.createElement("path",{id:"svg_4",d:"m291.54503,84.66959c-4.49172,-10.61948 -10.92044,-20.1554 -19.10807,-28.34283c-8.18743,-8.18743 -17.72315,-14.61635 -28.34284,-19.10807c-10.99787,-4.6516 -22.6767,-7.01022 -34.71232,-7.01022s-23.71424,2.35862 -34.71212,7.01022c-10.61949,4.49172 -20.15541,10.92064 -28.34284,19.10807c-8.18762,8.18743 -14.61634,17.72335 -19.10806,28.34283c-4.65181,10.99788 -7.01042,22.67671 -7.01042,34.71233c0,12.03561 2.35861,23.71444 7.01042,34.71232c4.49172,10.61948 10.92044,20.15541 19.10786,28.34283c8.18763,8.18763 17.72335,14.61635 28.34304,19.10807c10.99788,4.6516 22.67671,7.01022 34.71232,7.01022s23.71445,-2.35862 34.71232,-7.01022c10.61949,-4.49172 20.15541,-10.92044 28.34284,-19.10807c8.18763,-8.18742 14.61635,-17.72335 19.10807,-28.34283c4.6516,-10.99788 7.01022,-22.67671 7.01022,-34.71232c0,-12.03562 -2.35882,-23.71445 -7.01042,-34.71233zm-82.16303,111.07916c-42.10894,0 -76.36683,-34.25809 -76.36683,-76.36683s34.25809,-76.36684 76.36683,-76.36684s76.36683,34.25789 76.36683,76.36664s-34.25809,76.36703 -76.36683,76.36703zm-52.11451,-94.76033a15.32771,15.32771 0 1 0 30.65543,0a15.32771,15.32771 0 1 0 -30.65543,0zm73.57359,0a15.32771,15.32771 0 1 0 30.65543,0a15.32771,15.32771 0 1 0 -30.65543,0z",fill:"#515151"}),r.default.createElement("rect",{id:"svg_12",height:"13.978502",width:"81.720475",y:"140.375291",x:"168.47906",fill:"#515151"}))),h?r.default.createElement("div",{className:"text-explain"},r.default.createElement("h5",null,"设备正常"),r.default.createElement("p",null,"设备没有问题，可以正常上课")):r.default.createElement("div",{className:"text-explain"},r.default.createElement("h5",null,"设备检测未通过"),r.default.createElement("p",null,"不必担心，您可通过设置进行进一步检测",r.default.createElement("br",null),"仍有问题可联系客服解决"))),r.default.createElement("div",{className:"u-row"},r.default.createElement("div",{className:"u-col-6 f-tar"},r.default.createElement("svg",{role:"camera",width:"20px",height:"20px",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},r.default.createElement("path",{fill:"#515151",d:"M520.896 815.296c197.952 0 358.976-166.08 358.976-370.112S718.784 75.072 520.896 75.072 162.048 241.088 162.048 445.184s160.96 370.112 358.848 370.112z m0-676.224c162.688 0 294.976 137.344 294.976 306.112 0 168.832-132.288 306.112-294.976 306.112-162.624 0-294.848-137.344-294.848-306.112-0.064-168.768 132.224-306.112 294.848-306.112zM824.256 746.112a32.128 32.128 0 0 0-29.888 56.64c21.888 11.584 27.264 20.736 27.52 22.528-1.92 20.864-106.688 69.824-300.992 69.824-191.488 0-299.072-49.536-300.864-69.824 0.128-1.664 5.056-10.432 26.176-21.888a32 32 0 0 0-30.464-56.256c-49.344 26.688-59.712 57.216-59.712 78.144 0 91.968 189.12 133.824 364.864 133.824 175.808 0 364.992-41.856 364.992-133.824 0-21.248-10.688-52.224-61.632-79.168zM520.96 618.816a173.632 173.632 0 1 0 0.128-347.264 173.632 173.632 0 0 0-0.128 347.264z m-59.968-315.648a70.976 70.976 0 1 1 0 141.952 70.976 70.976 0 0 1 0-141.952z"}))),r.default.createElement("div",{className:"u-col-12 f-tal"},r.default.createElement("p",{className:"device-name",title:g}," ",g," ")),r.default.createElement("div",{className:"u-col-6 f-tal"},a?r.default.createElement("img",{className:"diy-icon",src:s.default}):r.default.createElement("img",{className:"diy-icon",src:u.default}))),r.default.createElement("div",{className:"u-row"},r.default.createElement("div",{className:"u-col-6 f-tar"},r.default.createElement("svg",{role:"headphone",width:"20px",height:"20px",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},r.default.createElement("path",{fill:"#515151",d:"M896 512h-42.666667v-85.333333c0-188.202667-153.130667-341.333333-341.333333-341.333334s-341.333333 153.130667-341.333333 341.333334v85.333333H128a42.666667 42.666667 0 0 0-42.666667 42.666667v256a42.666667 42.666667 0 0 0 42.666667 42.666666h85.333333a42.666667 42.666667 0 0 0 42.666667-42.666666v-384c0-141.184 114.816-256 256-256s256 114.816 256 256v384a42.666667 42.666667 0 0 0 42.666667 42.666666h85.333333a42.666667 42.666667 0 0 0 42.666667-42.666666v-256a42.666667 42.666667 0 0 0-42.666667-42.666667z"}),r.default.createElement("path",{fill:"#515151",d:"M298.666667 512h85.333333v341.333333H298.666667z m341.333333 0h85.333333v341.333333h-85.333333z"}))),r.default.createElement("div",{className:"u-col-12 f-tal"},r.default.createElement("p",{className:"device-name",title:v}," ",v," ")),r.default.createElement("div",{className:"u-col-6 f-tal"},n?r.default.createElement("img",{className:"diy-icon",src:s.default}):r.default.createElement("img",{className:"diy-icon",src:u.default}))),r.default.createElement("div",{className:"u-row"},r.default.createElement("div",{className:"u-col-6 f-tar"},r.default.createElement("svg",{width:"20px",height:"20px",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},r.default.createElement("path",{fill:"#515151",d:"M480 704A160 160 0 0 0 640 544v-384a160 160 0 1 0-320 0v384A160 160 0 0 0 480 704zM704 448v96a224 224 0 1 1-448 0V448H192v96a288 288 0 0 0 256 286.208V960H320v64h320v-64H512v-129.792A288 288 0 0 0 768 544V448h-64z"}))),r.default.createElement("div",{className:"u-col-12 f-tal"},r.default.createElement("p",{className:"device-name",title:b}," ",b," ")),r.default.createElement("div",{className:"u-col-6 f-tal"},o?r.default.createElement("img",{className:"diy-icon",src:s.default}):r.default.createElement("img",{className:"diy-icon",src:u.default}))),r.default.createElement("p",null,r.default.createElement(i.Button,{className:"cube-btn",onClick:function(){return e.props.hide()}},"确认"))))}},{key:"render",value:function(){var e=this,t=this.state,o=t.currentStep,n=t.canResponse,a=t.audioOutOk;return r.default.createElement("div",{className:"device-doctor"},r.default.createElement("div",{className:"doctor-header"},"设备检测"),1==o&&this.renderStep1(),2==o&&this.renderStep2(),3==o&&this.renderStep3(),4!==o&&r.default.createElement("div",{className:"doctor-questions"},1===o&&r.default.createElement("div",{className:"u-row"},r.default.createElement("div",{className:"u-col-16"},"是否听见播放的音乐？"),r.default.createElement("div",{className:"u-col-8 f-tar"},r.default.createElement(i.Button,{className:"cube-btn",disabled:!n,onClick:function(){return e.nextStep(!0)}},"是"),"  ",r.default.createElement(i.Button,{className:"cube-btn",disabled:!n,onClick:function(){return e.nextStep(!1)}},"否"))),2===o&&r.default.createElement("div",{className:"u-row"},r.default.createElement("div",{className:"u-col-16"},a?"是否听见麦克风回放？":"上方音量条是否随声音变化？"),r.default.createElement("div",{className:"u-col-8 f-tar"},r.default.createElement(i.Button,{className:"cube-btn",disabled:!n,onClick:function(){return e.nextStep(!0)}},"是"),"  ",r.default.createElement(i.Button,{className:"cube-btn",disabled:!n,onClick:function(){return e.nextStep(!1)}},"否"))),3===o&&r.default.createElement("div",{className:"u-row f-tac"},r.default.createElement("p",null,"能否清晰的看到摄像头捕获画面？"),r.default.createElement("p",null," ",r.default.createElement(i.Button,{className:"cube-btn",disabled:!n,onClick:function(){return e.nextStep(!0)}},"是"),"  ",r.default.createElement(i.Button,{className:"cube-btn",disabled:!n,onClick:function(){return e.nextStep(!1)}},"否"))),r.default.createElement("div",{className:"f-tac"},r.default.createElement("span",{className:"step-indi "+(o>0?"active":"")},"1"),r.default.createElement("span",{className:"step-indi "+(o>1?"active":"")},"2"),r.default.createElement("span",{className:"step-indi "+(o>2?"active":"")},"3"))),4===o&&this.renderStep4())}}]),t}();t.default=p},473:function(e,t,o){e.exports=o.p+"music/audio-36e42399.mp3"},474:function(e,t){e.exports="data:image/png;base64,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"},475:function(e,t){e.exports="data:image/png;base64,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"},476:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(16),l=(o(19),o(10)),s=o(9),u=(d(o(85)),d(o(21))),f=d(o(20));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=s.StoreNim.state,h=(s.StoreNim,s.StoreChatroom,s.StoreNetcall),g=(s.StoreNetcall.state,(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={loading:!1,account:"",pwd:"",errorTip:"",showErrorTip:!1,canLogin:!1,hasAccount:!1,hasPwd:!1,className:"",loginLoading:!1},n.changeAccount=function(e){var t=e.target.value;l.Valid.isBlank(t)?n.setState({hasAccount:!1,account:"",canLogin:!1}):n.setState(function(e,o){return{hasAccount:!0,account:t.trim(),canLogin:e.hasPwd}})},n.changePwd=function(e){var t=e.target.value;l.Valid.isBlank(t)?n.setState({hasPwd:!1,pwd:"",canLogin:!1}):n.setState(function(e,o){return{hasPwd:!0,pwd:t.trim(),canLogin:e.hasAccount}})},n.submit=function(){n.state.canLogin&&!n.state.loginLoading?l.Valid.isBlank(n.state.account)?n.setState({showErrorTip:!0,errorTip:"账号不能为空"}):l.Valid.isBlank(n.state.pwd)?n.setState({showErrorTip:!0,errorTip:"密码不能为空"}):(n.setState({showErrorTip:!1,errorTip:"",loginLoading:!0}),console.log(n.state.account),n.requestLogin({account:n.state.account,pwd:n.state.pwd})):console.log("不可点击登录或正在登录中...")},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){(0,l.CheckBroswer)({success:this.autoLogin.bind(this)})}},{key:"autoLogin",value:function(){if(this.setState({loginLoading:!0}),p.account)return console.log("已登录，自动切换到home"),void this.requestHome();console.log("login:开始自动登录nim过程...");l.Valid.getUrlParam("nickname");var e=l.Valid.getUrlParam("username"),t=l.Valid.getUrlParam("pwd"),o=l.Valid.getUrlParam("roomName");this.requestLogin({account:e,pwd:t,roomName:o})}},{key:"regist",value:function(){console.log("跳转到注册页..."),l.Page.to("regist")}},{key:"requestLogin",value:function(e){var t=this,o=e.account,n=(0,l.MD5)(e.pwd),r=e.roomName;u.default.login(o,n,r).then(function(){console.log("登录成功"),l.Storage.set("account",e.account),l.Storage.set("token",n),l.Storage.set("roomName",r),t.requestHome()}).catch(function(e,o,n){console.log(e,o,n);var r=l.Valid.getUrlParam("nickname"),a=l.Valid.getUrlParam("username");r&&a||alert("没有用户名和昵称"),t.setState({loginLoading:!1}),console.log("用户名："+l.Valid.getUrlParam("username"),"密码："+l.Valid.getUrlParam("pwd")),alert(e)})}},{key:"requestRegist",value:function(e){var t=this;u.default.regist(e).then(function(){alert("注册成功"),t.requestLogin({account:t.state.username,pwd:t.state.password})}).catch(function(o){if(console.error("注册失败",o),"帐号已注册"===o){var n=e.username,r=(0,l.MD5)(e.password);l.Storage.set("account",n),l.Storage.set("token",r),l.Storage.set("roomName",l.Valid.getUrlParam("roomName")),t.requestHome()}})}},{key:"requestHome",value:function(e){var t=this,o=(l.Storage.get("account"),l.Storage.get("token"),l.Storage.get("roomName"));console.log("创建房间 roomName",o),f.default.create(o).then(function(e){console.log("创建聊天室房间成功",e),l.Storage.set("teacherAccount",p.account),f.default.login(e).then(function(){console.log("加入房间成功"),l.Storage.set("roomId",e),l.Storage.set("isTeacher",1),l.Storage.set("hasPermission",!0),t.setState({loginLoading:!1}),t.preHandleRedirect()}).catch(function(e){console.error("加入房间失败",e),console.error("创建roomId失败",e),alert("加入房间失败"),e||(e="加入房间失败"),t.setState({showRoomNameTip:!0,roomNameErrorMsg:e,createLoading:!1}),t.setState({loginLoading:!1})})}).catch(function(e){console.error("创建房间失败",e),alert("创建房间失败"),"聊天室已关闭"==e&&(e="房间不存在")})}},{key:"preHandleRedirect",value:function(){console.log("检测当前机器的可用设备...."),WebRTC.checkCompatibility().then(function(e){var t=e.Camera,o=e.Microphone;console.log("--- 设备状态",e),h.setHasAudio(o),h.setHasVideo(t)}).catch(function(e){console.error("获取当前机器可用设备时异常: ",e),h.setHasAudio(!1),h.setHasVideo(!1)}),l.Page.to("main")}},{key:"loadingControl",value:function(){return this.state.loginLoading?"m-login loading":"m-login"}},{key:"render",value:function(){this.state;return i.default.createElement("div",{className:this.loadingControl()})}}]),t}())||n);t.default=g},477:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=b(a),c=o(16),l=o(121),s=o(19),u=o(88),f=o(9),d=o(10),m=b(o(120)),p=b(o(21)),h=(b(o(20)),b(o(23))),g=b(o(36)),v=b(o(478));function b(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var w=f.StoreNim.state,S=(f.StoreNim,f.StoreChatroom.state),E=f.StoreChatroom,C=f.StoreNetcall.state,O=f.StoreNetcall,k=(0,c.observer)(n=function(e){function t(){var e,o,n,r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=Array(a),c=0;c<a;c++)i[c]=arguments[c];return o=n=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.state={needShowTip:!0,requesting:!1},n.shareScreen=function(){var e=n.findOwnerIdx();if(-1!=e){var t=S.members[e].account;console.log("当前聊天室主持人：",t),p.default.sendCustomSysMsg(t,{room_id:S.currChatroomId,command:14}),O.setShareStarted(!1),h.default.startChromeShareScreen().then(function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,o){return function n(r,a){try{var i=t[r](a),c=i.value}catch(e){return void o(e)}if(!i.done)return Promise.resolve(c).then(function(e){n("next",e)},function(e){n("throw",e)});e(c)}("next")})}}(regeneratorRuntime.mark(function e(){var t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!=(t=C.members.findIndex(function(e){return e.account==w.account}))){e.next=4;break}return console.error("不存在的成员, 无法渲染",w.account),e.abrupt("return");case 4:if(o=C.doms[t]){e.next=8;break}return console.error("@@@@ 不存在的节点，忽略渲染本地流"),e.abrupt("return");case 8:return console.log("selfshare:当前人员加入节点：",o),e.next=11,h.default.startLocalStream(o);case 11:return e.next=13,h.default.setVideoViewSize();case 13:setTimeout(function(){O.setShareStarted(!0)},1e3);case 14:case"end":return e.stop()}},e,r)}))).catch(function(e){n.stopScreenSharing(),O.setShareStarted(!1)})}else console.error("未找到老师端，老师不在线所致")},n.stopScreenSharing=function(){var e=n.findOwnerIdx();if(-1!=e){var t=S.members[e].account;console.log("当前聊天室主持人：",t),p.default.sendCustomSysMsg(t,{room_id:S.currChatroomId,command:15})}else console.error("未找到老师端，老师不在线所致")},n.request=function(e){var t=n.findOwnerIdx();if(-1!=t){var o=S.members[t].account;console.log("当前聊天室主持人：",o),n.setState({requesting:!0}),p.default.sendCustomSysMsg(o,{room_id:S.currChatroomId,command:10}).then(function(){console.log("发送请求连麦消息成功"),O.setShowStatus(1),n.setState({requesting:!1})}).catch(function(e){console.error("发送请求连麦消息失败",e),O.setShowStatus(0),n.setState({requesting:!1})})}else console.error("未找到老师端，老师不在线所致")},n.cancleRequest=function(e){var t=n.findOwnerIdx();if(-1!=t){var o=S.members[t].account;console.log("当前聊天室主持人：",o),n.setState({requesting:!0}),p.default.sendCustomSysMsg(o,{room_id:S.currChatroomId,command:13}).then(function(){console.log("发送请求取消连麦消息成功"),O.setShowStatus(0),n.setState({requesting:!1})}).catch(function(e){console.error("发送请求取消连麦消息失败",e),O.setShowStatus(1),n.setState({requesting:!1})})}else console.error("未找到老师端，老师不在线所致")},n.doStopInteraction=function(){console.log("【停止互动确认弹窗】--\x3e 确定..."),d.Alert.close();var e=n.findOwnerIdx();if(-1!=e){var t=S.members[e].account;console.log("当前聊天室主持人：",t),n.setState({requesting:!0}),p.default.sendCustomSysMsg(t,{room_id:S.currChatroomId,command:13}).then(function(){console.log("【停止连麦】发送请求取消连麦消息成功"),O.setShowStatus(0),n.setState({requesting:!1});var e=C.members.findIndex(function(e){return e.account==w.account});-1==e?console.error("未找到对应DOM节点,无法停止流..."):h.default.stopLocalStream(C.doms[e]),O.delMember(w.account),O.setHasPermission(!1),E.setMemberStatus(w.account,0),g.default.changeRoleToAudience(),h.default.changeRoleToAudience().then(function(){return console.log("==== 切换为观众成功"),h.default.stopMicro()}).then(function(){return console.log("==== 停止麦克风成功"),O.setAudio(!1),h.default.stopCamera()}).then(function(){console.log("==== 停止摄像头成功"),O.setVideo(!1)}).catch(function(e){console.error("停止本地行为失败",e)})}).catch(function(e){console.error("【停止连麦】发送请求取消连麦消息失败",e),n.setState({requesting:!1})})}else console.error("未找到老师端，老师不在线所致")},n.doCancle=function(){console.log("【停止互动确认弹窗】--\x3e 取消..."),d.Alert.close()},n.stopInteraction=function(e){d.Alert.open({title:"提示",msg:'<div class="u-stop-interaction"><i class="u-icon-tip"></i>确定退出互动嘛？</div>',isHtml:!0,btns:[{label:"确定",clsName:"u-btn-smaller f-mgr-10",onClick:function(){n.doStopInteraction()}},{label:"取消",clsName:"u-btn-cancle",onClick:function(){n.doCancle()}}]})},n.closeDeviceDisabledTip=function(){n.setState({needShowTip:!1})},y(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){(0,d.CheckBroswer)({success:this.init.bind(this)})}},{key:"init",value:function(){O.setShowStatus(0),this.autoLogin()}},{key:"findOwnerIdx",value:function(){return S.members.findIndex(function(e,t){return"owner"==e.type})}},{key:"render",value:function(){var e=this.state,t="owner"!=S.type&&!C.hasPermission,o="owner"!=S.type&&C.hasPermission,n=""===S.custom.shareID,r=S.custom.shareID===d.Storage.get("account"),a=0==S.custom.showType&&S.custom.shareID;return a=a?"("+a+"正在屏幕共享中)":"",i.default.createElement("div",null,i.default.createElement(l.Header,{isHome:!1}),i.default.createElement("div",{className:"m-main"},(!C.hasVideo||!C.hasAudio)&&e.needShowTip&&i.default.createElement("div",{id:"device-disabled-tip",className:"u-tip"},i.default.createElement("div",{className:"u-tip-message"},"提示：当前摄像头或话筒不可用 。尝试到浏览器：设置-内容-摄像头\\话筒，删除禁用地址。再刷新页面，获取权限时，点击“同意”。",i.default.createElement("div",{className:"close",onClick:this.closeDeviceDisabledTip}))),i.default.createElement("div",{className:"room-info"},"房间号: ",S.currChatroomId," ",a),i.default.createElement("div",{className:"more-opt"},o&&r&&i.default.createElement(s.Button,{className:"u-btn-longer",onClick:this.stopScreenSharing,disabled:e.requesting,loading:e.requesting},"取消共享屏幕"),o&&n&&i.default.createElement(s.Button,{className:"u-btn-longer",onClick:this.shareScreen,disabled:e.requesting,loading:e.requesting},"共享屏幕"),t&&0==C.showStatus&&i.default.createElement(s.Button,{className:"u-btn-longer",onClick:this.request,disabled:e.requesting,loading:e.requesting},"请求互动"),t&&1==C.showStatus&&i.default.createElement(s.Button,{className:"u-btn-longer",onClick:this.cancleRequest,disabled:e.requesting,loading:e.requesting},"取消互动"),o&&i.default.createElement(s.Button,{className:"u-btn-longer u-btn-stop",onClick:this.stopInteraction,disabled:e.requesting,loading:e.requesting},"停止互动"),t&&i.default.createElement("div",{className:"tip"},"（注：加入互动后可在白板上与创建者画图交流）")),i.default.createElement(u.Whiteboard,null),i.default.createElement("div",{className:"m-netcall"},C.members.map(function(e,t){return i.default.createElement(m.default,{key:t,className:"video-"+(t+1),index:t,self:e.self,account:e.account,offline:e.offline})})),i.default.createElement(u.Chatroom,null)))}}]),t}())||n;k.prototype=Object.assign(k.prototype,v.default),t.default=k},478:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(10),r=s(o(21)),a=s(o(20)),i=s(o(23)),c=s(o(36)),l=o(9);function s(e){return e&&e.__esModule?e:{default:e}}var u=l.StoreNim.state,f=(l.StoreNim,l.StoreChatroom.state),d=l.StoreChatroom,m=l.StoreNetcall.state,p=l.StoreNetcall;t.default={autoLogin:function(){var e=this;if(console.log("检测当前机器的可用设备...."),WebRTC.checkCompatibility().then(function(e){var t=e.Camera,o=e.Microphone;console.log("--- 设备状态",e),p.setHasAudio(o),p.setHasVideo(t)}).catch(function(e){console.error("获取当前机器可用设备时异常: ",e),p.setHasAudio(!1),p.setHasVideo(!1)}),p.settabindex(0),p.setShareStarted(!1),u.account)this.autoLoginChatroom();else{console.log("main:开始自动登录nim过程...");var t=n.Storage.get("account"),o=n.Storage.get("token");if(!t||!o)return console.error("main:自动登录nim:缺少account或token"),void n.Page.to("login");r.default.login(t,o).then(function(){console.log("main:自动登录nim成功"),e.autoLoginChatroom()}).catch(function(e){console.error("main:自动登录nim失败"),n.Page.to("login",e)})}},autoLoginChatroom:function(){var e=this;if(f.currChatroom)return console.log("main:已登录，自动切换到main"),void this.doRtcAndWB();console.log("main:开始自动登录chatroom过程...");var t=n.Storage.get("roomId");if(!t)return console.error("main:自动登录chatroom失败：缺少roomid，回到home"),void n.Page.to("home");a.default.login(t).then(function(){console.log("main:自动登录chatroom成功"),(0,n.Toast)({time:15,msg:"检测到你进行了刷新操作，如果出现听不到对端声音的问题，可点击后修复"});var t=document.createElement("button");t.innerText="点击修复",t.classList="u-btn u-btn-smaller",t.style.marginLeft="20px",t.style.height="22px",t.style.lineHeight="22px",t.id="replayAudio",document.querySelector(".u-tip-message").appendChild(t),document.getElementById("replayAudio").addEventListener("click",function(){m.members.forEach(function(e){0!==e.account.length&&i.default.startPlayRemoteAudio(e.account)})}),setTimeout(function(){document.querySelector(".u-tip-message").removeChild(document.querySelector("#replayAudio"))},15e3),e.doRtcAndWB()}).catch(function(e){console.error("main:自动登录chatroom失败",e),n.Page.to("home")})},doRtcAndWB:function(){p.addDom(document.getElementById("video-1")),p.addDom(document.getElementById("video-2")),p.addDom(document.getElementById("video-3")),p.addDom(document.getElementById("video-4")),this.autoLoginWebRtc(),this.autoLoginWhiteBoard()},autoLoginWebRtc:function(){var e=this;m.webrtc||i.default.initSDK(),a.default.getChatroomMembersInfo(u.account).then(function(t){console.log("自动登录RTC前，预加载当前用户的角色：",t),d.setType(t.members[0].type);var o="owner"==t.members[0].type;e.joinChannelRtc(f.currChatroomId,o)}).catch(function(e){console.error("获取成员信息失败...",e)})},joinChannelRtc:function(e,t){var o=this;console.log("===  开始加入RTC房间"),i.default.joinChannel(f.currChatroomId).then(function(e){console.log("webrtc 加入房间成功",e),1==t?o.doRtcTask4Teacher():o.doRtcTask4Student()}).catch(function(e){e&&e.event&&e.event.event&&e.event.event.code&&404==e.event.event.code?1==t?(console.log("老师端，RTC房间不存在，主动创建..."),o.createChannelRtc(f.currChatroomId)):console.error("webrtc 房间不存在",e):(console.error("webrtc 加入房间失败: ",e),"已经加入房间"==e&&(1==t?o.doRtcTask4Teacher():o.doRtcTask4Student()))})},autoLoginWhiteBoard:function(){l.StoreWhiteBoard.whiteboard||c.default.initSDK();var e=n.Storage.get("isTeacher");this.joinChannelWb(f.currChatroomId,e)},joinChannelWb:function(e,t){var o=this;c.default.joinChannel(f.currChatroomId).then(function(e){console.log("whiteboard 加入房间成功",e),1==t?o.doWbTask4Teacher():o.doWbTask4Student()}).catch(function(e){e&&e.event&&e.event.code&&404==e.event.code?1==t?(console.log("老师端，WHITEBOARD房间不存在，主动创建..."),o.createChannelWb(f.currChatroomId)):console.error("whiteboard 房间不存在",e):(console.error("whiteboard 加入房间失败: ",e),"已经加入房间"==e&&(1==t?o.doWbTask4Teacher():o.doWbTask4Student()))})},doRtcTask4Teacher:function(){console.log("老师处理RTC..."),p.addMember({account:u.account,self:!0},!0,!1),p.setHasPermission(!0),i.default.changeRoleToPlayer(),i.default.startRtc().then(function(){m.hasAudio&&m.audio&&i.default.startMicro().then(function(){console.log("===麦克风启动成功")}).catch(function(e){console.error("===麦克风启动失败",e),"NotAllowedError"==e&&p.setHasAudio(!1)}),m.hasVideo&&m.video&&i.default.startCamera().then(function(){console.log("===摄像头启动成功");var e=m.doms[0];console.log("当前人员加入节点：",e),i.default.startLocalStream(e),i.default.setVideoViewSize()}).catch(function(e){console.error("===摄像头启动失败",e),"NotAllowedError"==e&&p.setHasVideo(!1)})}).catch(function(e){console.error(e),console.log("startRtc出错")})},doRtcTask4Student:function(){console.log("学生处理RTC..."),i.default.changeRoleToAudience(),i.default.startRtc()},doWbTask4Teacher:function(){c.default.changeRoleToPlayer(),c.default.setColor("#000")},doWbTask4Student:function(){c.default.changeRoleToAudience(),c.default.setColor("#35CBFF")},createChannelRtc:function(e){var t=this;i.default.createChannel(e).then(function(o){console.log("webrtc 创建房间成功"),p.setFromCreate(!0),t.joinChannelRtc(e,!0)}).catch(function(e){console.error("webrtc 创建房间失败",e)})},createChannelWb:function(e){var t=this;c.default.createChannel(e).then(function(o){console.log("whiteboard 创建房间成功"),t.joinChannelWb(e,!0)}).catch(function(e){console.error("whiteboard 创建房间失败")})}}},479:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),i=d(a),c=o(16),l=(o(121),o(19)),s=o(10),u=o(9),f=d(o(21));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=(0,c.observer)(n=function(e){function t(){var e,o,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=n=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),n.state={nickname:"",username:"",password:"",errorTip:"",showErrorTip:!1,canRegist:!1,hasUsername:!1,hasNickname:!1,hasPassword:!1,registLoading:!1},n.changeUsername=function(e){var t=e.target.value;s.Valid.isBlank(t)?n.setState({hasUsername:!1,username:"",canRegist:!1}):n.setState(function(e,o){return{username:t,hasUsername:!0,canRegist:e.hasNickname&&e.hasPassword}})},n.changeNickname=function(e){var t=e.target.value;s.Valid.isBlank(t)?n.setState({hasNickname:!1,nickname:"",canRegist:!1}):n.setState(function(e,o){return{nickname:t,hasNickname:!0,canRegist:e.hasUsername&&e.hasPassword}})},n.changePassword=function(e){var t=e.target.value;s.Valid.isBlank(t)?n.setState({hasPassword:!1,password:"",canRegist:!1}):n.setState(function(e,o){return{password:t,hasPassword:!0,canRegist:e.hasUsername&&e.hasNickname}})},n.submit=function(e){if(n.state.canRegist&&!n.state.registLoading){if(s.Valid.isBlank(n.state.username))return n.setState({showErrorTip:!0,errorTip:"请输入账号"}),void n.usernameInput.focus();if(!n.validateFormat("username",n.state.username))return n.setState({showErrorTip:!0,errorTip:"账号限字母或数字"}),void n.usernameInput.focus();if(s.Valid.isBlank(n.state.nickname))return n.setState({showErrorTip:!0,errorTip:"请输入昵称"}),void n.nicknameInput.focus();if(!n.validateFormat("nickname",n.state.nickname))return n.setState({showErrorTip:!0,errorTip:"昵称限汉字、字母或数字"}),void n.nicknameInput.focus();if(s.Valid.isBlank(n.state.password))return n.setState({showErrorTip:!0,errorTip:"请输入密码"}),void n.passwordInput.focus();if(n.state.password.length<6||!n.validateFormat("password",n.state.password))return n.setState({showErrorTip:!0,errorTip:"密码限6～20位字母或数字"}),void n.passwordInput.focus();n.setState({showErrorTip:!1,errorTip:"",registLoading:!0}),n.requestRegist({username:n.state.username,nickname:n.state.nickname,password:n.state.password})}else console.log("不可点击注册或正在注册中...")},m(n,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){(0,s.CheckBroswer)({success:this.init.bind(this)})}},{key:"init",value:function(){this.usernameInput.focus(),u.StoreNim.state.account&&s.Page.to("home")}},{key:"login",value:function(){s.Page.to("login")}},{key:"validateFormat",value:function(e,t){switch(e){case"username":return/^[0-9A-Za-z]{1,20}$/.test(t);case"nickname":return/^[\u4e00-\u9fa50-9A-Za-z]{1,10}$/.test(t);case"password":return/^[0-9A-Za-z]{6,20}$/.test(t);default:return!0}}},{key:"requestRegist",value:function(e){var t=this;f.default.regist(e).then(function(){console.log("注册成功"),t.requestLogin({account:t.state.username,pwd:t.state.password})}).catch(function(e){console.error("注册失败",e),t.usernameInput.focus(),t.setState({showErrorTip:!0,errorTip:e,registLoading:!1})})}},{key:"requestLogin",value:function(e){var t=this,o=e.account,n=(0,s.MD5)(e.pwd);s.Storage.set("account",o),s.Storage.set("token",n),f.default.login(o,n).then(function(){console.log("登录成功"),s.Page.to("home")}).catch(function(e){console.error("登录成功",e),t.setState({showErrorTip:!0,errorTip:e,registLoading:!1})})}},{key:"render",value:function(){var e=this;console.log("render regist");var t=this.state;return i.default.createElement("div",{className:"m-login"},i.default.createElement("div",{className:"form-part"},i.default.createElement("div",{className:"form-part-inner"},i.default.createElement("div",{className:"title"},"肿瘤规范化"),i.default.createElement("div",{className:"subtitle"}),i.default.createElement("div",{className:"box box-regist"},i.default.createElement("div",{className:"form-item"},i.default.createElement("label",{className:"form-label"},"账号:限20位字母或数字"),i.default.createElement(l.Input,{value:t.username,onChange:this.changeUsername,maxLength:20,domRef:function(t){e.usernameInput=t}})),i.default.createElement("div",{className:"form-item"},i.default.createElement("label",{className:"form-label"},"昵称:限10位汉字、字母或数字"),i.default.createElement(l.Input,{value:t.nickname,onChange:this.changeNickname,maxLength:10,domRef:function(t){e.nicknameInput=t}})),i.default.createElement("div",{className:t.showErrorTip?"form-item form-item-1":"form-item"},i.default.createElement("label",{className:"form-label"},"密码:6-20位字母或数字"),i.default.createElement(l.Input,{type:"password",value:t.password,onChange:this.changePassword,maxLength:20,domRef:function(t){e.passwordInput=t}})),i.default.createElement("div",{className:"form-item f-tar"},i.default.createElement("div",{className:"errortip",hidden:!t.showErrorTip},t.errorTip),i.default.createElement("div",null,i.default.createElement(l.Button,{onClick:this.submit,loading:t.registLoading,disabled:!t.canRegist},"注册")),i.default.createElement("div",null,i.default.createElement("a",{href:"javascript:void(0);",className:"gotoLogin",onClick:this.login},"已有账号?直接登录")))))),i.default.createElement("div",{className:"banner"}))}}]),t}())||n;t.default=p},64:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={appkey:"1ee5a51b7d008254cd73b1d4369a9494",url:"https://app.netease.im",resourceUrl:"http://yx-web.nos.netease.com/webdoc/h5",emojiBaseUrl:"http://yx-web.nosdn.127.net/webdoc/h5/emoji",testH5PPTUrl:"https://app.yunxin.163.com/webdemo/ppt/ff1537e0d343821fc509f3165224ab41/index.html"}},87:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o(10);window.WebRTC=window.WebRTC||window.NRTC,t.default={wbInfo:{colorList:["#efa700","#28cf30","#2d48a1","#df23df","#d63232","#000"],color:"#000",styleList:["line","rect","circle"],style:"free"},serializeFileStateMap:{UNKNOWN:"0",PRETRANS:"1",TRANSING:"2",TRANSTIMEOUT:"3",TRANSCOMPLETE:"4",TRANSFAIL:"5",UPLOADING:"11",UPLOADDONE:"12",UPLOADFAIL:"13"},unserializeFileStateMap:{0:"UNKNOWN",1:"PRETRANS",2:"TRANSING",3:"TRANSTIMEOUT",4:"TRANSCOMPLETE",5:"TRANSFAIL",11:"UPLOADING",12:"UPLOADDONE",13:"UPLOADFAIL"},unserializeFileStateText:{0:"状态未知",1:"转码准备中",2:"转码中",3:"转码超时",4:"转码成功",5:"转码失败",11:"上传中",12:"上传完成",13:"上传失败"},serializefileTypeMap:{1:"ppt",2:"pptx",3:"pdf"},unserializefileTypeMap:{ppt:1,pptx:2,pdf:3},fileTypeMap:{10:"jpg",11:"png",0:"unknown"}}},88:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Loading=t.Whiteboard=t.Netcall=t.Chatroom=void 0;var n=c(o(443)),r=c(o(448)),a=c(o(449)),i=c(o(458));function c(e){return e&&e.__esModule?e:{default:e}}t.Chatroom=n.default,t.Netcall=r.default,t.Whiteboard=a.default,t.Loading=i.default},89:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i(o(21)),i(o(20));var n=i(o(23)),r=(i(o(36)),i(o(89)),o(9)),a=o(10);function i(e){return e&&e.__esModule?e:{default:e}}r.StoreNim.state,r.StoreNim;var c=r.StoreChatroom.state,l=r.StoreChatroom,s=r.StoreNetcall.state,u=r.StoreNetcall,f=(r.StoreEventPool,r.StoreEventPool.state);t.default={handleRtcPermissionAndDraw:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(console.log("******* handleRtcPermissionAndDraw(权限与绘制归一处理器) ********* "),console.log(e,t),f.remoteTrackNotifications[e]){var o=c.custom.shareID;a.Storage.get("teacherAccount");o==e&&s.remoteIsScreenSharing?(console.log("render remote is screen sharing"),this.renderRemoteRemoteIsScreenSharing(e)):this.renderRemoteVideo(e,t)}else console.warn("### 等待首次远程轨道通知，尚未收到remoteTrack...",e)},renderRemoteVideo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=void 0==t?this.findRtcUserIndex(e):t;if(-1==o)for(var r=0;r<s.members.length;r++)if(0===s.members[r].account.length){o=r;break}console.log(JSON.stringify(s.members),o,s.members[o]),console.log(JSON.stringify(c.members),o,s.members[o]);var a=l.findMember({account:e});if(-1!==a){var i=c.members[a];(i&&1==i.status||"owner"===i.type)&&(console.log("*** 设置远程视频画面：",e,s.doms[o]),n.default.stopRemoteStream(e,s.doms[o]),n.default.startRemoteStream(e,s.doms[o]),n.default.setVideoViewRemoteSize(e))}else console.warn("no chat members")},renderRemoteRemoteIsScreenSharing:function(e){var t=document.getElementById("m-whiteboard-fullscreen");n.default.startRemoteStream(e,t),n.default.setVideoViewRemoteSize(e,700,490)},findRtcUserIndex:function(e){return u.findMember({account:e})}}},9:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StoreEventPool=t.StoreWhiteBoard=t.StoreNetcall=t.StoreChatroom=t.StoreNim=void 0;var n=l(o(436)),r=l(o(437)),a=l(o(438)),i=l(o(439)),c=l(o(440));function l(e){return e&&e.__esModule?e:{default:e}}var s=window.SNM=new n.default,u=window.SCR=new r.default,f=window.SNC=new a.default,d=window.SWB=new i.default,m=window.SEP=new c.default;t.StoreNim=s,t.StoreChatroom=u,t.StoreNetcall=f,t.StoreWhiteBoard=d,t.StoreEventPool=m}});